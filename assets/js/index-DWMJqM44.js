import{j as e,J as t,c as n,Z as a,_ as r,$ as o,a0 as i,f as l,Q as s,O as d,u as c,x as u,a1 as p,r as f,w as h,a as m,a2 as g,i as y,o as b,A as v,a3 as w,F as D,a4 as x,d as S,e as P,R as k,a5 as _,I as C,a6 as A,H as I,t as F,a7 as E,a8 as N,a9 as L,p as O,aa as V}from"./critical-ftAwMebx.js";import{u as T,c as R}from"./vendor-vue-D_8YONGX.js";import{V as z,a as M,b as U,c as q,d as H,e as B,f as j,g as G,h as J,i as K,j as W,k as Q,l as Z,m as Y,n as X,o as ee,p as te,q as ne,r as ae,s as re,t as oe,u as ie,v as le,w as se,x as de,y as ce,z as ue,A as pe,B as fe,C as he,D as me,E as ge,F as ye,G as be,H as ve,I as we,J as De,K as xe,L as Se,M as Pe,N as ke,O as _e,P as Ce,Q as Ae,R as Ie,S as Fe,T as Ee}from"./vendor-vuetify-core-Ck3wKLlQ.js";import{E as Ne}from"./vendor-pdf-gu-W80S1.js";import{Q as Le}from"./vendor-utils-CnA5QHwe.js";/* empty css                     */!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Oe={DEBUG:0,INFO:1,WARN:2,ERROR:3},Ve="requiform_logLevel",Te=e({logEntries:[],currentLogLevel:(()=>{const e=localStorage.getItem(Ve);return null!==e&&void 0!==Oe[e.toUpperCase()]?Oe[e.toUpperCase()]:Oe.INFO})()}),Re=(e,...t)=>{if(e<Te.currentLogLevel||0===t.length)return;const n=(new Date).toISOString(),a=Object.keys(Oe).find((t=>Oe[t]===e));let r="",o=null;if("string"==typeof t[0])r=t[0];else{try{r=`Object logged: ${JSON.stringify(t[0]).substring(0,100)}...`}catch(i){r=`Object logged: [Serialization Error: ${i.message}]`}1===t.length&&(o=t[0])}t.length>1&&(o=2===t.length?t[1]:t.slice(1)),Te.logEntries.push({timestamp:n,level:a,displayMessage:r,rawData:o}),Te.logEntries.length>500&&Te.logEntries.shift()},ze={debug:(...e)=>Re(Oe.DEBUG,...e),info:(...e)=>Re(Oe.INFO,...e),warn:(...e)=>Re(Oe.WARN,...e),error:(...e)=>Re(Oe.ERROR,...e),setLevel:e=>{if(Object.values(Oe).includes(e)){Te.currentLogLevel=e;const t=Object.keys(Oe).find((t=>Oe[t]===e));t&&(localStorage.setItem(Ve,t),ze.info(`Log level set to ${t}`))}else ze.warn(`Invalid log level attempted: ${e}`)},get entries(){return t(Te.logEntries)},get currentLogLevel(){return Te.currentLogLevel},get level(){return Te.currentLogLevel},clear:()=>{Te.logEntries.length=0,ze.info("Logs cleared.")}};function Me(e){const t=["__proto__","constructor","prototype"];if(null===e||"object"!=typeof e)return e;if(Array.isArray(e))e.forEach((e=>Me(e)));else{for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t.includes(n)?(ze.warn(`[Sanitizer] Detected and removed potentially harmful key: "${n}"`),delete e[n]):e[n]=Me(e[n]));Object.getPrototypeOf(e),Object.prototype}return e}const Ue=e(JSON.parse(JSON.stringify({styles:{topBarColor:"#a09588",footerBackgroundColor:"#E5AA94",phenotypeSelectorBackgroundColor:"#FFFFFF"},appTitle:"RequiForm",themeColors:{primary:"#a09588",secondary:"#424242"},darkThemeColors:{primary:"#BDBDBD",secondary:"#757575"},logoUrl:null}))),qe=t(Ue),He=(e,t)=>{const n=e.__vccOpts||e;for(const[a,r]of t)n[a]=r;return n},Be={class:"content-wrapper"},$e={class:"ml-1"},je={id:"top-bar-actions",class:"d-none d-sm-inline-flex"},Ge={class:"d-inline-flex d-sm-none"},Je=He({__name:"TopBar",props:{isDark:{type:Boolean,required:!0}},setup(e){const{t,locale:f}=T(),h=n((()=>"en"===f.value?"mdi-alpha-e-box-outline":"mdi-alpha-d-box-outline"));return(n,f)=>(r(),a(W,{app:"",color:c(qe).styles.topBarColor,dark:"",class:"main-app-bar"},{default:o((()=>[i("div",Be,[l(z,{class:"flex-shrink-0"},{default:o((()=>[l(M,{location:"bottom"},{activator:o((({props:e})=>[i("h1",u({class:"text-h5 font-weight-bold d-flex align-center"},e),[c(qe).logoUrl?(r(),a(U,{key:0,src:c(qe).logoUrl,alt:"App Logo",class:"header-logo mr-2","max-height":"32",contain:""},null,8,["src"])):p("",!0),f[23]||(f[23]=s()),c(qe).logoUrl?p("",!0):(r(),a(q,{key:1,start:"",class:"logo-icon"},{default:o((()=>f[22]||(f[22]=[s("mdi-file-document-outline")]))),_:1})),f[24]||(f[24]=s()),i("span",$e,d(c(qe).appTitle),1)],16)])),default:o((()=>[f[25]||(f[25]=s()),i("span",null,d(c(qe).appTitle)+": "+d(c(t)("topbar.appSubtitle")),1)])),_:1})])),_:1}),f[88]||(f[88]=s()),l(H),f[89]||(f[89]=s()),i("span",je,[l(B,{icon:"",onClick:f[0]||(f[0]=e=>n.$emit("toggle-theme")),"aria-label":e.isDark?c(t)("topbar.aria.themeToggleLight"):c(t)("topbar.aria.themeToggleDark")},{default:o((()=>[l(q,null,{default:o((()=>[s(d(e.isDark?"mdi-weather-night":"mdi-white-balance-sunny"),1)])),_:1}),f[26]||(f[26]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(e.isDark?c(t)("topbar.tooltips.themeToggleLight"):c(t)("topbar.tooltips.themeToggleDark")),1)])),_:1})])),_:1},8,["aria-label"]),f[46]||(f[46]=s()),l(B,{icon:"",onClick:f[1]||(f[1]=e=>n.$emit("toggle-language")),"aria-label":c(t)("topbar.aria.toggleLanguage")},{default:o((()=>[l(q,null,{default:o((()=>[s(d(h.value),1)])),_:1}),f[27]||(f[27]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(c(t)("topbar.tooltips.toggleLanguage")),1)])),_:1})])),_:1},8,["aria-label"]),f[47]||(f[47]=s()),l(B,{icon:"",onClick:f[2]||(f[2]=e=>n.$emit("reset-form")),"aria-label":c(t)("topbar.aria.reset")},{default:o((()=>[l(q,null,{default:o((()=>f[28]||(f[28]=[s("mdi-restart")]))),_:1}),f[29]||(f[29]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(c(t)("topbar.tooltips.reset")),1)])),_:1})])),_:1},8,["aria-label"]),f[48]||(f[48]=s()),l(B,{icon:"",onClick:f[3]||(f[3]=e=>n.$emit("open-faq")),"aria-label":c(t)("topbar.aria.faq")},{default:o((()=>[l(q,null,{default:o((()=>f[30]||(f[30]=[s("mdi-help-circle")]))),_:1}),f[31]||(f[31]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(c(t)("topbar.tooltips.faq")),1)])),_:1})])),_:1},8,["aria-label"]),f[49]||(f[49]=s()),l(B,{icon:"",onClick:f[4]||(f[4]=e=>n.$emit("start-tour")),"aria-label":c(t)("topbar.aria.tour")},{default:o((()=>[l(q,null,{default:o((()=>f[32]||(f[32]=[s("mdi-compass-outline")]))),_:1}),f[33]||(f[33]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(c(t)("topbar.tooltips.tour")),1)])),_:1})])),_:1},8,["aria-label"]),f[50]||(f[50]=s()),l(B,{icon:"",onClick:f[5]||(f[5]=e=>n.$emit("copy-url")),"aria-label":c(t)("topbar.aria.copyUrl")},{default:o((()=>[l(q,null,{default:o((()=>f[34]||(f[34]=[s("mdi-link-variant")]))),_:1}),f[35]||(f[35]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(c(t)("topbar.tooltips.copyUrl")),1)])),_:1})])),_:1},8,["aria-label"]),f[51]||(f[51]=s()),l(B,{icon:"",onClick:f[6]||(f[6]=e=>n.$emit("copy-encrypted-url")),"aria-label":c(t)("topbar.aria.copyEncryptedUrl")},{default:o((()=>[l(q,null,{default:o((()=>f[36]||(f[36]=[s("mdi-lock")]))),_:1}),f[37]||(f[37]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(c(t)("topbar.tooltips.copyEncryptedUrl")),1)])),_:1})])),_:1},8,["aria-label"]),f[52]||(f[52]=s()),l(B,{icon:"",onClick:f[7]||(f[7]=e=>n.$emit("open-paste-data")),"aria-label":c(t)("topbar.aria.pasteData"),id:"paste-data-btn"},{default:o((()=>[l(q,null,{default:o((()=>f[38]||(f[38]=[s("mdi-clipboard-text")]))),_:1}),f[39]||(f[39]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(c(t)("topbar.tooltips.pasteData")),1)])),_:1})])),_:1},8,["aria-label"]),f[53]||(f[53]=s()),l(B,{icon:"",onClick:f[8]||(f[8]=e=>n.$emit("save-data")),"aria-label":c(t)("topbar.aria.saveData"),id:"save-data-btn"},{default:o((()=>[l(q,null,{default:o((()=>f[40]||(f[40]=[s("mdi-content-save")]))),_:1}),f[41]||(f[41]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(c(t)("topbar.tooltips.saveData")),1)])),_:1})])),_:1},8,["aria-label"]),f[54]||(f[54]=s()),l(B,{icon:"",onClick:f[9]||(f[9]=e=>n.$emit("load-data")),"aria-label":c(t)("topbar.aria.loadData"),id:"load-data-btn"},{default:o((()=>[l(q,null,{default:o((()=>f[42]||(f[42]=[s("mdi-folder-open")]))),_:1}),f[43]||(f[43]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(c(t)("topbar.tooltips.loadData")),1)])),_:1})])),_:1},8,["aria-label"]),f[55]||(f[55]=s()),l(B,{icon:"",onClick:f[10]||(f[10]=e=>n.$emit("generate-pdf")),"aria-label":c(t)("topbar.aria.generatePdf"),id:"generate-pdf-btn"},{default:o((()=>[l(q,null,{default:o((()=>f[44]||(f[44]=[s("mdi-file-pdf-box")]))),_:1}),f[45]||(f[45]=s()),l(M,{activator:"parent",location:"bottom"},{default:o((()=>[s(d(c(t)("topbar.tooltips.generatePdf")),1)])),_:1})])),_:1},8,["aria-label"])]),f[90]||(f[90]=s()),i("div",Ge,[l(j,{"offset-y":""},{activator:o((({props:e})=>[l(B,u({icon:""},e,{"aria-label":c(t)("topbar.aria.moreActions")}),{default:o((()=>[l(q,null,{default:o((()=>f[56]||(f[56]=[s("mdi-dots-vertical")]))),_:1})])),_:2},1040,["aria-label"])])),default:o((()=>[f[87]||(f[87]=s()),l(G,{density:"compact"},{default:o((()=>[l(J,{onClick:f[11]||(f[11]=e=>n.$emit("toggle-theme"))},{prepend:o((()=>[l(q,null,{default:o((()=>[s(d(e.isDark?"mdi-weather-night":"mdi-white-balance-sunny"),1)])),_:1})])),default:o((()=>[f[57]||(f[57]=s()),l(K,null,{default:o((()=>[s(d(e.isDark?c(t)("topbar.tooltips.themeToggleLight"):c(t)("topbar.tooltips.themeToggleDark")),1)])),_:1})])),_:1}),f[77]||(f[77]=s()),l(J,{onClick:f[12]||(f[12]=e=>n.$emit("toggle-language"))},{prepend:o((()=>[l(q,null,{default:o((()=>[s(d(h.value),1)])),_:1})])),default:o((()=>[f[58]||(f[58]=s()),l(K,null,{default:o((()=>[s(d(c(t)("topbar.menu.toggleLanguage")),1)])),_:1})])),_:1}),f[78]||(f[78]=s()),l(J,{onClick:f[13]||(f[13]=e=>n.$emit("reset-form"))},{prepend:o((()=>[l(q,null,{default:o((()=>f[59]||(f[59]=[s("mdi-restart")]))),_:1})])),default:o((()=>[f[60]||(f[60]=s()),l(K,null,{default:o((()=>[s(d(c(t)("topbar.menu.reset")),1)])),_:1})])),_:1}),f[79]||(f[79]=s()),l(J,{onClick:f[14]||(f[14]=e=>n.$emit("open-faq"))},{prepend:o((()=>[l(q,null,{default:o((()=>f[61]||(f[61]=[s("mdi-help-circle")]))),_:1})])),default:o((()=>[f[62]||(f[62]=s()),l(K,null,{default:o((()=>[s(d(c(t)("topbar.menu.faq")),1)])),_:1})])),_:1}),f[80]||(f[80]=s()),l(J,{onClick:f[15]||(f[15]=e=>n.$emit("start-tour"))},{prepend:o((()=>[l(q,null,{default:o((()=>f[63]||(f[63]=[s("mdi-compass-outline")]))),_:1})])),default:o((()=>[f[64]||(f[64]=s()),l(K,null,{default:o((()=>[s(d(c(t)("topbar.menu.tour")),1)])),_:1})])),_:1}),f[81]||(f[81]=s()),l(J,{onClick:f[16]||(f[16]=e=>n.$emit("copy-url"))},{prepend:o((()=>[l(q,null,{default:o((()=>f[65]||(f[65]=[s("mdi-link-variant")]))),_:1})])),default:o((()=>[f[66]||(f[66]=s()),l(K,null,{default:o((()=>[s(d(c(t)("topbar.menu.copyUrl")),1)])),_:1})])),_:1}),f[82]||(f[82]=s()),l(J,{onClick:f[17]||(f[17]=e=>n.$emit("copy-encrypted-url"))},{prepend:o((()=>[l(q,null,{default:o((()=>f[67]||(f[67]=[s("mdi-lock")]))),_:1})])),default:o((()=>[f[68]||(f[68]=s()),l(K,null,{default:o((()=>[s(d(c(t)("topbar.menu.copyEncryptedUrl")),1)])),_:1})])),_:1}),f[83]||(f[83]=s()),l(J,{onClick:f[18]||(f[18]=e=>n.$emit("open-paste-data"))},{prepend:o((()=>[l(q,null,{default:o((()=>f[69]||(f[69]=[s("mdi-clipboard-text")]))),_:1})])),default:o((()=>[f[70]||(f[70]=s()),l(K,null,{default:o((()=>[s(d(c(t)("topbar.menu.pasteData")),1)])),_:1})])),_:1}),f[84]||(f[84]=s()),l(J,{onClick:f[19]||(f[19]=e=>n.$emit("save-data"))},{prepend:o((()=>[l(q,null,{default:o((()=>f[71]||(f[71]=[s("mdi-content-save")]))),_:1})])),default:o((()=>[f[72]||(f[72]=s()),l(K,null,{default:o((()=>[s(d(c(t)("topbar.menu.saveData")),1)])),_:1})])),_:1}),f[85]||(f[85]=s()),l(J,{onClick:f[20]||(f[20]=e=>n.$emit("load-data"))},{prepend:o((()=>[l(q,null,{default:o((()=>f[73]||(f[73]=[s("mdi-folder-open")]))),_:1})])),default:o((()=>[f[74]||(f[74]=s()),l(K,null,{default:o((()=>[s(d(c(t)("topbar.menu.loadData")),1)])),_:1})])),_:1}),f[86]||(f[86]=s()),l(J,{onClick:f[21]||(f[21]=e=>n.$emit("generate-pdf"))},{prepend:o((()=>[l(q,null,{default:o((()=>f[75]||(f[75]=[s("mdi-file-pdf-box")]))),_:1})])),default:o((()=>[f[76]||(f[76]=s()),l(K,null,{default:o((()=>[s(d(c(t)("topbar.menu.generatePdf")),1)])),_:1})])),_:1})])),_:1})])),_:1})])])])),_:1},8,["color"]))}},[["__scopeId","data-v-088f0004"]]),Ke=He({__name:"LocaleDatePicker",props:{modelValue:{type:String,default:""},label:{type:String,default:"Birthdate"}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,o=t,i=navigator.language;function l(e){if(!e)return null;const t=new Date(e);return isNaN(t.getTime())?null:t}const s=f(l(n.modelValue));return h((()=>n.modelValue),(e=>{s.value=l(e)})),h(s,(e=>{const t=(n=e)?n.toISOString().split("T")[0]:"";var n;o("update:modelValue",t)})),(t,n)=>(r(),a(c(Q),{density:"compact","prepend-icon":"","prepend-inner-icon":"$calendar",modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=e=>s.value=e),label:e.label,locale:c(i),dense:"",outlined:""},null,8,["modelValue","label","locale"]))}},[["__scopeId","data-v-f84af8b8"]]),We={class:"text-h5 mb-4"},Qe=He({__name:"PatientForm",props:{patientData:{type:Object,required:!0}},emits:["update:patientData"],setup(e,{emit:t}){const{t:u}=T(),f=e,h=t,b=m("patientData"),v=m("updatePersonalInfo"),w=m("getFieldErrors",(()=>({}))),D=n((()=>{const e=w("personalInfo");return e&&e.firstName?u(e.firstName):""})),x=n((()=>{const e=w("personalInfo");return e&&e.lastName?u(e.lastName):""})),S=n((()=>{const e=w("personalInfo");return e&&e.birthdate?u(e.birthdate):""})),P=n((()=>{const e=w("personalInfo");return e&&e.sex?u(e.sex):""})),k=n((()=>{const e=w("personalInfo");return e&&e.insurance?u(e.insurance):""})),_=n((()=>{const e=w("personalInfo");return e&&e.referrer?u(e.referrer):""})),C=n((()=>{const e=w("personalInfo");return e&&e.diagnosis?u(e.diagnosis):""}));function A(e,t,...a){return n({get(){if(b&&t&&b.personalInfo){const e=b.personalInfo[t];if(void 0!==e)return e}let n=f.patientData;const r=[e,...a];for(const e of r){if(null===n||"object"!=typeof n||!(e in n))return(1!==r.length||"variantSegregationRequested"!==r[0])&&"";n=n[e]}return 1===r.length&&"variantSegregationRequested"===r[0]?"boolean"==typeof n&&n:n??""},set(n){v&&t&&v({[t]:n});const r=JSON.parse(JSON.stringify(f.patientData));let o=r;const i=[e,...a];for(let e=0;e<i.length-1;e++){const t=i[e];null!==o[t]&&"object"==typeof o[t]||(o[t]={}),o=o[t]}o[i[i.length-1]]=n,h("update:patientData",r)}})}function I(...e){return n({get(){let t=f.patientData;for(const n of e){if(null===t||"object"!=typeof t||!(n in t))return(1!==e.length||"variantSegregationRequested"!==e[0])&&"";t=t[n]}return 1===e.length&&"variantSegregationRequested"===e[0]?"boolean"==typeof t&&t:t??""},set(t){const n=JSON.parse(JSON.stringify(f.patientData));let a=n;for(let r=0;r<e.length-1;r++){const t=e[r];null!==a[t]&&"object"==typeof a[t]||(a[t]={}),a=a[t]}a[e[e.length-1]]=t,h("update:patientData",n)}})}const F=A("givenName","firstName"),E=A("familyName","lastName"),N=A("birthdate","birthdate"),L=A("sex","sex"),O=A("insurance","insurance"),V=A("physicianName","referrer"),R=I("familyHistory"),z=I("parentalConsanguinity"),M=A("diagnosis","diagnosis"),U=I("orderingDate"),q=I("variantSegregationRequested"),H=I("variantDetails"),B=I("genDGConsentData","provided"),$=I("genDGConsentData","form","consentName"),j=I("genDGConsentData","form","consentDate"),G=I("genDGConsentData","form","questionSecondaryFindings"),J=I("genDGConsentData","form","questionMaterial"),K=I("genDGConsentData","form","questionExtended"),W=I("genDGConsentData","form","questionResearch"),Q=n((()=>[{text:u("patientForm.options.sex.male"),value:"male"},{text:u("patientForm.options.sex.female"),value:"female"},{text:u("patientForm.options.sex.undetermined"),value:"undetermined"}])),ae=n((()=>[{text:u("patientForm.options.familyHistory.conspicuous"),value:"conspicuous"},{text:u("patientForm.options.familyHistory.inconspicuous"),value:"inconspicuous"},{text:u("patientForm.options.familyHistory.unknown"),value:"unknown"}])),re=n((()=>[{text:u("patientForm.options.consanguinity.yes"),value:"yes"},{text:u("patientForm.options.consanguinity.no"),value:"no"}])),oe=n((()=>[{text:u("patientForm.options.consent.provided"),value:"provided"},{text:u("patientForm.options.consent.fill"),value:"fill"}])),ie=n((()=>[{text:u("patientForm.options.yesNo.yes"),value:"yes"},{text:u("patientForm.options.yesNo.no"),value:"no"}]));return(e,t)=>(r(),g("div",null,[i("h2",We,d(c(u)("patientForm.title")),1),t[32]||(t[32]=s()),l(ee,{dense:""},{default:o((()=>[l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(Y,{density:"compact",outlined:"",label:c(u)("patientForm.labels.givenName"),modelValue:c(F),"onUpdate:modelValue":t[0]||(t[0]=e=>y(F)?F.value=e:null),"prepend-inner-icon":"mdi-account",error:!!D.value,"error-messages":D.value},null,8,["label","modelValue","error","error-messages"])])),_:1}),t[19]||(t[19]=s()),l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(Y,{density:"compact",outlined:"",label:c(u)("patientForm.labels.familyName"),modelValue:c(E),"onUpdate:modelValue":t[1]||(t[1]=e=>y(E)?E.value=e:null),"prepend-inner-icon":"mdi-account-group",error:!!x.value,"error-messages":x.value},null,8,["label","modelValue","error","error-messages"])])),_:1}),t[20]||(t[20]=s()),l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(Ke,{modelValue:c(N),"onUpdate:modelValue":t[2]||(t[2]=e=>y(N)?N.value=e:null),label:c(u)("patientForm.labels.birthdate"),error:!!S.value,"error-messages":S.value},null,8,["modelValue","label","error","error-messages"])])),_:1}),t[21]||(t[21]=s()),l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(X,{density:"compact",outlined:"",label:c(u)("patientForm.labels.sex"),items:Q.value,"item-title":"text","item-value":"value",modelValue:c(L),"onUpdate:modelValue":t[3]||(t[3]=e=>y(L)?L.value=e:null),"prepend-inner-icon":"mdi-gender-male-female",error:!!P.value,"error-messages":P.value},null,8,["label","items","modelValue","error","error-messages"])])),_:1})])),_:1}),t[33]||(t[33]=s()),l(te,{class:"my-1"}),t[34]||(t[34]=s()),l(ee,{dense:""},{default:o((()=>[l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(Y,{density:"compact",outlined:"",label:c(u)("patientForm.labels.insurance"),modelValue:c(O),"onUpdate:modelValue":t[4]||(t[4]=e=>y(O)?O.value=e:null),"prepend-inner-icon":"mdi-card-account-details-outline",error:!!k.value,"error-messages":k.value},null,8,["label","modelValue","error","error-messages"])])),_:1}),t[22]||(t[22]=s()),l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(Y,{density:"compact",outlined:"",label:c(u)("patientForm.labels.physicianName"),modelValue:c(V),"onUpdate:modelValue":t[5]||(t[5]=e=>y(V)?V.value=e:null),"prepend-inner-icon":"mdi-stethoscope",error:!!_.value,"error-messages":_.value},null,8,["label","modelValue","error","error-messages"])])),_:1})])),_:1}),t[35]||(t[35]=s()),l(te,{class:"my-1"}),t[36]||(t[36]=s()),l(ee,{dense:""},{default:o((()=>[l(Z,{cols:"12",sm:"4"},{default:o((()=>[l(X,{density:"compact",outlined:"",label:c(u)("patientForm.labels.familyHistory"),items:ae.value,modelValue:c(R),"onUpdate:modelValue":t[6]||(t[6]=e=>y(R)?R.value=e:null),"prepend-inner-icon":"mdi-history"},null,8,["label","items","modelValue"])])),_:1}),t[23]||(t[23]=s()),l(Z,{cols:"12",sm:"4"},{default:o((()=>[l(X,{density:"compact",outlined:"",label:c(u)("patientForm.labels.parentalConsanguinity"),items:re.value,modelValue:c(z),"onUpdate:modelValue":t[7]||(t[7]=e=>y(z)?z.value=e:null),"prepend-inner-icon":"mdi-human-male-female"},null,8,["label","items","modelValue"])])),_:1}),t[24]||(t[24]=s()),l(Z,{cols:"12",sm:"4"},{default:o((()=>[l(Y,{density:"compact",outlined:"",label:c(u)("patientForm.labels.diagnosis"),modelValue:c(M),"onUpdate:modelValue":t[8]||(t[8]=e=>y(M)?M.value=e:null),rows:"2","prepend-inner-icon":"mdi-file-document-edit-outline","persistent-hint":"",error:!!C.value,"error-messages":C.value},null,8,["label","modelValue","error","error-messages"])])),_:1})])),_:1}),t[37]||(t[37]=s()),l(te,{class:"my-1"}),t[38]||(t[38]=s()),l(ee,{dense:""},{default:o((()=>[l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(Ke,{modelValue:c(U),"onUpdate:modelValue":t[9]||(t[9]=e=>y(U)?U.value=e:null),label:c(u)("patientForm.labels.orderingDate")},null,8,["modelValue","label"])])),_:1}),t[25]||(t[25]=s()),l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(X,{density:"compact",outlined:"",label:c(u)("patientForm.labels.consent"),items:oe.value,"item-title":"text","item-value":"value",modelValue:c(B),"onUpdate:modelValue":t[10]||(t[10]=e=>y(B)?B.value=e:null)},null,8,["label","items","modelValue"])])),_:1})])),_:1}),t[39]||(t[39]=s()),"fill"===c(B)?(r(),a(ee,{key:0,dense:"",class:"mt-2"},{default:o((()=>[l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(Y,{density:"compact",outlined:"",label:c(u)("patientForm.labels.consentGivenBy"),modelValue:c($),"onUpdate:modelValue":t[11]||(t[11]=e=>y($)?$.value=e:null)},null,8,["label","modelValue"])])),_:1}),t[26]||(t[26]=s()),l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(Ke,{modelValue:c(j),"onUpdate:modelValue":t[12]||(t[12]=e=>y(j)?j.value=e:null),label:c(u)("patientForm.labels.consentDate")},null,8,["modelValue","label"])])),_:1}),t[27]||(t[27]=s()),l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(X,{density:"compact",outlined:"",label:c(u)("patientForm.labels.consentSecondaryFindings"),items:ie.value,"item-title":"text","item-value":"value",modelValue:c(G),"onUpdate:modelValue":t[13]||(t[13]=e=>y(G)?G.value=e:null)},null,8,["label","items","modelValue"])])),_:1}),t[28]||(t[28]=s()),l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(X,{density:"compact",outlined:"",label:c(u)("patientForm.labels.consentMaterial"),items:ie.value,"item-title":"text","item-value":"value",modelValue:c(J),"onUpdate:modelValue":t[14]||(t[14]=e=>y(J)?J.value=e:null)},null,8,["label","items","modelValue"])])),_:1}),t[29]||(t[29]=s()),l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(X,{density:"compact",outlined:"",label:c(u)("patientForm.labels.consentExtendedStorage"),items:ie.value,"item-title":"text","item-value":"value",modelValue:c(K),"onUpdate:modelValue":t[15]||(t[15]=e=>y(K)?K.value=e:null)},null,8,["label","items","modelValue"])])),_:1}),t[30]||(t[30]=s()),l(Z,{cols:"12",sm:"6"},{default:o((()=>[l(X,{density:"compact",outlined:"",label:c(u)("patientForm.labels.consentResearch"),items:ie.value,"item-title":"text","item-value":"value",modelValue:c(W),"onUpdate:modelValue":t[16]||(t[16]=e=>y(W)?W.value=e:null)},null,8,["label","items","modelValue"])])),_:1})])),_:1})):p("",!0),t[40]||(t[40]=s()),l(te,{class:"my-1"}),t[41]||(t[41]=s()),l(ee,{dense:""},{default:o((()=>[l(Z,{cols:"12"},{default:o((()=>[l(ne,{modelValue:c(q),"onUpdate:modelValue":t[17]||(t[17]=e=>y(q)?q.value=e:null),label:c(u)("patientForm.labels.requestVariantSegregation")},null,8,["modelValue","label"])])),_:1}),t[31]||(t[31]=s()),c(q)?(r(),a(Z,{key:0,cols:"12"},{default:o((()=>[l(Y,{density:"compact",outlined:"",label:c(u)("patientForm.labels.variantDetails"),modelValue:c(H),"onUpdate:modelValue":t[18]||(t[18]=e=>y(H)?H.value=e:null),hint:c(u)("patientForm.hints.variantDetails"),"persistent-hint":""},null,8,["label","modelValue","hint"])])),_:1})):p("",!0)])),_:1})]))}},[["__scopeId","data-v-2a1c32ae"]]),Ze={schema:{name:"RequiForm Test Schema",version:"0.1.0"},categories:[{id:"nephrology",title:"Nephrology",titles:{en:"Nephrology",de:"Nephrologie"},tests:[{id:"nephronophthise",name:"Nephronophthise",names:{en:"Nephronophthisis",de:"Nephronophthise"},genes:["INVS","NPHP1 (Inkl. MLPA)","NPHP3","NPHP4","IQCB1","CEP290","GLIS2","TMEM67","RPGRIP1L","NEK8","SDCCAG8","TTC21B","WDR19","ZNF423","CEP164","IFT172","CEP83","DCDC2","MAPKBP1","ANKS6","PAX2","XPNPEP3","ADAMTS9","FAN1","SLC41A1"]},{id:"nephrotisches_syndrom_fsgs_alport",name:"Nephrotisches Syndrom, fokal segmentale Glomerulosklerose (FSGS), Alport Syndrome",names:{en:"Nephrotic Syndrome, Focal Segmental Glomerulosclerosis (FSGS), Alport Syndrome",de:"Nephrotisches Syndrom, fokal segmentale Glomerulosklerose (FSGS), Alport Syndrom"},genes:["AVIL","ACTN4","ANLN","ARHGDIA","CD2AP","COL4A3","COL4A4","COL4A5","COQ2","COQ6","COQ8B","CRB2","CUBN","DGKE","EMP2","FN1","GLA","INF2","ITGA3","KANK2","LAMB2","LMX1B","MAGI2","MYH9","MYO1E","NPHS1","NPHS2","NUP107","NUP205","NUP93","NUP160","NUP85","NUP133","PAX2","PDSS2","PLCE1","PTPRO","SCARB2","SMARCAL1","SGPL1","TBC1D8B","TRPC6","WDR73","WT1","APOL1","CLCN5","LMNA","ALG1","CD151","XPO5","DAAM2","TRIM8","NOS1AP","PRDM15","RCAN1","FAT1","KIRREL1"]},{id:"alport_thin_basement",name:"Alport Syndrom und Nephropathien vom Typ der dünnen Basalmembran",genes:["COL4A3","COL4A4","COL4A5","FN1","CD151","MYH9"]},{id:"senior_loken_syndrome",name:"Senior Løken Syndrom, Nephronophthise mit einer Retinadegeneration",genes:["NPHP1 (Inkl. MLPA)","NPHP3","NPHP4","IQCB1","WDR19","CEP290","SDCCAG8","TRAF3IP1","CEP164","ZNF423","INVS"]},{id:"joubert_syndrome",name:"Joubert Syndrom",genes:["NPHP1 (Inkl. MLPA)","CEP104","TMEM237","ARMC9","PDE6D","ARL13B","CC2D2A","CPLANE1","CEP120","AHI1","CEP41","CSPP1","TMEM67","INPP5E","TCTN3","SUFU","ARL3","TMEM138","TMEM216","CEP290","TCTN1","TCTN2","PIBF1","KIAA0586","KIF7","KIAA0556","ZNF423","RPGRIP1L","TMEM231","TMEM107","B9D1","MKS1","B9D2","OFD1","TTC21B","HYLS1"]},{id:"meckel_gruber_syndrome",name:"Meckel Gruber Syndrom",genes:["B9D1","B9D2","CC2D2A","CEP290","CEP41","CSPP1","KIF14","MKS1","NPHP3","RPGRIP1L","TCTN2","TCTN3","TMEM67","TMEM107","TMEM138","TMEM216","TMEM231","TMEM237","TTC21B","TXNDC15"]},{id:"autosomal_dominant_tubular",name:"Autosomal dominante tubuläre Nierenerkrankung",genes:["UMOD","MUC1 (ohne VNTR)","HNF1B","REN","SEC61A1","PARN"]},{id:"bartter_gitelman",name:"Bartter Syndrom und Gitelman Syndrom",genes:["BSND","CASR","CLCN5","CLCNKA","CLCNKB","CTNS","GNA11","KCNJ10","KCNJ1","MAGED2","SLC12A1","SLC12A3","KCNJ16","EHD1","CLDN10","RRAGD"]},{id:"kidney_stones",name:"Nierensteine (inkl. FHHNC familiäre Hypomagnesiämie mit Hypercalciurie und Nephrocalcinose)",genes:["ADCY10","AGXT","APRT","ATP6V0A4","ATP6V1B1","CA2","CASR","CLCN5","CLCNKB","CLDN2","CLDN16","CLDN19","CNNM2","CYP24A1","FAM20A","GRHPR","HNF4A","HOGA1","HPRT1","ATP1A1","FXYD2","TRPM6","KCNJ1","MAGED2","OCRL","SLC12A1","SLC26A1","SLC22A12","SLC2A9","SLC34A1","SLC34A3","SLC3A1","SLC4A1","SLC7A9","SLC26A6","SLC9A3R1","XDH","EGF"]},{id:"distal_rta",name:"Distale renal-tubuläre Azidose",genes:["SLC4A1","ATP6V1B1","ATP6V0A4","ATP6V1C2","WDR72","FOXI1","SLC4A4","CA2","VPS33B","VIPAS39"]},{id:"complement_diseases",name:"Komplementerkrankungen",genes:["CFH (inkl. MLPA)","CFHR1 (inkl. MLPA)","CFHR3 (inkl. MLPA)","CFI","CD46","CFB","CFD","KCNT2 (inkl. MLPA)","CFHR5 (inkl. MLPA)","C3","THBD","MMACHC","DGKE"]},{id:"kidney_cancer",name:"Nierenkarzinom",genes:["BAP1","CHEK2","DICER1","DIS3L2","FH","FLCN","GPC3","MET","PTEN","SDHB","SDHC","SDHD","SMARCB1","TP53","TSC1","TSC2","VHL","WT1"]},{id:"cakut",name:"CAKUT (Kongenitale Anomalien der Nieren und der ableitenden Harnwege)",genes:["ACE","ACTG2","AGT","BNC2","AGTR1","ANOS1","BMP4","CEP55","CHRM3","CTU2","DSTYK","EYA1","CCNQ","FAT4","FRAS1","FREM1","FREM2","GATA3","GPC3","CHRNA3","GLI3","GRIP1","HNF1B","HPSE2","KIF14","ITGA8","LRIG2","PAX2","PBX1","REN","RET","ROBO1","ROBO2","SALL1","SIX5","UMOD","ZIC3","TBX18","NRIP1","SOX11","SOX17","ZMYM2","NPNT","GFRA1","WNT9B","GREB1L","COL4A1"]},{id:"hypertension",name:"Hypertonie",genes:["ABCC6","CACNA1D","CACNA1H","CLCN2","CUL3","CYP11B1","CYP17A1","ENPP1","HSD11B2","KCNJ5","KLHL3","NF1","NR3C1","NR3C2","PDE3A","PPARG","SCNN1B","SCNN1G","SDHA","SDHAF2","SDHB","SDHC","SDHD","TMEM127","WNK1","WNK4","YY1AP1","CYP11B1","CYP11B2"]},{id:"polycystic_kidney_disease",name:"Polyzystische Nierenerkrankung",genes:["PKD1","PKD2","GANAB","PKHD1","DZIP1L","DNAJB11","ANKS6","UMOD","MUC1 (ohne VNTR)","HNF1B","REN","SEC61A1","BICC1","NPHP3","NEK8","TULP3","ALG8","ALG9","IFT140","FLCN","PRKCSH","SEC63","LRP5"]}],phenotypes:[{id:"vesikoureteraler_reflux",name:"Vesikoureteraler Reflux",hpo:"HP:0012002",description:"Retrograde flow of urine from the bladder into the ureters.",names:{en:"Vesicoureteral reflux",de:"Vesikoureteraler Reflux"},descriptions:{en:"Retrograde flow of urine from the bladder into the ureters.",de:"Rückfluss von Urin aus der Blase in die Harnleiter."}},{id:"megaureter",name:"Megaureter",hpo:"HP:0000078",description:"Abnormally dilated ureter."},{id:"nierenagenesie",name:"Nierenagenesie",hpo:"HP:0000119",description:"Absence of one or both kidneys."},{id:"nierenhypoplasie",name:"Nierenhypoplasie",hpo:"HP:0012563",description:"Underdeveloped kidneys."},{id:"polyzystische_nieren",name:"(Poly-)zystische Nieren",hpo:"HP:0000107",description:"Multiple cysts in the kidneys."},{id:"nierendysplasie",name:"Nierendysplasie",hpo:"HP:0000001",description:"Abnormal kidney shape due to dysplasia."},{id:"nephrocalcinose",name:"Nephrocalcinose",hpo:"HP:0000002",description:"Calcium deposits in the kidneys."},{id:"nephrolithiasis",name:"Nephrolithiasis",hpo:"HP:0000079",description:"Kidney stones."},{id:"nephrotisches_syndrom_fsgs",name:"Nephrotisches Syndrom / FSGS",hpo:"HP:0000093",description:"Nephrotic syndrome with focal segmental glomerulosclerosis."},{id:"schrumpfniere",name:"Schrumpfniere",hpo:"HP:0000095",description:"Shrinkage of the kidneys."},{id:"interstitielle_nephritis",name:"Interstitielle Nephritis",hpo:"HP:0000003",description:"Inflammation of the kidney interstitium."}]},{id:"cardiology",title:"Cardiology",tests:[{id:"lqts",name:"Long QT-Syndrom (LQTS)",genes:["CACNA1C","CALM1","CALM2","CALM3","CAV3","KCNE1","KCNE2","KCNH2","KCNJ2","KCNQ1","SCN5A","TRDN"]},{id:"sqts",name:"Short QT-Syndrom (SQTS)",genes:["CACNA1C","CACNA2D1","CACNB2","KCNH2","KCNJ2","KCNQ1","SCN5A","SLC4A3","SLC22A5"]},{id:"brugada",name:"Brugada-Syndrom (BrS)",genes:["CACNA1C","CACNB2","GPD1L","HCN4","KCND3","KCNE3","SCN1B","SCN3B","SCN5A"]},{id:"arvc",name:"Arrhythmogene rechtsventrikuläre Kardiomyopathie (ARVC)",genes:["CDH2","DES","DSC2","DSG2","DSP","FLNC","JUP","LMNA","PLN","PKP2","TMEM43"]},{id:"cpvt",name:"Catecholaminerge polymorphe ventrikuläre Tachykardie (CPVT)",genes:["CALM1","CALM2","CALM3","CASQ2","KCNJ2","RYR2","TECRL","TRDN"]},{id:"rcm",name:"Restriktive Kardiomyopathie (RCM)",genes:["ACTC1","DES","FLNC","GLA","MYBPC3","MYH7","MYPN","TNNI3","TNNT2","TTN"]},{id:"hcm",name:"Hypertrophe Kardiomyopathie (HCM)",genes:["ACTC1","ACTN2","ALPK3","CAV3","CSRP3","FHOD3","FLNC","GLA","JPH2","KLHL24","LAMP2","MT-TI","MYBPC3","MYH7","MYL2","MYL3","PLN","PRKAG2","TRIM63","TNNC1","TNNI3","TNNT2","TPM1","TTR"]},{id:"dcm",name:"Dilatative Kardiomyopathie (DCM)",genes:["ACTC1","ACTN2","BAG3","CAP2","DES","DMD","DSG2","DSP","EYA4","FLII","FLNC","JPH2","LMNA","MYBPC3","MYH7","NEXN","PLN","PPP1R13L","PRDM16","RAF1","RBM20","RPL3L","SCN5A","TAZ","TNNC1","TNNI3","TNNI3K","TNNT2","TPM1","TTN*","VCL"]}],phenotypes:[{id:"synkopen",name:"Synkopen",hpo:"HP:0001262",description:"Episodes of fainting."},{id:"plotzlicher_herztod",name:"Plötzlicher Herztod / Herzstillstand",hpo:"HP:0001644",description:"Sudden cardiac arrest."}]}]},Ye={key:0,class:"mb-4"},Xe=He({__name:"TestSelector",setup(e){const{t}=T(),a=T(),y=n((()=>a.locale.value)),w=(e,t,n)=>!t||(n&&(n.searchText||n.raw&&n.raw.searchText)||e).toLowerCase().includes(t.toLowerCase());function D(e){return e.names&&e.names[y.value]?e.names[y.value]:e.name}const x=m("patientData",{selectedPanels:f([])}),S=m("updateCategory",null),P=f([]),k=f(""),_=n((()=>(null==x?void 0:x.category)||"")),C=n((()=>(null==x?void 0:x.selectedPanels)||[])),A=f("Category Selection");b((()=>{var e,t,n,a;if(P.value=Ze.categories,(null==(t=null==(e=window.requiFormData)?void 0:e.directPanels)?void 0:t.length)>0){ze.debug("TestSelector: Setting panels from directPanels:",window.requiFormData.directPanels);const e=window.requiFormData.directPanels[0];for(const t of P.value)if(t.tests.some((t=>t.id===e))){ze.debug("TestSelector: Auto-selecting category from panel:",t.id),k.value=t.id;break}}else if((null==(a=null==(n=window.requiFormData)?void 0:n.selectedPanels)?void 0:a.length)>0){ze.debug("TestSelector: Setting panels from window.requiFormData.selectedPanels:",window.requiFormData.selectedPanels);const e=window.requiFormData.selectedPanels[0];for(const t of P.value)if(t.tests.some((t=>t.id===e))){ze.debug("TestSelector: Auto-selecting category from panel:",t.id),k.value=t.id;break}}else if(C.value.length>0){ze.debug("TestSelector: Setting panels from unifiedPatientData:",C.value);const e=C.value[0];for(const t of P.value)if(t.tests.some((t=>t.id===e))){ze.debug("TestSelector: Auto-selecting category from panel:",t.id),k.value=t.id;break}}else _.value&&(ze.debug("TestSelector: Setting initial category from unified model:",_.value),k.value=_.value);v((()=>{C.value.length>0&&(ze.debug("TestSelector: Forcing Category Selection tab to show selected panels"),A.value="Category Selection")}))})),h(C,(e=>{if(e&&e.includes("nephronophthise")&&(!k.value||"nephrology"!==k.value)){ze.debug("TestSelector: Auto-setting category to nephrology based on nephronophthise panel");const e="nephrology";k.value=e,S&&S(e)}}),{immediate:!0}),h([C,P],(([e,t])=>{if(e&&e.length>0&&!k.value&&t.length>0){const n=e[0];let a=null;for(const e of t)if(e.tests.some((e=>e.id===n))){a=e.id;break}a&&(ze.debug("TestSelector: Auto-selecting category based on selected test:",a),k.value=a)}}),{immediate:!0});const I=n((()=>{const e=P.value.find((e=>e.id===k.value));return e?e.tests:[]})),F=n((()=>{const e=[];return P.value.forEach((t=>{t.tests.forEach((t=>{const n=D(t);let a=n;t.genes&&Array.isArray(t.genes)&&(a+=" "+t.genes.join(" ")),e.push({label:n,value:t.id,searchText:a})}))})),e})),E=["primary","secondary","success","info","warning","error"],N=n((()=>Ze.categories.reduce(((e,t,n)=>(e[t.id]=E[n%E.length],e)),{}))),L=n((()=>Ze.categories.reduce(((e,t)=>(t.tests.forEach((n=>{e[n.id]=t.id})),e)),{})));function O(e){const t=e.id||e.value,n=L.value[t];return N.value[n]||"default"}function V(e){if(ze.debug("Panel selection changed in UI:",e),e&&e.length>0&&(A.value="Category Selection",!k.value&&P.value.length>0)){const t=e[0];for(const e of P.value)if(e.tests.some((e=>e.id===t))){ze.debug("TestSelector: Auto-selecting category from panel:",e.id),k.value=e.id;break}}}return(e,n)=>(r(),g("div",null,[i("h2",null,d(c(t)("testSelector.title")),1),n[8]||(n[8]=s()),l(re,{modelValue:A.value,"onUpdate:modelValue":n[0]||(n[0]=e=>A.value=e),"bg-color":"primary"},{default:o((()=>[l(ae,{value:"Category Selection"},{default:o((()=>[s(d(c(t)("testSelector.tabs.categorySelection")),1)])),_:1}),n[5]||(n[5]=s()),l(ae,{value:"Search"},{default:o((()=>[s(d(c(t)("testSelector.tabs.search")),1)])),_:1})])),_:1},8,["modelValue"]),n[9]||(n[9]=s()),l(se,{modelValue:A.value,"onUpdate:modelValue":n[4]||(n[4]=e=>A.value=e)},{default:o((()=>[l(oe,{value:"Category Selection"},{default:o((()=>[l(X,{dense:"",outlined:"",label:c(t)("testSelector.labels.category"),items:P.value,"item-title":e=>{return(t=e).titles&&t.titles[y.value]?t.titles[y.value]:t.title;var t},"item-value":"id",modelValue:k.value,"onUpdate:modelValue":n[1]||(n[1]=e=>k.value=e),class:"mt-2"},null,8,["label","items","item-title","modelValue"]),n[6]||(n[6]=s()),k.value?(r(),g("div",Ye,[l(X,{dense:"",outlined:"",label:c(t)("testSelector.labels.selectPanels"),items:I.value,"item-title":e=>D(e),"item-value":"id",modelValue:c(x).selectedPanels,"onUpdate:modelValue":[n[2]||(n[2]=e=>c(x).selectedPanels=e),V],"return-object":!1,multiple:"",chips:"","closable-chips":""},{chip:o((({props:e,item:t})=>[l(ie,u({variant:"flat"},{...e,color:O(t)},{onClick:e.onClick,onKeydown:e.onKeydown,close:"","onClick:close":e.onClose}),{default:o((()=>[s(d(t.title),1)])),_:2},1040,["onClick","onKeydown","onClick:close"])])),_:1},8,["label","items","item-title","modelValue"])])):p("",!0)])),_:1}),n[7]||(n[7]=s()),l(oe,{value:"Search"},{default:o((()=>[l(le,{dense:"",outlined:"",label:c(t)("testSelector.labels.searchPlaceholder"),items:F.value,"item-title":"label","item-value":"value",modelValue:c(x).selectedPanels,"onUpdate:modelValue":n[3]||(n[3]=e=>c(x).selectedPanels=e),"custom-filter":w,multiple:"",chips:"","closable-chips":"","hide-selected":"",class:"mt-2"},{chip:o((({props:e,item:t})=>[l(ie,u({variant:"flat"},{...e,color:O(t)},{onClick:e.onClick,onKeydown:e.onKeydown,close:"","onClick:close":e.onClose}),{default:o((()=>[s(d(t.title),1)])),_:2},1040,["onClick","onKeydown","onClick:close"])])),_:1},8,["label","items","modelValue"])])),_:1})])),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-2079cc4e"]]),et={class:"phenotype-selector"},tt={key:0,class:"phenotype-panel"},nt={class:"title"},at={key:0},rt={class:"phenotype-info"},ot={class:"hpo"},it={class:"description"},lt={key:1},st=He({__name:"PhenotypeSelector",props:{groupedPanelDetails:{type:Array,required:!0},modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:t}){w((e=>({"68204b8c":c(qe).styles.phenotypeSelectorBackgroundColor})));const{t:a}=T(),u=T(),y=n((()=>u.locale.value)),b=e,v=t,S=m("patientData",null),P=m("updatePhenotypeData",null),k=f(!1),_=f({});function C(){k.value=!k.value}function A(e){const t=Ze.categories.find((t=>t.id===e));return(null==t?void 0:t.phenotypes)||[]}function I(e){return e.names&&e.names[y.value]?e.names[y.value]:e.name}function F(e){return e.descriptions&&e.descriptions[y.value]?e.descriptions[y.value]:e.description}function E(){if(v("update:modelValue",_.value),P){const e=[];Object.entries(_.value).forEach((([t,n])=>{Object.entries(n).forEach((([n,a])=>{e.push({categoryId:t,phenotypeId:n,status:a})}))})),P(e)}}S&&S.phenotypeData&&S.phenotypeData.length>0&&(ze.debug("PhenotypeSelector: initializing from unified data model with",S.phenotypeData.length,"phenotype items"),ze.debug("PhenotypeSelector: phenotype data items:",S.phenotypeData),S.phenotypeData.forEach((e=>{ze.debug("PhenotypeSelector: processing phenotype item:",e),_.value[e.categoryId]||(ze.debug("PhenotypeSelector: creating new category map for",e.categoryId),_.value[e.categoryId]={}),_.value[e.categoryId][e.phenotypeId]=e.status,ze.debug(`PhenotypeSelector: set ${e.phenotypeId} to ${e.status} in category ${e.categoryId}`)})),ze.debug("PhenotypeSelector: finished initialization, localPhenotypeData =",_.value)),h((()=>b.groupedPanelDetails),(e=>{e.forEach((e=>{if(!_.value[e.id]){const t=Ze.categories.find((t=>t.id===e.id));if(t&&t.phenotypes&&t.phenotypes.length){const n={};t.phenotypes.forEach((e=>{n[e.id]="no input"})),_.value[e.id]=n}}})),E()}),{immediate:!0,deep:!0}),h((()=>null==S?void 0:S.phenotypeData),(e=>{if(ze.debug("PhenotypeSelector: watching unified phenotype data -",(null==e?void 0:e.length)||0,"items"),e&&e.length>0){if(ze.debug("PhenotypeSelector: Found phenotype data in unified model:",e),1!==e.length||e[0].categoryId||e[0].phenotypeId)e.forEach((e=>{e.categoryId&&e.phenotypeId&&e.status?(_.value[e.categoryId]||(ze.debug(`PhenotypeSelector: Creating category ${e.categoryId}`),_.value[e.categoryId]={}),_.value[e.categoryId][e.phenotypeId]=e.status,ze.debug(`PhenotypeSelector: Set ${e.phenotypeId} = ${e.status} in ${e.categoryId}`)):ze.warn("PhenotypeSelector: Invalid phenotype item:",e)}));else{ze.debug("PhenotypeSelector: Detected direct format phenotype data");const t=(null==S?void 0:S.category)||"nephrology";_.value[t]||(ze.debug(`PhenotypeSelector: Creating category ${t} for direct format data`),_.value[t]={}),Object.entries(e[0]).forEach((([e,n])=>{_.value[t][e]=n,ze.debug(`PhenotypeSelector: Set direct format ${e} = ${n} in ${t}`)}))}_.value={..._.value},ze.debug("PhenotypeSelector: Updated phenotype data:",_.value),k.value=!0,ze.debug("PhenotypeSelector: Opening panel to show phenotype data")}}),{immediate:!0,deep:!0});const N=n((()=>b.groupedPanelDetails));return(e,t)=>(r(),g("div",et,[l(B,{color:"primary",small:"",onClick:C},{default:o((()=>[s(d(c(a)(k.value?"phenotypeSelector.toggleButton.hide":"phenotypeSelector.toggleButton.add")),1)])),_:1}),t[7]||(t[7]=s()),l(ue,null,{default:o((()=>[k.value?(r(),g("div",tt,[i("h2",nt,d(c(a)("phenotypeSelector.panelTitle")),1),t[6]||(t[6]=s()),(r(!0),g(D,null,x(N.value,(e=>{var n;return r(),g("div",{key:e.id,class:"category-section"},[i("h3",null,d(e.categoryTitle),1),t[5]||(t[5]=s()),(null==(n=A(e.id))?void 0:n.length)?(r(),g("div",at,[(r(!0),g(D,null,x(A(e.id),(n=>(r(),g("div",{key:n.id,class:"phenotype-item"},[i("div",rt,[i("strong",null,d(I(n)),1),t[0]||(t[0]=s()),i("span",ot,"("+d(n.hpo)+")",1),t[1]||(t[1]=s()),i("p",it,d(F(n)),1)]),t[4]||(t[4]=s()),l(de,{modelValue:_.value[e.id][n.id],"onUpdate:modelValue":t=>_.value[e.id][n.id]=t,inline:"",density:"compact",onChange:t=>(e.id,n.id,void E()),class:"radio-group"},{default:o((()=>[l(ce,{label:c(a)("phenotypeSelector.radioLabels.noInput"),value:"no input",density:"compact"},null,8,["label"]),t[2]||(t[2]=s()),l(ce,{label:c(a)("phenotypeSelector.radioLabels.present"),value:"present",density:"compact"},null,8,["label"]),t[3]||(t[3]=s()),l(ce,{label:c(a)("phenotypeSelector.radioLabels.absent"),value:"absent",density:"compact"},null,8,["label"])])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])))),128))])):(r(),g("div",lt,[i("p",null,d(c(a)("phenotypeSelector.noPhenotypesMessage")),1)]))])})),128))])):p("",!0)])),_:1})]))}},[["__scopeId","data-v-074f1c1a"]]);let dt=25,ct={};function ut(e){try{if("array"===e.store_type)return!1;if("local"!==e.store_type&&"session"!==e.store_type&&void 0!==e.store_type)return!1;let t="test";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}function pt(e){return"PEDIGREE_"+e.btn_target+"_"}function ft(e){return ct[pt(e)]}function ht(e,t){return"local"===e.store_type?localStorage.getItem(t):sessionStorage.getItem(t)}function mt(e,t,n){return"local"===e.store_type?localStorage.setItem(t,n):sessionStorage.setItem(t,n)}function gt(e){let t=pt(e),n="local"===e.store_type?localStorage:sessionStorage,a=[];for(let r=0;r<n.length;r++)0===n.key(r).indexOf(t)&&a.push(n.key(r));for(let r=0;r<a.length;r++)n.removeItem(a[r])}function yt(e){let t;return t=ut(e)?ht(e,pt(e)+"COUNT"):ct[pt(e)+"COUNT"],null!=t?t:0}function bt(e,t){ut(e)?mt(e,pt(e)+"COUNT",t):ct[pt(e)+"COUNT"]=t}function vt(e){if(!e.dataset)return;let t=yt(e);ut(e)?mt(e,pt(e)+t,JSON.stringify(e.dataset)):(dt=500,void 0===ft(e)&&(ct[pt(e)]=[]),ft(e).push(JSON.stringify(e.dataset))),t<dt?t++:t=0,bt(e,t)}function wt(e){if(!ut(e))return ft(e)&&ft(e).length>0?ft(e).length:-1;for(let t=dt;t>0;t--)if(null!==ht(e,pt(e)+(t-1)))return t;return-1}function Dt(e){let t=yt(e)-1;return-1===t&&(t=dt),ut(e)?JSON.parse(ht(e,pt(e)+t)):ft(e)?JSON.parse(ft(e)[t]):void 0}function xt(e,t){if(void 0===t&&(t=yt(e)-2),t<0){let n=wt(e);t=n<dt?n-1:dt-1}return bt(e,t+1),ut(e)?JSON.parse(ht(e,pt(e)+t)):JSON.parse(ft(e)[t])}function St(e,t){return void 0===t&&(t=yt(e)),t>=dt&&(t=0),bt(e,parseInt(t)+1),ut(e)?JSON.parse(ht(e,pt(e)+t)):JSON.parse(ft(e)[t])}function Pt(e){ut(e)&&function(e){"local"===e.store_type?localStorage.clear():sessionStorage.clear()}(e),ct={}}function kt(e,t,n,a){if(ut(e)){let r="local"===e.store_type?localStorage:sessionStorage;t?(mt(e,pt(e)+"_X",t),mt(e,pt(e)+"_Y",n)):(r.removeItem(pt(e)+"_X"),r.removeItem(pt(e)+"_Y"));let o=pt(e)+"_ZOOM";a?mt(e,o,a):r.removeItem(o)}}function _t(e){if(!ut(e)||null===localStorage.getItem(pt(e)+"_X")&&null===sessionStorage.getItem(pt(e)+"_X"))return[null,null];let t=[parseInt(ht(e,pt(e)+"_X")),parseInt(ht(e,pt(e)+"_Y"))];return null!==ht(e,pt(e)+"_ZOOM")&&t.push(parseFloat(ht(e,pt(e)+"_ZOOM"))),t}var Ct=Object.freeze({__proto__:null,clear:Pt,clear_pedigree_data:gt,current:Dt,get_count:yt,getposition:_t,init_cache:vt,last:function(e){if(ut(e))for(let t=dt;t>0;t--){let n=ht(e,pt(e)+(t-1));if(null!==n)return bt(e,t),JSON.parse(n)}else{let t=ft(e);if(t)return JSON.parse(t(t.length-1))}},next:St,nstore:wt,previous:xt,setposition:kt});let At,It={};function Ft(e){return new Error(e)}function Et(e){if(e.validate){if("function"==typeof e.validate)return e.DEBUG,e.validate.call(this,e);let t,n=[],a=[];for(let r=0;r<e.dataset.length;r++){if(!r.hidden&&(e.dataset[r].mother||e.dataset[r].father)){t=e.dataset[r].display_name,t||(t="unnamed"),t+=" (IndivID: "+e.dataset[r].name+")";let n=e.dataset[r].mother,a=e.dataset[r].father;if(!n||!a)throw Ft("Missing parent for "+t);let o=Qt(e.dataset,n),i=Qt(e.dataset,a);if(-1===o)throw Ft("The mother (IndivID: "+n+") of family member "+t+" is missing from the pedigree.");if(-1===i)throw Ft("The father (IndivID: "+a+") of family member "+t+" is missing from the pedigree.");if("F"!==e.dataset[o].sex)throw Ft("The mother of family member "+t+" is not specified as female. All mothers in the pedigree must have sex specified as 'F'.");if("M"!==e.dataset[i].sex)throw Ft("The father of family member "+t+" is not specified as male. All fathers in the pedigree must have sex specified as 'M'.")}if(!e.dataset[r].name)throw Ft(t+" has no IndivID.");if($.inArray(e.dataset[r].name,n)>-1)throw Ft("IndivID for family member "+t+" is not unique.");n.push(e.dataset[r].name),-1===$.inArray(e.dataset[r].famid,a)&&e.dataset[r].famid&&a.push(e.dataset[r].famid)}if(a.length>1)throw Ft("More than one family found: "+a.join(", ")+".");Bt(e.dataset).length}}function Nt(e){e[0].id&&e.sort((function(e,t){return e.id&&t.id?e.id>t.id?1:t.id>e.id?-1:0:0}));let t=["id","parent_node"],n=[];for(let a=0;a<e.length;a++){let r={};for(let n in e[a])-1===t.indexOf(n)&&(r[n]=e[a][n]);n.push(r)}return n}function Lt(e,t){let n=!1;return t&&$.each(t,(function(t,a){if(0===t.indexOf(e+"_")||t===e)return n=!0,n})),n}function Ot(e,t,n,a,r){try{n?$('<div id="msgDialog">'+t+"</div>").dialog({modal:!0,title:e,width:350,buttons:{Yes:function(){$(this).dialog("close"),n(a,r)},No:function(){$(this).dialog("close")}}}):$('<div id="msgDialog">'+t+"</div>").dialog({title:e,width:350,buttons:[{text:"OK",click:function(){$(this).dialog("close")}}]})}catch(o){!function(e,t,n,a,r){const o=document.getElementById("errModal"),i=o.querySelector(".modal-title"),l=o.querySelector(".modal-body");if(n)$("#errModal button.hidden").removeClass("hidden"),$('#errModal button:contains("OK")').on("click",(function(){n(a,r),$('#errModal button:contains("OK")').off("click")}));else{const e=$('#errModal button:contains("CANCEL")');e.hasClass("hidden")||e.addClass("hidden"),$('#errModal button:contains("OK")').off("click")}i.textContent=e,l.textContent=t,$("#errModal").modal("show")}(e,t,n,a,r)}}function Vt(e){let t="";for(let n=0;n<e;n++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random()));return t}function Tt(e,t,n,a,r){void 0===t.children&&(t.children=jt(e.dataset,t)),void 0===a&&(a=[],r=1);let o=Xt(n),i=[];return $.each(t.children,(function(t,n){$.each(e.dataset,(function(t,a){if((n.name===a.mother||n.name===a.father)&&void 0===n.id){let t=tn(o,a.mother),n=tn(o,a.father);t=void 0!==t?t:tn(e.dataset,a.mother),n=void 0!==n?n:tn(e.dataset,a.father),function(e,t,n){for(let a=0;a<e.length;a++)if(e[a].mother===t&&e[a].father===n)return!0;return!1}(i,t,n)||i.push({mother:t,father:n})}}))})),$.merge(a,i),$.each(i,(function(n,a){let i=a.mother,l=a.father;i.children=[];let s={name:Vt(4),hidden:!0,parent:null,father:l,mother:i,children:jt(e.dataset,i,l)},d=Qt(e.dataset,i.name),c=Qt(e.dataset,l.name);"id"in l||"id"in i||(r=zt(t.children,r));let u=function(e,t,n){let a=t,r=n;for(;"mother"in e[a]&&"mother"in e[r]&&!("noparents"in e[a])&&!("noparents"in e[r]);)a=Qt(e,e[a].mother),r=Qt(e,e[r].mother);return{midx:a,fidx:r}}(e.dataset,d,c);u.fidx<u.midx?(l.id=r++,s.id=r++,i.id=r++):(i.id=r++,s.id=r++,l.id=r++),r=Rt(i,s,r,o,e),r=Rt(l,s,r,o,e),t.children.push(s)})),r=zt(t.children,r),$.each(t.children,(function(t,o){r=Tt(e,o,n,a,r)[1]})),[a,r]}function Rt(e,t,n,a,r){if("parent_node"in e?e.parent_node.push(t):e.parent_node=[t],e.mztwin||e.dztwins){let t=Gt(r.dataset,e);for(let e=0;e<t.length;e++){let r=tn(a,t[e].name);r&&(r.id=n++)}}return n}function zt(e,t){return e.sort((function(e,t){return e.mztwin&&t.mztwin&&e.mztwin===t.mztwin||e.dztwin&&t.dztwin&&e.dztwin===t.dztwin?0:e.mztwin||t.mztwin||e.dztwin||t.dztwin?1:0})),$.each(e,(function(e,n){void 0===n.id&&(n.id=t++)})),t}function Mt(e){return void 0!==$(e).attr("proband")&&!1!==$(e).attr("proband")}function Ut(e,t){for(let n=0;n<t.length;n++)-1===$.inArray(t[n],e)&&e.push(t[n])}function qt(e,t,n){if(-1===$.inArray(t.name,e))return;Ut(e,Ht(n,t));let a=Kt(n,t);$.each(a,(function(t,a){-1===$.inArray(a.name,e)&&(e.push(a.name),Ut(e,Ht(n,a)))}))}function Ht(e,t){let n=[];for(let a=0;a<e.length;a++){let r=e[a];t.name===r.mother&&-1===$.inArray(r.father,n)?n.push(r.father):t.name===r.father&&-1===$.inArray(r.mother,n)&&n.push(r.mother)}return n}function Bt(e){let t=e[$t(e)];if(!t){if(0===e.length)throw new Error("empty pedigree data set");t=e[0]}let n=[t.name],a=!0,r=0;for(;a&&r<200;){r++;let o=n.length;$.each(e,(function(a,r){if(-1!==$.inArray(r.name,n)){let a=Ht(e,r),o=r.name===t.name||!r.noparents;for(let t=0;t<a.length;t++)tn(e,a[t]).noparents||(o=!0);o&&(r.mother&&-1===$.inArray(r.mother,n)&&n.push(r.mother),r.father&&-1===$.inArray(r.father,n)&&n.push(r.father))}else!r.noparents&&(r.mother&&-1!==$.inArray(r.mother,n)||r.father&&-1!==$.inArray(r.father,n))&&n.push(r.name);qt(n,r,e)})),a=o!==n.length}let o=$.map(e,(function(e,t){return e.name}));return $.map(o,(function(e,t){return-1===$.inArray(e,n)?e:null}))}function $t(e){let t;return $.each(e,(function(e,n){if(Mt(n))return t=e,t})),t}function jt(e,t,n){let a=[],r=[];return"F"===t.sex&&$.each(e,(function(e,o){t.name===o.mother&&(n&&n.name!==o.father||-1===$.inArray(o.name,r)&&(a.push(o),r.push(o.name)))})),a}function Gt(e,t){let n=function(e,t){return void 0===t||!t.mother||t.noparents?[]:$.map(e,(function(e,n){return e.name===t.name||"noparents"in e||!e.mother||e.mother!==t.mother||e.father!==t.father?null:e}))}(e,t),a=t.mztwin?"mztwin":"dztwin";return $.map(n,(function(e,n){return e.name!==t.name&&e[a]===t[a]?e:null}))}function Jt(e,t,n){return $.map(e,(function(e,a){return e.name===t.name||"noparents"in e||!e.mother||e.mother!==t.mother||e.father!==t.father||n&&e.sex!==n?null:e}))}function Kt(e,t,n){return $.map(e,(function(e,a){return"noparents"in e||e.mother!==t.name&&e.father!==t.name||n&&e.sex!==n?null:e}))}function Wt(e,t){let n=Qt(e,t),a=1;for(;n>=0&&("mother"in e[n]||e[n].top_level);)n=Qt(e,e[n].mother),a++;return a}function Qt(e,t){let n=-1;return $.each(e,(function(e,a){if(t===a.name)return n=e,n})),n}function Zt(e,t,n){return $.map(e,(function(e,a){return e.depth!==t||e.data.hidden||-1!==$.inArray(e.data.name,n)?null:e})).sort((function(e,t){return e.x-t.x}))}function Yt(e,t){let n=[];return function t(a){a.data&&(a=a.data),"mother"in a&&"father"in a&&!("noparents"in a)&&(t(tn(e,a.mother)),t(tn(e,a.father))),n.push(a)}(t),n}function Xt(e){let t=[];return function e(n){n.children&&n.children.forEach(e),t.push(n)}(e),t}function en(e,t,n,a,r){for(let o=0;o<t.length;o++)if(a===t[o].depth&&-1===$.inArray(t[o].data.name,r)&&Math.abs(n-t[o].x)<1.15*e.symbol_size)return!0;return!1}function tn(e,t){for(let n=0;n<e.length;n++){if(e[n].data&&t===e[n].data.name)return e[n];if(t===e[n].name)return e[n]}}function nn(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function an(e){return{width:nn()?window.innerWidth:e.width,height:nn()?window.innerHeight:e.height}}function rn(e,t){let n=e.symbol_size/2,a=2.5*-e.symbol_size;At=d3.zoom().scaleExtent([e.zoomIn,e.zoomOut]).filter((function(t){return!((!e.zoomSrc||-1===e.zoomSrc.indexOf("wheel"))&&t.type&&"wheel"===t.type||"dblclick"===t.type||t.button)})).on("zoom",(function(t){!function(e,t){t.DEBUG;let n=e.transform,a=n.k&&1!==n.k?n.k:void 0;kt(t,n.x,n.y,a),d3.select("#"+t.targetDiv).select(".diagram").attr("transform","translate("+n.x+","+n.y+")"+(a?" scale("+a+")":""))}(t,e)})),t.call(At);let r=_t(e),o=3===r.length?r[2]:1,i=null!==r[0]?r[0]/o:n*o,l=null!==r[1]?r[1]/o:a*o;var s=d3.zoomIdentity.scale(o).translate(i,l);t.call(At.transform,s)}function on(e,t){d3.select("#"+e.targetDiv).select("svg").transition().duration(50).call(At.scaleBy,t)}function ln(e){let t=function(e){let t=sn(e);return{wid:Math.abs(t.xmax-t.xmin),hgt:Math.abs(t.ymax-t.ymin)}}(e),n=d3.select("#"+e.targetDiv).select("svg"),a=function(e){return{w:e.node().clientWidth,h:e.node().clientHeight}}(n),r=1/Math.max(t.wid/a.w,t.hgt/a.h);r<e.zoomIn&&At.scaleExtent([r,e.zoomOut]);let o=function(e){let t=sn(e);return{x:t.xmin+(t.xmax-t.xmin)/2,y:t.ymin+(t.ymax-t.ymin)/2}}(e);n.call(At.translateTo,o.x-e.symbol_size,o.y-e.symbol_size),setTimeout((function(){n.transition().duration(700).call(At.scaleTo,r)}),400)}function sn(e){let t=d3.select("#"+e.targetDiv).select(".diagram"),n=Number.MAX_VALUE,a=-1e6,r=Number.MAX_VALUE,o=-1e6,i=e.symbol_size;return t.selectAll("g").each((function(t,l){if(t.x&&"hidden_root"!==t.data.name&&!t.data.hidden){let l=function(e,t,n){let a=d3.select(t).node().getBBox(),r=a.width,o=a.height;if(0===r&&0===o)try{r=2*n,o=2*n;let a=d3.select(t).selectAll(".indi_details");for(let t=0;t<a._groups[0].length;t++){let i=dn(a._groups[0][t].firstChild.nodeValue,e.font_family,e.font_size);r=Math.max(i.w+n/2,r),o=Math.max(2*n+t*i.h,o)}}catch(i){r=2*n,o=2*n}return{w:r,h:o}}(e,this,i);t.x-i<n&&(n=t.x-i),t.x+l.w+i>a&&(a=t.x+l.w+i),t.y<r&&(r=t.y),t.y+l.h+i>o&&(o=t.y+l.h+i)}})),{xmin:n,xmax:a,ymin:r,ymax:o}}function dn(e,t,n){let a=$("<div></div>").text(e).css({position:"absolute",float:"left","white-space":"nowrap",visibility:"hidden",font:t||"Helvetica",fontSize:n||"1em"}).appendTo($("body")),r={w:a.width(),h:a.height()};return a.remove(),r}var cn=Object.freeze({__proto__:null,btn_zoom:on,get_bounds:sn,init_zoom:rn,scale_to_fit:ln});function un(e){let t;if(e.keep_proband_on_reset){let n=Nt(Dt(e));t=n[$t(n)],t.name="ch1",t.mother="f21",t.father="m21",gt(e)}else t={name:"ch1",sex:"F",mother:"f21",father:"m21",proband:!0,status:"0",display_name:"me"},Pt(e);delete e.dataset;let n=$("input[name='default_fam']:checked");n.length>0&&"extended2"===n.val()?e.dataset=[{name:"wZA",sex:"M",top_level:!0,status:"0",display_name:"paternal grandfather"},{name:"MAk",sex:"F",top_level:!0,status:"0",display_name:"paternal grandmother"},{name:"zwB",sex:"M",top_level:!0,status:"0",display_name:"maternal grandfather"},{name:"dOH",sex:"F",top_level:!0,status:"0",display_name:"maternal grandmother"},{name:"MKg",sex:"F",mother:"MAk",father:"wZA",status:"0",display_name:"paternal aunt"},{name:"xsm",sex:"M",mother:"MAk",father:"wZA",status:"0",display_name:"paternal uncle"},{name:"m21",sex:"M",mother:"MAk",father:"wZA",status:"0",display_name:"father"},{name:"f21",sex:"F",mother:"dOH",father:"zwB",status:"0",display_name:"mother"},{name:"aOH",sex:"F",mother:"f21",father:"m21",status:"0",display_name:"sister"},{name:"Vha",sex:"M",mother:"f21",father:"m21",status:"0",display_name:"brother"},{name:"Spj",sex:"M",mother:"f21",father:"m21",noparents:!0,status:"0",display_name:"partner"},t,{name:"zhk",sex:"F",mother:"ch1",father:"Spj",status:"0",display_name:"daughter"},{name:"Knx",display_name:"son",sex:"M",mother:"ch1",father:"Spj",status:"0"},{name:"uuc",display_name:"maternal aunt",sex:"F",mother:"dOH",father:"zwB",status:"0"},{name:"xIw",display_name:"maternal uncle",sex:"M",mother:"dOH",father:"zwB",status:"0"}]:n.length>0&&"extended1"===n.val()?e.dataset=[{name:"m21",sex:"M",mother:null,father:null,status:"0",display_name:"father",noparents:!0},{name:"f21",sex:"F",mother:null,father:null,status:"0",display_name:"mother",noparents:!0},{name:"aOH",sex:"F",mother:"f21",father:"m21",status:"0",display_name:"sister"},{name:"Vha",sex:"M",mother:"f21",father:"m21",status:"0",display_name:"brother"},{name:"Spj",sex:"M",mother:"f21",father:"m21",noparents:!0,status:"0",display_name:"partner"},t,{name:"zhk",sex:"F",mother:"ch1",father:"Spj",status:"0",display_name:"daughter"},{name:"Knx",display_name:"son",sex:"M",mother:"ch1",father:"Spj",status:"0"}]:e.dataset=[{name:"m21",display_name:"father",sex:"M",top_level:!0},{name:"f21",display_name:"mother",sex:"F",top_level:!0},t],$(document).trigger("rebuild",[e])}let pn={breast_cancer:"breast_cancer_diagnosis_age",breast_cancer2:"breast_cancer2_diagnosis_age",ovarian_cancer:"ovarian_cancer_diagnosis_age",prostate_cancer:"prostate_cancer_diagnosis_age",pancreatic_cancer:"pancreatic_cancer_diagnosis_age"},fn=["brca1","brca2","palb2","atm","chek2","rad51d","rad51c","brip1"],hn=["brca1","brca2","palb2","atm","chek2","bard1","rad51d","rad51c","brip1"],mn=["brca1","brca2","palb2","atm","chek2","bard1","rad51d","rad51c","brip1","hoxb13"],gn=["er","pr","her2","ck14","ck56"];function yn(e){return 1===(e=parseInt(e))?fn:2===e||3===e?hn:mn}function bn(e){$("#load").change((function(t){!function(e,t){let n=e.target.files[0];if(n){let e=new FileReader;e.onload=function(e){An(e.target.result,t)},e.onerror=function(){Ot("File Error","File could not be read! Code "+e.error)},e.readAsText(n)}$("#load")[0].value=""}(t,e)})),$("#save").click((function(t){!function(e){_n(e,JSON.stringify(Dt(e)))}(e)})),$("#print").click((function(t){kn(Sn(e))})),$("#svg_download").click((function(t){Pn(Sn(e))})),$("#png_download, .fa-file-image").click((function(t){wn(e,4,"image/png")}))}function vn(e,t){let n=["svg","g"],a=e.childNodes,r=t.childNodes;for(let i=0;i<a.length;i++){let e=a[i];if(-1===n.indexOf(e.tagName))try{let t=r[i].currentStyle||window.getComputedStyle(r[i]);if("undefined"===t||null===t)continue;let n=t.length,a=e.style;for(let e=0;e<n;e++){let n=t[e];(n.indexOf("text-")>-1||n.indexOf("font-")>-1)&&a.setProperty(n,t.getPropertyValue(n))}}catch(o){continue}else vn(e,r[i])}}function wn(e,t,n){let a=xn($("#"+e.targetDiv).find("svg"),"pedigree",{resolution:t,img_type:n});$.when.apply($,[a]).done((function(){let e=(t=arguments,$.grep(t,(function(e){return e&&"pedigree"===e.name}))[0]);var t;if(navigator.userAgent.match(/Edge/g)||function(){let e=navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1}()){let t="<img src='"+e.img+"' alt='canvas image'/>";window.open().document.write(t)}else{let t=document.createElement("a");t.href=e.img,t.download="plot.png",t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}}))}function Dn(e){let t=e.get(0).cloneNode(!0);d3.select(t).selectAll("text").filter((function(){return 0===d3.select(this).text().length||d3.select(this),"FontAwesome"===d3.select(this).attr("font-family")})).remove(),vn(t,e.get(0));let n=(new XMLSerializer).serializeToString(t);return"data:image/svg+xml;base64,"+window.btoa(decodeURI(encodeURI(n)))}function xn(e,t,n){let a={iscanvg:!1,resolution:1,img_type:"image/png"};n||(n=a),$.each(a,(function(e,t){e in n||(n[e]=t)}));let r=$.Deferred(),o=Dn(e),i=document.createElement("canvas");i.width=e.width()*n.resolution,i.height=e.height()*n.resolution;let l=i.getContext("2d");l.fillStyle="white",l.fillRect(0,0,i.width,i.height);let s=document.createElement("img");return s.onload=function(){l.drawImage(s,0,0,i.width,i.height),r.resolve({name:t,resolution:n.resolution,img:i.toDataURL(n.img_type,1),w:i.width,h:i.height}),l.clearRect(0,0,i.width,i.height)},s.src=o,r.promise()}function Sn(e){let t=Dt(e);null!=t&&(e.dataset=t);let n=$("<div></div>"),a=$("#"+e.targetDiv).find("svg").clone().appendTo(n),r=sn(e),o=Math.abs(r.xmax-r.xmin),i=Math.abs(r.ymax-r.ymin),l=1/Math.max(o/555,i/792),s=-(r.xmin-e.symbol_size)*l,d=-(r.ymin-e.symbol_size)*l;return a.attr("width",555),a.attr("height",i*l),a.find(".diagram").attr("transform","translate("+s+", "+d+") scale("+l+")"),n}function Pn(e){let t=document.createElement("a");t.href=Dn(e),t.download="plot.svg",t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function kn(e,t){e.constructor!==Array&&(e=[e]);let n=.9*$(window).width(),a=$(window).height()-10,r=["/static/css/canrisk.css","https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"],o=window.open("","PrintMap","width="+n+",height="+a),i="";for(let s=0;s<r.length;s++)i+='<link href="'+r[s]+'" rel="stylesheet" type="text/css" media="all">';i+="<style>body {font-size: "+$("body").css("font-size")+";}</style>";let l="";for(let s=0;s<e.length;s++)0===s&&t&&(l+=t),l+=$(e[s]).html(),s<e.length-1&&(l+='<div class="page-break"> </div>');o.document.write(i),o.document.write(l),o.document.close(),o.focus(),setTimeout((function(){o.print(),o.close()}),300)}function _n(e,t,n,a){e.DEBUG,n||(n="ped.txt"),a||(a="text/plain");let r=new Blob([t],{type:a});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r,n);else{let e=document.createElement("a"),t=URL.createObjectURL(r);e.href=t,e.download=n,document.body.appendChild(e),e.click(),setTimeout((function(){document.body.removeChild(e),window.URL.revokeObjectURL(t)}),0)}}function Cn(e){$.each(e.dataset,(function(e,t){if(!t.hidden&&"M"===t.sex&&!Mt(t)&&t[pn.breast_cancer2]){let e="Male family member ("+t.display_name+") with contralateral breast cancer found. Please note that as the risk models do not take this into account the second breast cancer is ignored.";delete t[pn.breast_cancer2],Ot("Warning",e)}}))}function An(e,t){let n;t.DEBUG;try{if(0===e.indexOf("BOADICEA import pedigree file format 4.0"))t.dataset=En(e,4),Cn(t);else if(0===e.indexOf("BOADICEA import pedigree file format 2.0"))t.dataset=En(e,2),Cn(t);else if(0===e.indexOf("##")&&-1!==e.indexOf("CanRisk")){let a=Fn(e);n=a[0],t.dataset=a[1],Cn(t)}else try{let n=JSON.parse(e),a=!0;for(let e=0;e<n.length;e++)n[e].top_level&&(a=!1);t.dataset=a?Nn(n):n}catch(a){t.dataset=In(e)}Et(t)}catch(r){return void Ot("File Error",r.message?r.message:r)}t.DEBUG;try{kt(t),$(document).trigger("rebuild",[t]),$(document).trigger("riskfactorChange",[t,n]),$(document).trigger("fhChange",[t]);try{acc_FamHist_ticked(),acc_FamHist_Leave(),RESULT.FLAG_FAMILY_MODAL=!0}catch(o){}}catch(i){Ot("File Error",i.message?i.message:i)}}function In(e){let t,n=e.trim().split("\n"),a=[];for(let r=0;r<n.length;r++){let e=$.map(n[r].trim().split(/\s+/),(function(e,t){return e.trim()}));if(e.length<5)throw new Error("unknown format");let o="1"===e[4]?"M":"2"===e[4]?"F":"U",i={famid:e[0],display_name:e[1],name:e[1],sex:o};if("0"!==e[2]&&(i.father=e[2]),"0"!==e[3]&&(i.mother=e[3]),void 0!==t&&t!==i.famid)break;if("2"===e[5]&&(i.affected=2),e.length>6){i.alleles="";for(let t=6;t<e.length;t+=2)i.alleles+=e[t]+"/"+e[t+1]+";"}a.unshift(i),t=e[0]}return Nn(a)}function Fn(e){let[t,n]=function(e){let t=e.trim().split("\n"),n=[],a=[];const r=/([0-9])/;let o=3,i=yn(o),l=[26,27,27,28];for(let s=0;s<t.length;s++){let e=t[s].trim();if(0===e.indexOf("##")){if(0===e.indexOf("##CanRisk")){const t=e.match(r);if(o=parseInt(t[1]),i=yn(o),e.indexOf(";")>-1){let t=e.split(";");for(let e=1;e<t.length;e++)2===t[e].split("=").length&&a.push(t[e])}}-1===e.indexOf("CanRisk")&&0!==e.indexOf("##FamID")&&a.push(e.replace("##",""));continue}let d=/\t/;e.indexOf("\t")<0&&(d=/\s+/);let c=$.map(e.split(d),(function(e,t){return e.trim()}));if(c.length>1){if(c.length!==l[o-1])throw new Error("Found number of columns "+c.length+"; expected "+l[o-1]+" for CanRisk version "+o);let e={famid:c[0],display_name:c[1],name:c[3],sex:c[6],status:c[8]};"1"===c[2]&&(e.proband=!0),"0"!==c[4]&&(e.father=c[4]),"0"!==c[5]&&(e.mother=c[5]),"0"!==c[7]&&(e.mztwin=c[7]),"0"!==c[9]&&(e.age=c[9]),"0"!==c[10]&&(e.yob=c[10]);let t=11;$.each(pn,(function(n,a){"0"!==c[t]&&(e[a]=c[t]),t++})),"0"!==c[t++]&&(e.ashkenazi=1);for(let n=0;n<i.length;n++){let a=c[t].split(":");"0"!==a[0]?"S"!==a[0]&&"T"!==a[0]||"P"!==a[1]&&"N"!==a[1]||(e[i[n]+"_gene_test"]={type:a[0],result:a[1]}):"P"!==a[1]&&"N"!==a[1]||(e[i[n]+"_gene_test"]={type:a[0],result:a[1]}),t++}let a=c[t].split(":");for(let n=0;n<a.length;n++)"0"!==a[n]&&("N"!==a[n]&&"P"!==a[n]||(e[gn[n]+"_bc_pathology"]=a[n]));n.push(e)}}return n.sort((function(e,t){return void 0!==e.mztwin?e.mztwin.localeCompare(t.mztwin):0})),[a,n]}(e);try{return[t,Nn(n)]}catch(a){return[t,n]}}function En(e,t){let n=e.trim().split("\n"),a=[];for(let o=2;o<n.length;o++){let e=$.map(n[o].trim().split(/\s+/),(function(e,t){return e.trim()}));if(e.length>1){let n={famid:e[0],display_name:e[1],name:e[3],sex:e[6],status:e[8]};"1"===e[2]&&(n.proband=!0),"0"!==e[4]&&(n.father=e[4]),"0"!==e[5]&&(n.mother=e[5]),"0"!==e[7]&&(n.mztwin=e[7]),"0"!==e[9]&&(n.age=e[9]),"0"!==e[10]&&(n.yob=e[10]);let r=11;if($.each(pn,(function(t,a){"0"!==e[r]&&(n[a]=e[r]),r++})),4===t){"0"!==e[r++]&&(n.ashkenazi=1);for(let t=0;t<5;t++)r+=2,"0"!==e[r-2]&&("S"!==e[r-2]&&"T"!==e[r-2]||"P"!==e[r-1]&&"N"!==e[r-1]||(n[fn[t]+"_gene_test"]={type:e[r-2],result:e[r-1]}))}else 2===t&&(r+=2,"0"!==e[r-2]&&("S"!==e[r-2]&&"T"!==e[r-2]||("N"===e[r-1]?(n.brca1_gene_test={type:e[r-2],result:"N"},n.brca2_gene_test={type:e[r-2],result:"N"}):"1"===e[r-1]?(n.brca1_gene_test={type:e[r-2],result:"P"},n.brca2_gene_test={type:e[r-2],result:"N"}):"2"===e[r-1]?(n.brca1_gene_test={type:e[r-2],result:"N"},n.brca2_gene_test={type:e[r-2],result:"P"}):"3"===e[r-1]&&(n.brca1_gene_test={type:e[r-2],result:"P"},n.brca2_gene_test={type:e[r-2],result:"P"}))),"0"!==e[r++]&&(n.ashkenazi=1));for(let t=0;t<gn.length;t++)"0"!==e[r]&&("N"!==e[r]&&"P"!==e[r]||(n[gn[t]+"_bc_pathology"]=e[r])),r++;a.unshift(n)}}try{return Nn(a)}catch(r){return a}}function Nn(e){for(let n=0;n<2;n++)for(let t=0;t<e.length;t++)On(e,e[t].name);!function(e){let t=!1,n=e.length;for(let a=0;a<n;a++){let n=jt(e,e[a]),r=e[a].level;for(let a=0;a<n.length;a++)if(r-n[a].level>1){n[a].level=r-1;let o=Ht(e,n[a]);for(let t=0;t<o.length;t++){let n=tn(e,o[t]);n.level=r-1;let a=tn(e,n.mother),i=tn(e,n.father);a&&(a.level=r),i&&(i.level=r)}t=!0}}}(e);let t=0;for(let n=0;n<e.length;n++)e[n].level&&e[n].level>t&&(t=e[n].level);for(let n=0;n<e.length;n++)if(1===Wt(e,e[n].name))if(e[n].level&&e[n].level===t)e[n].top_level=!0;else{e[n].noparents=!0;let t=Ln(e,e[n]);if(t>-1&&e[t].mother&&(e[n].mother=e[t].mother,e[n].father=e[t].father),!e[n].mother)for(let a=0;a<e.length;a++)if(e[n].level===e[a].level-1&&(t=Ln(e,e[a]),t>-1&&n!==t)){e[n].mother="F"===e[a].sex?e[a].name:e[t].name,e[n].father="M"===e[a].sex?e[a].name:e[t].name;break}}else delete e[n].top_level;return e}function Ln(e,t){for(let n=0;n<e.length;n++){let a=e[n];if(t.name===a.mother)return Qt(e,a.father);if(t.name===a.father)return Qt(e,a.mother)}return-1}function On(e,t){let n=Qt(e,t);Vn(n,e[n].level?e[n].level:0,e)}function Vn(e,t,n){let a=["mother","father"];t++;for(let r=0;r<a.length;r++){let o=Qt(n,n[e][a[r]]);if(o>=0){let a=n[Qt(n,n[e].mother)],r=n[Qt(n,n[e].father)];(!n[o].level||n[o].level<t)&&(a.level=t,r.level=t),a.level<r.level?a.level=r.level:r.level<a.level&&(r.level=a.level),Vn(o,t,n)}}}var Tn=Object.freeze({__proto__:null,addIO:bn,copy_svg:function(e){let t=Sn(e);return d3.select(t.get(0)).selectAll("text").filter((function(){return 0===d3.select(this).text().length||d3.select(this),"FontAwesome"===d3.select(this).attr("font-family")})).remove(),$(function(e){let t=function(e,t){let n=[],a=0;t.lastIndex=0;let r=t.exec(e);for(;r;){if(a++,a>400)return-1;n.push(r),t.lastIndex===r.index&&t.lastIndex++,r=t.exec(e)}return n}(e,/url\((&quot;|"|'){0,1}#(.*?)(&quot;|"|'){0,1}\)/g);return-1===t?"ERROR DISPLAYING PEDIGREE":($.each(t,(function(t,n){let a=n[1]?n[1]:"",r=n[2],o='id="'+r+'"',i="url\\("+a+"#"+r+a+"\\)",l=r+Vt(2);e=(e=e.replace(new RegExp(o,"g"),'id="'+l+'"')).replace(new RegExp(i,"g"),"url(#"+l+")")})),e)}(t.html()))},img_download:wn,load_data:An,print:kn,readBoadiceaV4:En,readCanRiskFile:Fn,readLinkage:In,save_file:_n,svg2img:xn,svg_download:Pn});function Rn(e,t){let n=[1,2,3,4,5,6,7,8,9,"A"];for(let a=0;a<e.length;a++)if(e[a][t]){let r=n.indexOf(e[a][t]);r>-1&&n.splice(r,1)}if(n.length>0)return n[0]}let zn,Mn;function Un(e,t){let n=parseInt($("body").css("font-size")),a=d3.select(".diagram");a.append("rect").attr("class","popup_selection").attr("rx",6).attr("ry",6).attr("transform","translate(-1000,-100)").style("opacity",0).attr("width",7.9*n).attr("height",2*n).style("stroke","darkgrey").attr("fill","white");let r=a.append("text").attr("font-family","FontAwesome").style("opacity",0).style("font-size","1.1em").attr("class","popup_selection fa-square persontype").attr("transform","translate(-1000,-100)").attr("x",n/3).attr("y",1.5*n).text(" ").append("svg:title").text("add male"),o=a.append("text").attr("font-family","FontAwesome").style("opacity",0).style("font-size","1.1em").attr("class","popup_selection fa-circle persontype").attr("transform","translate(-1000,-100)").attr("x",1.71*n).attr("y",1.5*n).text(" ").append("svg:title").text("add female");a.append("text").attr("font-family","FontAwesome").style("opacity",0).style("font-size","1.1em").attr("transform","translate(-1000,-100)").attr("x",.065*n).attr("y",.065*-n).attr("class","popup_selection fa-unspecified popup_selection_rotate45 persontype").text(" ").append("svg:title").text("add unspecified"),a.append("text").attr("font-family","FontAwesome").style("opacity",0).style("font-size","1.6em").attr("transform","translate(-1000,-100)").attr("class","popup_selection fa-angle-up persontype dztwin").attr("x",4.62*n).attr("y",1.5*n).text(" ").append("svg:title").text("add dizygotic/fraternal twins"),a.append("text").attr("font-family","FontAwesome").style("opacity",0).style("font-size","1.6em").attr("transform","translate(-1000,-100)").attr("class","popup_selection fa-caret-up persontype mztwin").attr("x",6.4*n).attr("y",1.5*n).text(" ").append("svg:title").text("add monozygotic/identical twins");let i={};d3.selectAll(".persontype").on("click",(function(){let t,n,a=Nt(Dt(e)),r=d3.select(this).classed("mztwin"),o=d3.select(this).classed("dztwin");if(r||o?(n=i.node.datum().data.sex,t=r?"mztwin":"dztwin"):n=d3.select(this).classed("fa-square")?"M":d3.select(this).classed("fa-circle")?"F":"U","addsibling"===i.type)$n(a,i.node.datum().data,n,!1,t);else{if("addchild"!==i.type)return;!function(e,t,n,a,r){if(r&&-1===$.inArray(r,["mztwin","dztwin"]))return new Error("INVALID TWIN TYPE SET: "+r);void 0===a&&(a=1);let o,i,l,s=Kt(e,t);if(0===s.length){let n=$n(e,t,"F"===t.sex?"M":"F","F"===t.sex);n.noparents=!0,o=n.name,i=Qt(e,t.name)+1}else{let n=s[0];o=n.father===t.name?n.mother:n.father,i=Qt(e,n.name)}r&&(l=Rn(e,r));let d=[];for(let c=0;c<a;c++){let a={name:Vt(4),sex:n,mother:"F"===t.sex?t.name:o,father:"F"===t.sex?o:t.name};e.splice(i,0,a),r&&(a[r]=l),d.push(a)}}(a,i.node.datum().data,t?"U":n,t?2:1,t)}e.dataset=a,$(document).trigger("rebuild",[e]),d3.selectAll(".popup_selection").style("opacity",0),i={}})).on("mouseover",(function(){i.node&&i.node.select("rect").style("opacity",.2),d3.selectAll(".popup_selection").style("opacity",1),"addsibling"===i.type?d3.select(this).classed("fa-square")?r.text("add brother"):o.text("add sister"):"addchild"===i.type&&(d3.select(this).classed("fa-square")?r.text("add son"):o.text("add daughter"))})),d3.selectAll(".popup_selection").on("mouseout",(function(){void 0!==i.node&&-1===u.indexOf(i.node.datum())&&i.node.select("rect").style("opacity",0),d3.selectAll(".popup_selection").style("opacity",0)})),function(e){d3.select(".diagram").append("line").attr("class","line_drag_selection").attr("stroke-width",6).style("stroke-dasharray","2, 1").attr("stroke","black").call(d3.drag().on("start",(function(){zn=Mn,d3.selectAll(".line_drag_selection").attr("stroke","darkred")})).on("drag",(function(t){t.sourceEvent.stopPropagation();let n=t.dx,a=t.dy,r=parseFloat(d3.select(this).attr("x2"))+n,o=parseFloat(d3.select(this).attr("y2"))+a;Hn(e.symbol_size-10,0,r,o)})).on("end",(function(t){if(Mn&&zn.data.name!==Mn.data.name&&zn.data.sex!==Mn.data.sex){let t={name:Vt(4),sex:"U",mother:"F"===zn.data.sex?zn.data.name:Mn.data.name,father:"F"===zn.data.sex?Mn.data.name:zn.data.name},n=Nt(e.dataset);e.dataset=n;let a=Qt(e.dataset,zn.data.name)+1;e.dataset.splice(a,0,t),$(document).trigger("rebuild",[e])}Hn(0,0,0,0),d3.selectAll(".line_drag_selection").attr("stroke","black"),zn=void 0}))).append("svg:title").text("drag to create consanguineous partners"),Hn(0,0,0,0)}(e),t.filter((function(t){return!(t.data.hidden&&!e.DEBUG)})).append("rect").attr("class","indi_rect").attr("rx",6).attr("ry",6).attr("x",(function(t){return-.75*e.symbol_size})).attr("y",(function(t){return-e.symbol_size})).attr("width",1.5*e.symbol_size+"px").attr("height",2*e.symbol_size+"px").style("stroke","black").style("stroke-width",.7).style("opacity",0).attr("fill","lightgrey");let l=function(t){return d-.75*e.symbol_size},s=e.symbol_size-2,d=0,c={addchild:{text:"",title:"add child",fx:l,fy:s},addsibling:{text:"",title:"add sibling",fx:l,fy:s},addpartner:{text:"",title:"add partner",fx:l,fy:s},addparents:{text:"",title:"add parents",fx:-.75*e.symbol_size,fy:11-e.symbol_size},delete:{text:"X",title:"delete",fx:e.symbol_size/2-1,fy:12-e.symbol_size,styles:{"font-weight":"bold",fill:"darkred","font-family":"monospace"}}};e.edit&&(c.settings={text:"",title:"settings",fx:-n/2+2,fy:11-e.symbol_size});for(let p in c){let n=t.filter((function(t){return!(t.data.hidden&&!e.DEBUG||(void 0===t.data.mother||t.data.noparents)&&"addsibling"===p||void 0!==t.data.parent_node&&t.data.parent_node.length>1&&"addpartner"===p||void 0===t.data.parent_node&&"addchild"===p||void 0===t.data.noparents&&void 0===t.data.top_level&&"addparents"===p)})).append("text").attr("class",p).style("opacity",0).attr("font-family","FontAwesome").attr("xx",(function(e){return e.x})).attr("yy",(function(e){return e.y})).attr("x",c[p].fx).attr("y",c[p].fy).attr("font-size","0.85em").text(c[p].text);if("styles"in c[p])for(let e in c[p].styles)n.attr(e,c[p].styles[e]);n.append("svg:title").text(c[p].title),d+=17}d3.selectAll(".addsibling, .addchild").on("mouseover",(function(){let e=d3.select(this).attr("class");d3.selectAll(".popup_selection").style("opacity",1),i={node:d3.select(this.parentNode),type:e};let t=parseInt(d3.select(this).attr("xx"))+parseInt(d3.select(this).attr("x")),a=parseInt(d3.select(this).attr("yy"))+parseInt(d3.select(this).attr("y"));d3.selectAll(".popup_selection").attr("transform","translate("+t+","+(a+2)+")"),d3.selectAll(".popup_selection_rotate45").attr("transform","translate("+(t+3*n)+","+(a+1.2*n)+") rotate(45)")})),d3.selectAll(".addchild, .addpartner, .addparents, .delete, .settings").on("click",(function(t){t.stopPropagation();let n,a=d3.select(this).attr("class"),r=d3.select(this.parentNode).datum();e.DEBUG,"settings"===a?"function"==typeof e.edit?e.edit(e,r):function(e,t){$("#node_properties").dialog({autoOpen:!1,title:t.data.display_name,width:$(window).width()>400?450:$(window).width()-30});let n="<table id='person_details' class='table'>";n+="<tr><td style='text-align:right'>Unique ID</td><td><input class='form-control' type='text' id='id_name' name='name' value="+(t.data.name?t.data.name:"")+"></td></tr>",n+="<tr><td style='text-align:right'>Name</td><td><input class='form-control' type='text' id='id_display_name' name='display_name' value="+(t.data.display_name?t.data.display_name:"")+"></td></tr>",n+="<tr><td style='text-align:right'>Age</td><td><input class='form-control' type='number' id='id_age' min='0' max='120' name='age' style='width:7em' value="+(t.data.age?t.data.age:"")+"></td></tr>",n+="<tr><td style='text-align:right'>Year Of Birth</td><td><input class='form-control' type='number' id='id_yob' min='1900' max='2050' name='yob' style='width:7em' value="+(t.data.yob?t.data.yob:"")+"></td></tr>",n+='<tr><td colspan="2" id="id_sex"><label class="radio-inline"><input type="radio" name="sex" value="M" '+("M"===t.data.sex?"checked":"")+'>Male</label><label class="radio-inline"><input type="radio" name="sex" value="F" '+("F"===t.data.sex?"checked":"")+'>Female</label><label class="radio-inline"><input type="radio" name="sex" value="U">Unknown</label></td></tr>',n+='<tr><td colspan="2" id="id_status"><label class="checkbox-inline"><input type="radio" name="status" value="0" '+(0===parseInt(t.data.status)?"checked":"")+'>&thinsp;Alive</label><label class="checkbox-inline"><input type="radio" name="status" value="1" '+(1===parseInt(t.data.status)?"checked":"")+">&thinsp;Deceased</label></td></tr>",$("#id_status input[value='"+t.data.status+"']").prop("checked",!0);let a=["adopted_in","adopted_out","miscarriage","stillbirth","termination"];n+='<tr><td colspan="2"><strong>Reproduction:</strong></td></tr>',n+='<tr><td colspan="2">';for(let o=0;o<a.length;o++){let e=a[o];2===o&&(n+='</td></tr><tr><td colspan="2">'),n+='<label class="checkbox-inline"><input type="checkbox" id="id_'+e+'" name="'+e+'" value="0" '+(t.data[e]?"checked":"")+">&thinsp;"+Bn(e.replace("_"," "))+"</label>"}n+="</td></tr>";let r=["children","name","parent_node","top_level","id","noparents","level","age","sex","status","display_name","mother","father","yob","mztwin","dztwin"];$.merge(r,a),n+='<tr><td colspan="2"><strong>Age of Diagnosis:</strong></td></tr>',$.each(e.diseases,(function(a,o){r.push(o.type+"_diagnosis_age");let i='&thinsp;<span style="padding-left:5px;background:'+e.diseases[a].colour+'"></span>',l=t.data[o.type+"_diagnosis_age"];n+="<tr><td style='text-align:right'>"+Bn(o.type.replace("_"," "))+i+"&nbsp;</td><td><input class='form-control' id='id_"+o.type+"_diagnosis_age_0' max='110' min='0' name='"+o.type+"_diagnosis_age_0' style='width:5em' type='number' value='"+(void 0!==l?l:"")+"'></td></tr>"})),n+='<tr><td colspan="2" style="line-height:1px;"></td></tr>',$.each(t.data,(function(e,t){if(-1===$.inArray(e,r)){let a=Bn(e);!0===t||!1===t?n+="<tr><td style='text-align:right'>"+a+"&nbsp;</td><td><input type='checkbox' id='id_"+e+"' name='"+e+"' value="+t+" "+(t?"checked":"")+"></td></tr>":e.length>0&&(n+="<tr><td style='text-align:right'>"+a+"&nbsp;</td><td><input type='text' id='id_"+e+"' name='"+e+"' value="+t+"></td></tr>")}})),n+="</table>",$("#node_properties").html(n),$("#node_properties").dialog("open"),$("#node_properties input[type=radio], #node_properties input[type=checkbox], #node_properties input[type=text], #node_properties input[type=number]").change((function(){!function(e){let t=Dt(e),n=$("#id_name").val(),a=Nt(t),r=tn(a,n);if(!r)return;$("#"+e.targetDiv).empty();let o=$("#id_yob_0").val();o&&""!==o?r.yob=o:delete r.yob;let i=$("#id_status").find("input[type='radio']:checked");i.length>0&&(r.status=i.val());let l=["miscarriage","adopted_in","adopted_out","termination","stillbirth"];for(let p=0;p<l.length;p++){let e=l[p],t=$("#id_"+e);t.length>0&&(t.is(":checked")?r[e]=!0:delete r[e])}let s=$("#id_sex").find("input[type='radio']:checked");var d;s.length>0&&(r.sex=s.val(),d=r,$("#cancer .row").show(),"M"===d.sex?(delete d.ovarian_cancer_diagnosis_age,$("[id^='id_ovarian_cancer_diagnosis_age']").closest(".row").hide(),$("[id^='id_breast_cancer2_diagnosis_age']").prop("disabled",!0)):"F"===d.sex&&(delete d.prostate_cancer_diagnosis_age,$("[id^='id_prostate_cancer_diagnosis_age']").closest(".row").hide(),$("[id^='id_breast_cancer2_diagnosis_age']").prop("disabled",!1))),function(e){$("#orig_ashk").is(":checked")?$.each(e,(function(e,t){t.proband&&(t.ashkenazi=1)})):$.each(e,(function(e,t){delete t.ashkenazi}))}(a),$("#id_approx").is(":checked")?r.approx_diagnosis_age=!0:delete r.approx_diagnosis_age,$("#person_details select[name*='_diagnosis_age']:visible, #person_details input[type=text]:visible, #person_details input[type=number]:visible").each((function(){let e=this.name.indexOf("_diagnosis_age")>-1?this.name.substring(0,this.name.length-2):this.name;if($(this).val()){let t=$(this).val();e.indexOf("_diagnosis_age")>-1&&$("#id_approx").is(":checked")&&(t=function(e){let t=10*Math.round((e-1)/10);return e<t?t-5:t+5}(t)),r[e]=t}else delete r[e]})),$('#person_details input[type="checkbox"][name$="cancer"],input[type="checkbox"][name$="cancer2"]').each((function(){this.checked?r[$(this).attr("name")]=!0:delete r[$(this).attr("name")]})),$('#person_details select[name$="_bc_pathology"]').each((function(){"-"!==$(this).val()?r[$(this).attr("name")]=$(this).val():delete r[$(this).attr("name")]})),$('#person_details select[name$="_gene_test"]').each((function(){if("-"!==$(this).val()){let e=$('select[name="'+$(this).attr("name")+'_result"]');r[$(this).attr("name")]={type:$(this).val(),result:$(e).val()}}else delete r[$(this).attr("name")]}));let c=$('#person_details select[name="hoxb13_gene_test_result"]').val();void 0!==c&&"-"!==c?r.hoxb13_gene_test={type:"T",result:c}:delete r.hoxb13_gene_test;try{$("#person_details").find("form").valid()}catch(u){}!function(e,t){if(!t.mztwin&&!t.dztwin)return;let n=t.mztwin?"mztwin":"dztwin";for(let a=0;a<e.length;a++){let r=e[a];r[n]&&t[n]===r[n]&&r.name!==t.name&&("mztwin"===n&&(r.sex=t.sex),t.yob&&(r.yob=t.yob),!t.age||0!==t.status&&t.status||(r.age=t.age))}}(a,r),e.dataset=a,$(document).trigger("rebuild",[e])}(e)}))}(e,r):"delete"===a?(n=Nt(Dt(e)),function(e,t,n,a){let r,o,i,l=It[n.targetDiv],s=Xt(l),d=[];if(void 0===t.id){let e=tn(s,t.name);void 0!==e&&(t=e.data)}if(t.parent_node)for(r=0;r<t.parent_node.length;r++){let n=t.parent_node[r],a=[tn(e,n.mother.name),tn(e,n.father.name)];for(o=0;o<a.length;o++)(a[o].name===t.name||void 0!==a[o].noparents||a[o].top_level)&&(e.splice(Qt(e,a[o].name),1),d.push(a[o]));let i=n.children,c=$.map(i,(function(e,t){return e.name}));for(o=0;o<i.length;o++){let t=tn(e,i[o].name);if(t){t.noparents=!0;let n,a=Ht(e,t);if(a.length>0&&(n=tn(e,a[0])),n&&n.mother!==t.mother)t.mother=n.mother,t.father=n.father;else if(n){let e=jn(l,tn(s,t.name),c);t.mother=e[0]?e[0].data.mother:e[1]?e[1].data.mother:null,t.father=e[0]?e[0].data.father:e[1]?e[1].data.father:null}else e.splice(Qt(e,t.name),1)}}}else e.splice(Qt(e,t.name),1);for(r=0;r<d.length;r++){let t=d[r];if(Jt(e,t).length<1){let n=tn(s,t.name).ancestors();for(o=0;o<n.length;o++)n[o].data.mother&&(e.splice(Qt(e,n[o].data.mother.name),1),e.splice(Qt(e,n[o].data.father.name),1))}}!function(e){let t=["mztwin","dztwin"];for(let n=0;n<e.length;n++)for(let a=0;a<t.length;a++){let r=t[a];if(e[n][r]){let t=0;for(let a=0;a<e.length;a++)e[a][r]===e[n][r]&&t++;t<2&&delete e[n][[r]]}}}(e);try{let t=$.extend({},n);t.dataset=Nt(e),Et(t),i=Bt(e)}catch(c){throw Ot("Warning","Deletion of this pedigree member is disallowed."),c}i.length>0&&0===Bt(n.dataset).length?Ot("Warning","Deleting this will split the pedigree. Continue?",a,n,e):a&&a(n,e)}(n,r.data,e,qn)):"addparents"===a?(n=Nt(Dt(e)),e.dataset=n,function(e,t,n){let a,r,o,i,l=Xt(It[e.targetDiv]),s=tn(l,n),d=s.data,c=s.depth,u=-101,p=Kt(t,d);if(p.length>0&&(o=p[0].mother===d.name?p[0].father:p[0].mother,u=tn(l,o).data.id),1===c)for(a={name:Vt(4),sex:"F",top_level:!0},r={name:Vt(4),sex:"M",top_level:!0},t.splice(0,0,a),t.splice(0,0,r),i=0;i<t.length;i++)!t[i].top_level&&2!==Wt(t,t[i].name)||t[i].name===a.name||t[i].name===r.name||(delete t[i].top_level,t[i].noparents=!0,t[i].mother=a.name,t[i].father=r.name);else{let n=tn(l,s.data.mother),o=tn(l,s.data.father),c=Jt(t,d),p=1e4,f=s.data.id;for(i=0;i<c.length;i++){let e=tn(l,c[i].name).data.id;e<p&&e>s.data.id&&(p=e),e<f&&(f=e)}let h,m=f>=s.data.id||u===f&&p<1e4;e.DEBUG,h=!m&&o.data.id>n.data.id||m&&o.data.id<n.data.id?Qt(t,d.father):Qt(t,d.mother);let g=t[h];r=$n(t,g,"M",m),a=$n(t,g,"F",m);let y=Qt(t,r.name),b=Qt(t,a.name);if(y>b){let e=t[y];t[y]=t[b],t[b]=e}let v=function(e,t){return $.map(e,(function(e,n){return e.name!==t.name&&"noparents"in e&&e.mother===t.mother&&e.father===t.father?e:null}))}(t,d),w=s.data.id;for(i=0;i<v.length;i++){let n=tn(l,v[i].name).data.id;if(e.DEBUG,(m||w<n)&&n<p){let e=Qt(t,v[i].name);t[e].mother=a.name,t[e].father=r.name}}}2===c?(a.top_level=!0,r.top_level=!0):c>2&&(a.noparents=!0,r.noparents=!0);let f=Qt(t,d.name);if(t[f].mother=a.name,t[f].father=r.name,delete t[f].noparents,"parent_node"in d){let e=t[Qt(t,o)];"noparents"in e&&(e.mother=a.name,e.father=r.name)}}(e,n,r.data.name),$(document).trigger("rebuild",[e])):"addpartner"===a&&(n=Nt(Dt(e)),function(e,t,n){let a=tn(Xt(It[e.targetDiv]),n),r=$n(t,a.data,"F"===a.data.sex?"M":"F","F"===a.data.sex);r.noparents=!0;let o={name:Vt(4),sex:"M"};o.mother="F"===a.data.sex?a.data.name:r.name,o.father="F"===a.data.sex?r.name:a.data.name;let i=Qt(t,a.data.name)+2;t.splice(i,0,o)}(e,n,r.data.name),e.dataset=n,$(document).trigger("rebuild",[e])),$(document).trigger("fhChange",[e])}));let u=[];t.filter((function(e){return!e.data.hidden})).on("click",(function(t,n){t.ctrlKey?-1===u.indexOf(n)?u.push(n):u.splice(u.indexOf(n),1):u=[n],"nodeclick"in e&&(e.nodeclick(n.data),d3.selectAll(".indi_rect").style("opacity",0),d3.selectAll(".indi_rect").filter((function(e){return-1!==u.indexOf(e)})).style("opacity",.5))})).on("mouseover",(function(t,n){t.stopPropagation(),Mn=n,zn?zn.data.name!==Mn.data.name&&zn.data.sex!==Mn.data.sex&&d3.select(this).select("rect").style("opacity",.2):(d3.select(this).select("rect").style("opacity",.2),d3.select(this).selectAll(".addchild, .addsibling, .addpartner, .addparents, .delete, .settings").style("opacity",1),d3.select(this).selectAll(".indi_details").style("opacity",0),Hn(e.symbol_size-10,0,e.symbol_size-2,0,n.x+","+(n.y+2)))})).on("mouseout",(function(t){if(zn)return;d3.select(this).selectAll(".addchild, .addsibling, .addpartner, .addparents, .delete, .settings").style("opacity",0),-1===u.indexOf(t)&&d3.select(this).select("rect").style("opacity",0),d3.select(this).selectAll(".indi_details").style("opacity",1);let n=d3.pointer(t)[0],a=d3.pointer(t)[1];a<.8*e.symbol_size&&d3.selectAll(".popup_selection").style("opacity",0),zn||(Math.abs(a)>.25*e.symbol_size||Math.abs(a)<-.25*e.symbol_size||n<.2*e.symbol_size)&&Hn(0,0,0,0)}))}function qn(e,t){e.dataset=t,$(document).trigger("rebuild",[e])}function Hn(e,t,n,a,r){r&&d3.selectAll(".line_drag_selection").attr("transform","translate("+r+")"),d3.selectAll(".line_drag_selection").attr("x1",e).attr("y1",t).attr("x2",n).attr("y2",a)}function Bn(e){return e.charAt(0).toUpperCase()+e.slice(1)}function $n(e,t,n,a,r){if(r&&-1===$.inArray(r,["mztwin","dztwin"]))return new Error("INVALID TWIN TYPE SET: "+r);let o={name:Vt(4),sex:n};t.top_level?o.top_level=!0:(o.mother=t.mother,o.father=t.father);let i=Qt(e,t.name);return r&&function(e,t,n,a){!t[a]&&(t[a]=Rn(e,a),!t[a])||(n[a]=t[a],t.yob&&(n.yob=t.yob),!t.age||"0"!==t.status&&t.status||(n.age=t.age))}(e,e[i],o,r),a?i>0&&i--:i++,e.splice(i,0,o),o}function jn(e,t,n){let a,r,o=Zt(Xt(e),t.depth,n);for(let i=0;i<o.length;i++)o[i].x<t.x&&(a=o[i]),!r&&o[i].x>t.x&&(r=o[i]);return[a,r]}function Gn(e,t){let n="";for(let a=0;a<t.length;a++){let r=t[a];if(e.data[r])if("alleles"===r){let t=e.data.alleles.split(";");for(let e=0;e<t.length;e++)""!==t[e]&&(n+=t[e]+";")}else if("age"===r)n+=e.data[r]+"y ";else if("stillbirth"===r)n+="SB";else if(r.match("_gene_test$")&&"result"in e.data[r]){let t=e.data[r].result.toUpperCase();"-"!==t&&(n+=r.replace("_gene_test","").toUpperCase(),n+="P"===t?"+ ":"N"===t?"- ":" ")}else if(r.match("_bc_pathology$")){let t=e.data[r].toUpperCase();n+=r.replace("_bc_pathology","").toUpperCase(),n+="P"===t?"+ ":"N"===t?"- ":" "}else n+=e.data[r]}if(""!==n)return n}function Jn(e,t,n){if(Kn(e,t))return e.y_offset=e.y_offset?e.y_offset+n:2.35*n,e.y_offset}function Kn(e,t){for(let n=0;n<t.length;n++)if(Lt(t[n],e.data))return!0;return!1}function Wn(e,t,n,a,r,o,i){t.filter((function(e){return!e.data.hidden&&(!i||Kn(e,i))})).append("text").attr("class",o?o+" ped_label":"ped_label").attr("x",n).attr("y",a).attr("font-family",e.font_family).attr("font-size",e.font_size).attr("font-weight",e.font_weight).text(r)}function Qn(e,t,n){if(n>=e.length)for(var a=n-e.length+1;a--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}function Zn(e){let t=$.extend({targetDiv:"pedigree_edit",dataset:[{name:"m21",display_name:"father",sex:"M",top_level:!0},{name:"f21",display_name:"mother",sex:"F",top_level:!0},{name:"ch1",display_name:"me",sex:"F",mother:"f21",father:"m21",proband:!0}],width:600,height:400,symbol_size:35,zoomSrc:["wheel","button"],zoomIn:1,zoomOut:1,dragNode:!0,showWidgets:!0,diseases:[{type:"breast_cancer",colour:"#F68F35"},{type:"breast_cancer2",colour:"pink"},{type:"ovarian_cancer",colour:"#306430"},{type:"pancreatic_cancer",colour:"#4289BA"},{type:"prostate_cancer",colour:"#D5494A"}],labels:["stillbirth",["age","yob"],"alleles",["brca1_gene_test","brca2_gene_test","palb2_gene_test","chek2_gene_test","atm_gene_test"],["rad51d_gene_test","rad51c_gene_test","brip1_gene_test","hoxb13_gene_test"],["er_bc_pathology","pr_bc_pathology","her2_bc_pathology","ck14_bc_pathology","ck56_bc_pathology"]],keep_proband_on_reset:!1,font_size:".75em",font_family:"Helvetica",font_weight:700,background:"#FAFAFA",node_background:"#fdfdfd",validate:!0,DEBUG:!1},e);0===$("#fullscreen").length&&(function(e){let t=$.extend({btn_target:"pedigree_history"},e),n=[{fa:"fa-file-image",title:"download PNG image"},{fa:"fa-undo",title:"undo"},{fa:"fa-redo",title:"redo"},{fa:"fa-refresh",title:"reset"}];n.push({fa:"fa-crosshairs",title:"scale-to-fit"}),t.zoomSrc&&t.zoomSrc.indexOf("button")>-1&&(1!==t.zoomOut&&n.push({fa:"fa-minus-circle",title:"zoom-out"}),1!==t.zoomIn&&n.push({fa:"fa-plus-circle",title:"zoom-in"})),n.push({fa:"fa-arrows-alt",title:"fullscreen"});let a="";for(let r=0;r<n.length;r++)a+="<span>",a+='<i class="fa fa-lg '+n[r].fa+' pe-2" aria-hidden="true" title="'+n[r].title+'"'+("fa-arrows-alt"===n[r].fa?'id="fullscreen" ':"")+"></i>",a+="</span>";$("#"+t.btn_target).append(a),function(e){$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",(function(t){let n=Dt(e);null!=n&&(e.dataset=n),$(document).trigger("rebuild",[e]),setTimeout((function(){ln(e)}),500)})),$("#fullscreen").on("click",(function(t){if(nn())document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{let t=$("#"+e.targetDiv)[0];t.requestFullscreen?t.requestFullscreen():document.documentElement.mozRequestFullScreen?t.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen?t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):document.documentElement.msRequestFullscreen&&t.msRequestFullscreen()}}));let t=0;function n(){on(e,1.05)}function a(){on(e,.95)}$(".fa-plus-circle, .fa-minus-circle").on("mousedown",(function(){t=setInterval($(this).hasClass("fa-plus-circle")?n:a,50)})).on("mouseup mouseleave",(function(){clearInterval(t)})),$("#"+e.btn_target).on("click",(function(t){if(t.stopPropagation(),$(t.target).hasClass("fg-grey"))return!1;if($(t.target).hasClass("fa-undo"))e.dataset=xt(e),$("#"+e.targetDiv).empty(),$(document).trigger("build",[e]);else if($(t.target).hasClass("fa-redo"))e.dataset=St(e),$("#"+e.targetDiv).empty(),$(document).trigger("build",[e]);else if($(t.target).hasClass("fa-refresh"))Ot("Pedigree Reset","This may result in loss of some data. Reset now?",un,e);else if($(t.target).hasClass("fa-crosshairs"))ln(e);else if($(t.target).hasClass("fa-file-image"))return;$(document).trigger("fhChange",[e])}))}(t)}(t),bn(t)),-1===wt(t)&&vt(t),function(e){let t=yt(e),n=wt(e),a="#"+e.btn_target;n<=t?$(a+" .fa-redo").addClass("fg-grey"):$(a+" .fa-redo").removeClass("fg-grey"),t>1?$(a+" .fa-undo").removeClass("fg-grey"):$(a+" .fa-undo").addClass("fg-grey")}(t),Et(t),t.dataset=function(e){for(let r=0;r<e.length;r++)2===Wt(e,e[r].name)&&(e[r].top_level=!0);let t=[],n=[];for(let r=0;r<e.length;r++){let a=e[r];if("top_level"in a&&-1===$.inArray(a.name,n)){n.push(a.name),t.push(a);let r=Ht(e,a);for(let a=0;a<r.length;a++)-1===$.inArray(r[a],n)&&(n.push(r[a]),t.push(tn(e,r[a])))}}let a=$.map(e,(function(e,t){return"top_level"in e&&e.top_level?null:e}));for(let r=t.length;r>0;--r)a.unshift(t[r-1]);return a}(t.dataset),t.DEBUG&&function(e){let t;$("#pedigree_data").remove(),$("body").append("<div id='pedigree_data'></div>");for(let n=0;n<e.dataset.length;n++){let a="<div class='row'><strong class='col-md-1 text-right'>"+e.dataset[n].name+"</strong><div class='col-md-11'>";for(t in e.dataset[n])"name"!==t&&("parent"===t?a+="<span>"+t+":"+e.dataset[n][t].name+"; </span>":"children"===t?void 0!==e.dataset[n][t][0]&&(a+="<span>"+t+":"+e.dataset[n][t][0].name+"; </span>"):a+="<span>"+t+":"+e.dataset[n][t]+"; </span>");$("#pedigree_data").append(a+"</div></div>")}for(t in $("#pedigree_data").append("<br /><br />"),e)"dataset"!==t&&$("#pedigree_data").append("<span>"+t+":"+e[t]+"; </span>")}(t);let n=an(t),a=d3.select("#"+t.targetDiv).append("svg:svg").attr("width",n.width).attr("height",n.height);a.append("rect").attr("width","100%").attr("height","100%").attr("rx",6).attr("ry",6).style("stroke","darkgrey").style("fill",t.background).style("stroke-width",1);let r=a.append("g").attr("class","diagram"),o={name:"hidden_root",id:0,hidden:!0,children:$.map(t.dataset,(function(e,t){return"top_level"in e&&e.top_level?e:null}))},i=Tt(t,o,o)[0],l=d3.hierarchy(o);It[t.targetDiv]=l;let s=function(e){let t=an(e),n=0,a={};for(let o=0;o<e.dataset.length;o++){let t=Wt(e.dataset,e.dataset[o].name),r=Kt(e.dataset,e.dataset[o]),i=1+(r.length>0?.55+.25*r.length:0)+(e.dataset[o].father?.25:0);t in a?a[t]+=i:a[t]=i,a[t]>n&&(n=a[t])}let r=Object.keys(a).length*e.symbol_size*3.5;return{width:t.width-e.symbol_size>n*e.symbol_size*1.65?t.width-e.symbol_size:n*e.symbol_size*1.65,height:t.height-e.symbol_size>r?t.height-e.symbol_size:r}}(t);t.DEBUG;let d=d3.tree().separation((function(e,t){return e.parent===t.parent||e.data.hidden||t.data.hidden?1.2:2.2})).size([s.width,s.height])(l.sort((function(e,t){return e.data.id-t.data.id}))),c=d.descendants();if($.map(t.dataset,(function(e,t){return e.hidden?null:e})).length!==t.dataset.length)throw Ft("NUMBER OF VISIBLE NODES DIFFERENT TO NUMBER IN THE DATASET");!function(e,t,n){function a(r){if(r.children&&(r.children.forEach(a),void 0!==r.data.father)){let a=tn(n,r.data.father.name),o=tn(n,r.data.mother.name),i=(a.x+o.x)/2;if(en(e,t.descendants(),i,r.depth,[r.data.name]))(r.x<a.x&&r.x<o.x||r.x>a.x&&r.x>o.x)&&(r.x=i);else{r.x=i;let n=r.x-i;if(2===r.children.length&&(r.children[0].data.hidden||r.children[1].data.hidden)){if(!r.children[0].data.hidden||!r.children[1].data.hidden){let n=r.children[0].data.hidden?r.children[1]:r.children[0],a=r.children[0].data.hidden?r.children[0]:r.children[1];(n.x<a.x&&i<a.x||n.x>a.x&&i>a.x)&&!en(e,t.descendants(),i,n.depth,[n.data.name])&&(n.x=i)}}else if(1!==r.children.length||r.children[0].data.hidden){if(0!==n&&!function(e,t,n,a){let r=t.descendants(),o=$.map(r,(function(e,t){return e.data.name})),i=a.descendants();for(let l=0;l<r.length;l++){let a=r[l];if(t.data.name!==a.data.name&&en(e,i,a.x-n,a.depth,o))return!0}return!1}(e,r,n,t))if(1===r.children.length)r.children[0].x=i;else{let t=r.descendants();e.DEBUG;for(let e=0;e<t.length;e++)r.data.name!==t[e].data.name&&(t[e].x-=n)}}else en(e,t.descendants(),i,r.children[0].depth,[r.children[0].data.name])||(r.children[0].x=i)}}}a(t),a(t)}(t,d,c);let u=function(e,t){let n=[];for(let a=0;a<t.length;a++)n.push({mother:tn(e,t[a].mother.name),father:tn(e,t[a].father.name)});return n}(c,i);!function(e,t){for(let n=0;n<t.length;n++)ea(e,t[n])}(t,u);let p=r.selectAll(".node").data(d.descendants()).enter().append("g").attr("transform",(function(e,t){return"translate("+e.x+","+e.y+")"}));p.filter((function(e){return!e.data.hidden})).append("path").attr("shape-rendering","geometricPrecision").attr("transform",(function(e){return Yn(e.data.sex)||e.data.miscarriage||e.data.termination?"":"rotate(45)"})).attr("d",d3.symbol().size((function(e){return t.symbol_size*t.symbol_size+2})).type((function(e){return e.data.miscarriage||e.data.termination?d3.symbolTriangle:"F"===e.data.sex?d3.symbolCircle:d3.symbolSquare}))).style("stroke",(function(e){return e.data.age&&e.data.yob&&!e.data.exclude?"#303030":"grey"})).style("stroke-width",(function(e){return e.data.age&&e.data.yob&&!e.data.exclude?".3em":".1em"})).style("stroke-dasharray",(function(e){return e.data.exclude?"3, 3":null})).style("fill","none"),p.filter((function(e){return!(e.data.hidden&&!t.DEBUG)})).append("clipPath").attr("id",(function(e){return e.data.name})).append("path").attr("class","node").attr("transform",(function(e){return Yn(e.data.sex)||e.data.miscarriage||e.data.termination?"":"rotate(45)"})).attr("d",d3.symbol().size((function(e){return e.data.hidden?t.symbol_size*t.symbol_size/5:t.symbol_size*t.symbol_size})).type((function(e){return e.data.miscarriage||e.data.termination?d3.symbolTriangle:"F"===e.data.sex?d3.symbolCircle:d3.symbolSquare}))),p.filter((function(e){return!(e.data.hidden&&!t.DEBUG)})).selectAll("pienode").data((function(e){let n=0,a=$.map(t.diseases,(function(a,r){return Lt(t.diseases[r].type,e.data)?(n++,1):0}));return 0===n&&(a=[1]),[$.map(a,(function(t,a){return{cancer:t,ncancers:n,id:e.data.name,sex:e.data.sex,proband:e.data.proband,hidden:e.data.hidden,affected:e.data.affected,exclude:e.data.exclude}}))]})).enter().append("g").selectAll("path").data(d3.pie().value((function(e){return e.cancer}))).enter().append("path").attr("clip-path",(function(e){return"url(#"+e.data.id+")"})).attr("class","pienode").attr("d",d3.arc().innerRadius(0).outerRadius(t.symbol_size)).style("fill",(function(e,n){return e.data.exclude?"lightgrey":0===e.data.ncancers?e.data.affected?"darkgrey":t.node_background:t.diseases[n].colour})),p.filter((function(e){return!e.data.hidden&&(e.data.adopted_in||e.data.adopted_out)})).append("path").attr("d",(function(e){let n=-.66*t.symbol_size,a=-.64*t.symbol_size,r=t.symbol_size/4;return Xn(n,a,r,t)+Xn(-n,a,-r,t)})).style("stroke",(function(e){return e.data.age&&e.data.yob&&!e.data.exclude?"#303030":"grey"})).style("stroke-width",(function(e){return".1em"})).style("stroke-dasharray",(function(e){return e.data.exclude?"3, 3":null})).style("fill","none"),p.filter((function(e){return"1"===e.data.status||1===e.data.status})).append("line").style("stroke","black").attr("x1",(function(e,n){return-.6*t.symbol_size})).attr("y1",(function(e,n){return.6*t.symbol_size})).attr("x2",(function(e,n){return.6*t.symbol_size})).attr("y2",(function(e,n){return-.6*t.symbol_size})),function(e,t){Wn(e,t,-.4*e.symbol_size,-.1*e.symbol_size,(function(t){return e.DEBUG?("display_name"in t.data?t.data.display_name:t.data.name)+"  "+t.data.id:"display_name"in t.data?t.data.display_name:""}),void 0,["display_name"]);let n=parseInt(function(e){let t=e.font_size;return t===parseInt(t,10)?t:t.indexOf("px")>-1?t.replace("px",""):-1===t.indexOf("em")?t:(t=parseFloat(t.replace("em","")),parseFloat(getComputedStyle($("#"+e.targetDiv).get(0)).fontSize)*t-1)}(e))+4;for(let a=0;a<e.labels.length;a++){let r=e.labels[a],o=Array.isArray(r)?r:[r];(o.indexOf("age")>-1||o.indexOf("yob")>-1)&&Wn(e,t,-e.symbol_size,(function(e){return Jn(e,o,n)}),(function(e){return Gn(e,o)}),"indi_details",o)}for(let a=0;a<e.diseases.length;a++){let r=e.diseases[a].type;Wn(e,t,-e.symbol_size,(function(e){return Jn(e,[r],n)}),(function(e){let t=r.replace("_"," ").replace("cancer","ca.");return r+"_diagnosis_age"in e.data?t+": "+e.data[r+"_diagnosis_age"]:""}),"indi_details",[r])}for(let a=0;a<e.labels.length;a++){let r=e.labels[a],o=Array.isArray(r)?r:[r];-1===o.indexOf("age")&&-1===o.indexOf("yob")&&Wn(e,t,-e.symbol_size,(function(e){return Jn(e,o,n)}),(function(e){return Gn(e,o)}),"indi_details",o)}}(t,p),t.showWidgets&&Un(t,p);let f={},h=function(e,t,n,a,r,o){let i=function(e,t){return e+1<t?i(++e):e},l="";for(let s=0;s<e.length;s++){let d=i(s,e.length),c=e[s]-t-o,u=e[d]+t+o;r.x>c&&r.x<u&&(r.y=a),l+="L"+c+","+(n-o)+"L"+c+","+(a-o)+"L"+u+","+(a-o)+"L"+u+","+(n-o),s=d}return l};i=r.selectAll(".partner").data(u).enter().insert("path","g").attr("fill","none").attr("stroke","#000").attr("shape-rendering","auto").attr("d",(function(e,n){let a,r,o,i=function(e,t,n){if(e.depth!==t.depth)return!0;let a=Yt(n.dataset,e),r=Yt(n.dataset,t),o=$.map(a,(function(e,t){return e.name})),i=$.map(r,(function(e,t){return e.name})),l=!1;return $.each(o,(function(e,t){if(-1!==$.inArray(t,i))return l=!0,!1})),l}(tn(c,e.mother.data.name),tn(c,e.father.data.name),t),l=e.mother.data.divorced&&e.mother.data.divorced===e.father.data.name,s=e.mother.x<e.father.x?e.mother.x:e.father.x,d=e.mother.x<e.father.x?e.father.x:e.mother.x,u=e.mother.y,p=ea(t,e),m="";if(p){e.mother.depth in f?f[e.mother.depth]+=4:f[e.mother.depth]=4,u-=f[e.mother.depth],r=f[e.mother.depth]+t.symbol_size/2+2;let n=e.mother.data.parent_node,i=n[0];for(let t=0;t<n.length;t++)n[t].father.name===e.father.data.name&&n[t].mother.name===e.mother.data.name&&(i=n[t].name);o=tn(c,i),o.y=u,p.sort((function(e,t){return e-t})),a=u-t.symbol_size/2-3,m=h(p,r,u,a,o,0)}let g="";if(l&&!p&&(g="M"+(s+.66*(d-s)+6)+","+(u-6)+"L"+(s+.66*(d-s)-6)+","+(u+6)+"M"+(s+.66*(d-s)+10)+","+(u-6)+"L"+(s+.66*(d-s)-2)+","+(u+6)),i){u=e.mother.x<e.father.x?e.mother.y:e.father.y,a=e.mother.x<e.father.x?e.father.y:e.mother.y;let t=3;return Math.abs(u-a)>.1?"M"+s+","+u+"L"+d+","+a+"M"+s+","+(u-t)+"L"+d+","+(a-t):"M"+s+","+u+m+"L"+d+","+u+"M"+s+","+(u-t)+(p?h(p,r,u,a,o,t):"")+"L"+d+","+(u-t)+g}return"M"+s+","+u+m+"L"+d+","+u+g})),r.selectAll(".link").data(l.links(d.descendants())).enter().filter((function(e){return t.DEBUG||void 0===e.target.data.noparents&&null!==e.source.parent&&!e.target.data.hidden})).insert("path","g").attr("fill","none").attr("stroke-width",(function(e,n){return void 0!==e.target.data.noparents||null===e.source.parent||e.target.data.hidden?1:t.DEBUG?2:1})).attr("stroke",(function(e,t){return void 0!==e.target.data.noparents||null===e.source.parent||e.target.data.hidden?"pink":"#000"})).attr("stroke-dasharray",(function(e,n){if(!e.target.data.adopted_in)return null;let a=Math.abs(e.source.y-(e.source.y+e.target.y)/2),r=[a,0,Math.abs(e.source.x-e.target.x),0];Gt(t.dataset,e.target.data).length>=1&&(a*=3);for(let t=0;t<a;t+=10)$.merge(r,[5,5]);return r})).attr("shape-rendering",(function(e,t){return e.target.data.mztwin||e.target.data.dztwin?"geometricPrecision":"auto"})).attr("d",(function(e,n){if(e.target.data.mztwin||e.target.data.dztwin){let n=Gt(t.dataset,e.target.data);if(n.length>=1){let a=0,r=e.target.x;for(let e=0;e<n.length;e++){let t=tn(c,n[e].name).x;r>t&&(r=t),a+=t}let o=(e.target.x+a)/(n.length+1),i=(e.source.y+e.target.y)/2,l="";if(r===e.target.x&&e.target.data.mztwin){let n=(o+e.target.x)/2,a=(i+(e.target.y-t.symbol_size/2))/2;l="M"+n+","+a+"L"+(o+(o-n))+" "+a}return"M"+e.source.x+","+e.source.y+"V"+i+"H"+o+"L"+e.target.x+" "+(e.target.y-t.symbol_size/2)+l}}if(e.source.data.mother){let t=tn(c,e.source.data.mother.name),n=tn(c,e.source.data.father.name);if(t.depth!==n.depth)return"M"+e.source.x+","+(t.y+n.y)/2+"H"+e.target.x+"V"+e.target.y}return"M"+e.source.x+","+e.source.y+"V"+(e.source.y+e.target.y)/2+"H"+e.target.x+"V"+e.target.y}));let m=$t(t.dataset);if(void 0!==m){let e=tn(c,t.dataset[m].name),n="triangle"+Vt(3);r.append("svg:defs").append("svg:marker").attr("id",n).attr("refX",6).attr("refY",6).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d","M 0 0 12 6 0 12 3 6").style("fill","black"),r.append("line").attr("x1",e.x-t.symbol_size/.7).attr("y1",e.y+t.symbol_size/1.4).attr("x2",e.x-t.symbol_size/1.4).attr("y2",e.y+t.symbol_size/4).attr("stroke-width",1).attr("stroke","black").attr("marker-end","url(#"+n+")")}return rn(t,a),t.dragNode&&function(e,t){let n,a;t.filter((function(e){return!e.data.hidden})).call(d3.drag().filter((function(e){return!e.ctrlKey&&!e.button&&e.shiftKey})).on("start",(function(){n=d3.select(this).select(".indi_rect").attr("x")})).on("drag",(function(e){e.sourceEvent.stopPropagation();let t=e.dx,n=d3.select(this).select(".indi_rect");a=parseFloat(n.attr("x"))+t,n.attr("x",a)})).on("end",(function(t){let r=d3.select(this).datum().data,o=1===Ht(e.dataset,r).length?Ht(e.dataset,r)[0]:-1;d3.select(this).select(".indi_rect").attr("x",n);const i=a>n;let l,s,d,c=It[e.targetDiv],u=tn(Xt(c),r.name),p=Zt(Xt(c),u.depth);a+=u.x;let f,h=-Number.MAX_VALUE,m=Number.MAX_VALUE;for(let e=0;e<p.length;e++)p[e].x<a&&p[e].x>h?(l=p[e],h=p[e].x):p[e].x>a&&p[e].x<m&&(s=p[e],m=p[e].x);if(void 0===l&&void 0===s)return;i?(f=Qt(e.dataset,l.data.name),d=l):(f=Qt(e.dataset,s.data.name),d=s);let g=Nt(Dt(e)),y=Qt(e.dataset,r.name);Qn(g,y,f),-1!==o&&o!==d.data.name&&(y=Qt(g,o),Qn(g,y,f)),e.dataset=g,$(document).trigger("rebuild",[e])})))}(t,p),t}function Yn(e){return"M"===e||"F"===e}function Xn(e,t,n,a){return"M"+(e+n)+","+t+"L"+e+" "+t+"L"+e+" "+(t+1.28*a.symbol_size)+"L"+e+" "+(t+1.28*a.symbol_size)+"L"+(e+n)+","+(t+1.28*a.symbol_size)}function ea(e,t){let n,a,r=Xt(It[e.targetDiv]);if("name"in t){if(!("mother"in(t=tn(r,t.name)).data))return null;n=tn(r,t.data.mother),a=tn(r,t.data.father)}else n=t.mother,a=t.father;let o=n.x<a.x?n.x:a.x,i=n.x<a.x?a.x:n.x,l=n.y,s=$.map(r,(function(e,t){return!e.data.hidden&&e.data.name!==n.data.name&&e.data.name!==a.data.name&&e.y===l&&e.x>o&&e.x<i?e.x:null}));return s.length>0?s:null}function ta(e){$("#"+e.targetDiv).empty(),vt(e);try{Zn(e)}catch(t){throw t}try{templates.update(e)}catch(t){}}$(document).on("fhChange",(function(e,t){try{let e=$("#id_name").val();void 0===tn(Dt(t),e)?$("form > fieldset").prop("disabled",!0):$("form > fieldset").prop("disabled",!1)}catch(n){}})),$(document).on("rebuild",(function(e,t){ta(t)})),$(document).on("build",(function(e,t){Zn(t)}));var na=Object.freeze({__proto__:null,build:Zn,check_ptr_link_clashes:ea,rebuild:ta});const aa=He({__name:"PedigreeDrawer",setup(e,{expose:t}){const{t:n}=T();function u(){if(!na||!Ct||!Tn)return void ze.error("pedigreejs libraries are not loaded.");let e=document.getElementById("pedigreejs");const t=document.getElementById("pedigree");!e&&t&&(e=document.createElement("div"),e.id="pedigreejs",t.appendChild(e));let n={targetDiv:"pedigree",btn_target:"pedigree_history",width:650,height:400,symbol_size:35,store_type:"session",diseases:[{type:"affected",colour:"#F68F35"}],labels:[],font_size:".75em",font_family:"Helvetica",font_weight:700,edit:!0,DEBUG:!1};const a=Ct.current(n);n.dataset=null!=a&&a.length>0?a:[{name:"father",sex:"M",top_level:!0},{name:"mother",sex:"F",top_level:!0},{name:"child",sex:"F",father:"father",mother:"mother",proband:!0,affected:!0}];try{let e=na.build(n);cn.scale_to_fit(e)}catch(r){let e="";"string"==typeof r?e=r.toUpperCase():r instanceof Error&&(e=r.message),ze.error("PedigreeJS initialization error: "+e,r)}}return b((()=>{u()})),t({getPedigreeDataUrl:function(){return new Promise(((e,t)=>{try{const n=document.querySelector("#pedigree svg");if(!n)return void e("");const a=(new XMLSerializer).serializeToString(n),r=document.createElement("canvas"),o=n.getAttribute("width")||450,i=n.getAttribute("height")||320;r.width=o,r.height=i;const l=r.getContext("2d"),s=new Image;s.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(a))),s.onload=()=>{l.drawImage(s,0,0);const t=r.toDataURL("image/png");e(t)},s.onerror=e=>t(e)}catch(n){t(n)}}))},getPedigreeData:function(){try{const e={targetDiv:"pedigree",btn_target:"pedigree_history"},t=Ct.current(e);if(ze.debug("[PedigreeDrawer] Raw pedigree dataset fetched from cache:",t),!t||0===t.length)return ze.warn("[PedigreeDrawer] No pedigree data found in cache"),null;const n={};let a=1;t.forEach((e=>{const t=e.name||e.id||`p${a}`;n[t]||(n[t]=a++)}));const r=[];t.forEach((e=>{const t=e.name||e.id||`p${a}`,o=n[t],i="M"===e.sex?1:"F"===e.sex?2:0,l=e.father&&n[e.father]||0,s=e.mother&&n[e.mother]||0,d=e.affected?2:1;r.push([1,o,l,s,i,d])})),r.sort(((e,t)=>e[1]-t[1]));const o=[2,r];return ze.debug("[PedigreeDrawer] Final compact pedigree data prepared:",o),o}catch(e){return ze.error("[PedigreeDrawer] Error getting pedigree data:",e),null}},initPedigree:u}),(e,t)=>(r(),a(he,{class:"mb-4"},{default:o((()=>[l(pe,null,{default:o((()=>[s(d(c(n)("pedigreeDrawer.title")),1)])),_:1}),t[1]||(t[1]=s()),l(fe,null,{default:o((()=>t[0]||(t[0]=[i("div",{id:"pedigree",class:"pedigree-container"},null,-1),s(),i("div",{id:"pedigree_history"},null,-1)]))),_:1})])),_:1}))}},[["__scopeId","data-v-4bef441c"]]),ra=He({__name:"ValidationSummary",props:{showValidation:{type:Boolean,default:!1}},setup(e){const t=m("isValid"),u=m("validationErrors"),f=n((()=>{if(!u||!u.value)return[];const e=new Set,t=[],n=e=>e.match(/phenotypeData\[(\d+)\]/)?"phenotypeData":e;return Object.entries(u.value).forEach((([a,r])=>{if(a.includes("."))return;const o=`${n(a)}: ${r}`;e.has(o)||(e.add(o),t.push({field:n(a),message:"phenotypeData"===n(a)?"Phenotype data: Some fields need to be completed":r}))})),t}));return(n,u)=>e.showValidation&&!c(t)&&f.value.length>0?(r(),a(me,{key:0,type:"error",density:"compact",variant:"tonal",class:"validation-summary",border:"start",role:"alert","aria-live":"assertive"},{default:o((()=>[u[0]||(u[0]=i("h3",null,"Please correct the following errors:",-1)),u[1]||(u[1]=s()),l(G,{density:"compact",class:"error-list"},{default:o((()=>[(r(!0),g(D,null,x(f.value,((e,t)=>(r(),a(J,{key:t,density:"compact",class:"error-item",onClick:t=>function(e){const t={firstName:"givenName",lastName:"familyName",referrer:"physicianName"}[e]||e,n=document.getElementById(t)||document.getElementById(e)||document.querySelector(`[name="${t}"]`)||document.querySelector(`[name="${e}"]`)||document.querySelector(`[data-field="${t}"]`)||document.querySelector(`[data-field="${e}"]`)||document.querySelector(`label[for="${t}"]`)||document.querySelector(`label[for="${e}"]`);n?(n.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout((()=>{n.focus()}),500)):ze.warn(`ValidationSummary: Could not find field element to scroll to: ${e} (mapped: ${t})`)}(e.field)},{default:o((()=>[l(K,null,{default:o((()=>[s(d(e.message),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):p("",!0)}},[["__scopeId","data-v-8cbfde80"]]),oa={schema:{name:"RequiForm PDF Schema",version:"0.1.0"},header:JSON.parse('{"elements":[{"type":"image","position":{"x":40,"y":30},"size":{"width":225,"height":47},"source":"data:image/png;base64,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"},{"type":"text","position":{"x":400,"y":40},"content":"Labor Berlin - Charité Vivantes GmbH","contents":{"en":"Labor Berlin - Charité Vivantes GmbH","de":"Labor Berlin - Charité Vivantes GmbH"},"style":{"font":"Helvetica","fontStyle":"normal","fontSize":10,"color":"#000000"}},{"type":"text","position":{"x":400,"y":50},"content":"Humangenetik","style":{"font":"Helvetica","fontStyle":"normal","fontSize":10,"color":"#000000"}},{"type":"text","position":{"x":400,"y":60},"content":"Sylter Straße 2 · 13353 Berlin","contents":{"en":"Sylter Strasse 2 · 13353 Berlin","de":"Sylter Straße 2 · 13353 Berlin"},"style":{"font":"Helvetica","fontStyle":"normal","fontSize":10,"color":"#000000"}},{"type":"text","position":{"x":40,"y":120},"content":"ANFORDERUNGSSCHEIN MOLEKULARGENETIK","contents":{"en":"MOLECULAR GENETICS REQUISITION FORM","de":"ANFORDERUNGSSCHEIN MOLEKULARGENETIK"},"style":{"font":"Helvetica","fontStyle":"bold","fontSize":14,"color":"#000000"}}]}'),body:{elements:[{type:"text",position:{x:40,y:140},content:"Patient*In",contents:{en:"Patient",de:"Patient*In"},style:{font:"Helvetica",fontStyle:"bold",fontSize:12,color:"#000000"}},{type:"text",position:{x:380,y:200},content:"- Praxisstempel -",contents:{en:"- Practice Stamp -",de:"- Praxisstempel -"},style:{font:"Helvetica",fontStyle:"italic",fontSize:12,color:"#A9A9A9"}},{type:"text",position:{x:40,y:160},content:"Vorname: {{givenName}}",contents:{en:"First Name: {{givenName}}",de:"Vorname: {{givenName}}"},style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:40,y:180},content:"Name: {{familyName}}",contents:{en:"Last Name: {{familyName}}",de:"Name: {{familyName}}"},style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:40,y:200},content:"Geburtsdatum: {{birthdate}}",contents:{en:"Date of Birth: {{birthdate}}",de:"Geburtsdatum: {{birthdate}}"},style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:40,y:220},content:"Geschlecht: {{sex}}",contents:{en:"Sex: {{sex}}",de:"Geschlecht: {{sex}}"},style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:40,y:240},content:"Bestelldatum: {{orderingDate}}",contents:{en:"Order Date: {{orderingDate}}",de:"Bestelldatum: {{orderingDate}}"},style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:40,y:260},content:"Kostenübernahme: {{insurance}}",style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:300,y:260},content:"Ärzt*In: {{physicianName}}",contents:{en:"Physician: {{physicianName}}",de:"Ärzt*In: {{physicianName}}"},style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:300,y:290},content:"Unterschrift: ______________________",contents:{en:"Signature: ______________________",de:"Unterschrift: ______________________"},style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:40,y:270},content:"Familienanamnese: {{familyHistory}}",contents:{en:"Family History: {{familyHistory}}",de:"Familienanamnese: {{familyHistory}}"},style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:40,y:284},content:"Elterliche Blutsverwandtschaft: {{parentalConsanguinity}}",contents:{en:"Parental Consanguinity: {{parentalConsanguinity}}",de:"Elterliche Blutsverwandtschaft: {{parentalConsanguinity}}"},style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:40,y:298},content:"Diagnose / Verdacht: {{diagnosis}}",contents:{en:"Diagnosis / Suspicion: {{diagnosis}}",de:"Diagnose / Verdacht: {{diagnosis}}"},style:{font:"Helvetica",fontStyle:"normal",fontSize:12,color:"#000000"}},{type:"text",position:{x:40,y:330},content:"Angeforderte Analyse(n):",contents:{en:"Requested Analysis:",de:"Angeforderte Analyse(n):"},style:{font:"Helvetica",fontStyle:"bold",fontSize:12,color:"#000000"}},{type:"rectangle",position:{x:320,y:130},size:{width:220,height:100},style:{borderColor:"#000000",borderWidth:.7}},{type:"line",start:{x:40,y:310},end:{x:540,y:310},style:{lineWidth:1,color:"#000000"}}]},panels:{baseY:350,maxHeight:700,spacing:14,offsetX:60,secondPageBaseY:50},qr:{position:{x:450,y:700},size:{width:100,height:100}},phenotypePage:{title:"Phenotype Data",titleContents:{en:"Phenotype Data",de:"Phänotyp-Daten"}},footer:{elements:[{type:"text",position:{x:40,y:780},content:"Tel: +49 (0)30 450 625 432",contents:{en:"Phone: +49 (0)30 450 625 432",de:"Tel: +49 (0)30 450 625 432"},style:{font:"Helvetica",fontStyle:"normal",fontSize:10,color:"#000000"}},{type:"text",position:{x:40,y:794},content:"E-Mail: humangenetik@laborberlin.com",contents:{en:"Email: humangenetik@laborberlin.com",de:"E-Mail: humangenetik@laborberlin.com"},style:{font:"Helvetica",fontStyle:"normal",fontSize:10,color:"#000000"}},{type:"text",position:{x:40,y:808},content:"laborberlin.com/humangenetik",contents:{en:"laborberlin.com/humangenetik",de:"laborberlin.com/humangenetik"},style:{font:"Helvetica",fontStyle:"normal",fontSize:10,color:"#000000"}}]},pageNumber:{enabled:!0,position:{x:500,y:820},font:"Helvetica",fontStyle:"normal",fontSize:10,color:"#000000"},consent:{enabled:!0,title:"Einwilligung zur genetischen Analyse nach GenDG",titleContents:{de:"Einwilligung zur genetischen Analyse nach GenDG",en:"Consent for Genetic Analysis according to GenDG"},paragraphs:["Ich erkläre mich hiermit einverstanden, dass von mir bzw. meinem Kind entnommenes Probenmaterial auf genetische Veränderungen auf Basis einer Genpanel- oder Gesamt-Exom-Anreicherung untersucht wird. Ich wurde über Zweck, Art, Umfang und Aussagekraft der angeforderten genetischen Untersuchung aufgeklärt. Ich wurde informiert, dass die Proben oder die erhobenen Daten als Analyseauftrag an Dritte verschickt werden können. Dabei werden personenbezogene Daten pseudonymisiert auf Datenservern gespeichert, teilweise auf 'Cloud'-Servern innerhalb Europas. Weiterhin werden Daten ggf. für die Abrechnung der Diagnostik zur jeweiligen Krankenkasse übermittelt. Ebenso wurden die möglichen Konsequenzen, die sich aus den Ergebnissen der genetischen Untersuchung für mich oder auch andere Familienmitglieder ergeben können, ausführlich besprochen.","Ich bin damit einverstanden, dass die Befunde der Analyse(n) zusätzlich zur/zum anfordernden Ärztin/Arzt auch weitergeleitet werden an: {{consentName}} (Anschrift falls vorhanden).","Bei genetischen Untersuchungen kann es zu Ergebnissen kommen, die nicht im Zusammenhang mit der klinischen Fragestellung stehen, aber nach aktuellem Wissensstand (angelehnt an die Empfehlungen des ACMG https://www.laborberlin.com/Zufallsbefunde) eine Behandlungs- oder Vorsorgekonsequenz für mich oder Angehörige haben können. Zufallsbefunde mitteilen: {{zufallsbefundeLabel}}","Mit der Aufbewahrung von überschüssigem Untersuchungsmaterial für ggf. ergänzende Untersuchungen zur Diagnosefindung und für laboranalytische Kontrollmaßnahmen bin ich einverstanden. ({{materialLabel}})","Ich bin einverstanden, dass die Untersuchungsergebnisse über die gesetzlich vorgeschriebene Frist von 10 Jahren hinaus (maximal 30 Jahre) aufbewahrt werden können. ({{extendedLabel}})","Ich bin einverstanden, dass erhobene Daten/Ergebnisse über die infrage stehende Erkrankung in verschlüsselter (pseudonymisierter) Form für wissenschaftliche und qualitätssichernde Zwecke genutzt und anonymisiert in Fachzeitschriften veröffentlicht werden. ({{researchLabel}})","Ich wurde darauf hingewiesen, dass ich meine Einwilligung jederzeit ohne Angaben von Gründen ganz oder teilweise zurückziehen kann, ohne dass mir daraus Nachteile entstehen, und dass ich das Recht habe, Untersuchungsergebnisse nicht zu erfahren (Recht auf Nichtwissen)."],paragraphsContents:{de:["Ich erkläre mich hiermit einverstanden, dass von mir bzw. meinem Kind entnommenes Probenmaterial auf genetische Veränderungen auf Basis einer Genpanel- oder Gesamt-Exom-Anreicherung untersucht wird. Ich wurde über Zweck, Art, Umfang und Aussagekraft der angeforderten genetischen Untersuchung aufgeklärt. Ich wurde informiert, dass die Proben oder die erhobenen Daten als Analyseauftrag an Dritte verschickt werden können. Dabei werden personenbezogene Daten pseudonymisiert auf Datenservern gespeichert, teilweise auf 'Cloud'-Servern innerhalb Europas. Weiterhin werden Daten ggf. für die Abrechnung der Diagnostik zur jeweiligen Krankenkasse übermittelt. Ebenso wurden die möglichen Konsequenzen, die sich aus den Ergebnissen der genetischen Untersuchung für mich oder auch andere Familienmitglieder ergeben können, ausführlich besprochen.","Ich bin damit einverstanden, dass die Befunde der Analyse(n) zusätzlich zur/zum anfordernden Ärztin/Arzt auch weitergeleitet werden an: {{consentName}} (Anschrift falls vorhanden).","Bei genetischen Untersuchungen kann es zu Ergebnissen kommen, die nicht im Zusammenhang mit der klinischen Fragestellung stehen, aber nach aktuellem Wissensstand (angelehnt an die Empfehlungen des ACMG https://www.laborberlin.com/Zufallsbefunde) eine Behandlungs- oder Vorsorgekonsequenz für mich oder Angehörige haben können. Zufallsbefunde mitteilen: {{zufallsbefundeLabel}}","Mit der Aufbewahrung von überschüssigem Untersuchungsmaterial für ggf. ergänzende Untersuchungen zur Diagnosefindung und für laboranalytische Kontrollmaßnahmen bin ich einverstanden. ({{materialLabel}})","Ich bin einverstanden, dass die Untersuchungsergebnisse über die gesetzlich vorgeschriebene Frist von 10 Jahren hinaus (maximal 30 Jahre) aufbewahrt werden können. ({{extendedLabel}})","Ich bin einverstanden, dass erhobene Daten/Ergebnisse über die infrage stehende Erkrankung in verschlüsselter (pseudonymisierter) Form für wissenschaftliche und qualitätssichernde Zwecke genutzt und anonymisiert in Fachzeitschriften veröffentlicht werden. ({{researchLabel}})","Ich wurde darauf hingewiesen, dass ich meine Einwilligung jederzeit ohne Angaben von Gründen ganz oder teilweise zurückziehen kann, ohne dass mir daraus Nachteile entstehen, und dass ich das Recht habe, Untersuchungsergebnisse nicht zu erfahren (Recht auf Nichtwissen)."],en:["I hereby declare that I agree to the examination of the sample material taken from me or my child for genetic changes on the basis of a gene panel or whole-exome enrichment. I have been informed about the purpose, type, scope and significance of the requested genetic examination. I have been informed that the samples or the data collected can be sent to third parties as an analysis order. In this process, personal data is pseudonymized on data servers, partly on 'cloud' servers within Europe. Furthermore, data may be transmitted to the respective health insurance company for the billing of diagnostics. The possible consequences that may arise from the results of the genetic examination for me or other family members have also been discussed in detail.","I agree that the findings of the analysis(es) will also be forwarded to {{consentName}} (address if available) in addition to the requesting physician.","Genetic testing may reveal findings unrelated to the clinical question, but which may have treatment or preventive consequences for me or relatives according to current knowledge (based on ACMG recommendations https://www.laborberlin.com/Zufallsbefunde). Share incidental findings: {{zufallsbefundeLabel}}","I agree with the storage of excess examination material for possible supplementary examinations for diagnosis and for laboratory analytical control measures. ({{materialLabel}})","I agree that the examination results can be kept beyond the legally prescribed period of 10 years (maximum 30 years). ({{extendedLabel}})","I agree that collected data/results about the disease in question may be used in encrypted (pseudonymized) form for scientific and quality assurance purposes and published anonymously in professional journals. ({{researchLabel}})","I have been informed that I can withdraw my consent in whole or in part at any time without giving reasons, without any disadvantages, and that I have the right not to know examination results (right not to know)."]},signatureArea:{patientLabel:"Patient*in / gesetzl. Vertreter*in (Druckbuchstaben)",physicianLabel:"Ärztin/Arzt (Druckbuchstaben)",signHint:"Datum / Unterschrift"},signatureAreaContents:{de:{patientLabel:"Patient*in / gesetzl. Vertreter*in (Druckbuchstaben)",physicianLabel:"Ärztin/Arzt (Druckbuchstaben)",signHint:"Datum / Unterschrift"},en:{patientLabel:"Patient / Legal Representative (BLOCK LETTERS)",physicianLabel:"Physician (BLOCK LETTERS)",signHint:"Date / Signature"}}}};async function ia(e,t={}){var n,a;let r;r="string"==typeof e?e:Array.isArray(e)||"object"==typeof e?JSON.stringify(e).replace(/\s/g,""):String(e);const o=r.length;ze.debug(`QR code data size: ${o} characters`);const i=function(e,t=100){let n=t;return e>100&&(n=Math.min(t+20,120)),e>200&&(n=Math.min(t+40,140)),e>300&&(n=Math.min(t+60,160)),e>400&&(n=Math.min(t+80,180)),n}(o);let l="M";o>300?l="L":o<100&&(l="H");const s={width:t.width||i,margin:void 0!==t.margin?t.margin:1,color:{dark:(null==(n=t.color)?void 0:n.dark)||"#000000",light:(null==(a=t.color)?void 0:a.light)||"#FFFFFF"},errorCorrectionLevel:t.errorCorrectionLevel||l};try{return await Le.toDataURL(r,s)}catch(d){throw ze.error("Failed to generate QR code:",d),new Error(`QR code generation failed: ${d.message}`)}}async function la(e,t={}){if(!e)return ia("{}",t.qrOptions||{});let n=e;Array.isArray(e)?e.length>=2&&2===e[0]?(ze.debug("[qrService] Using standard PED format"),n=e):(ze.debug("[qrService] Using array format"),n=e):"c"===e.f||"compact"===e.format?(ze.debug("[qrService] Converting legacy object format to array"),n=e):e.h||e.hasImage?(ze.debug("[qrService] Using image reference only"),n=[0]):(ze.debug("[qrService] Unknown format:",typeof e),n=e);try{const e=(Array.isArray(n)?JSON.stringify(n):JSON.stringify([3,n])).replace(/\s/g,""),a=e.length;return ze.debug("[qrService] Final pedigree data size:",a,"chars"),a>4e3?(ze.warn("Pedigree data exceeds limit"),la([0],{qrOptions:t.qrOptions})):ia(e,t.qrOptions||{})}catch(a){return ze.error("Error generating pedigree QR:",a),ia("{}",t.qrOptions||{})}}const sa={__name:"PdfGenerator",props:{patientData:{type:Object,required:!0},pedigreeDataUrl:{type:String,required:!1,default:""},phenotypeData:{type:Object,required:!1,default:()=>({})}},setup(e,{expose:t}){const a=T(),i=n((()=>a.locale.value)),d=e,c=m("patientData",null);t({generatePdf:w});const u=n((()=>{const e=(null==c?void 0:c.selectedPanels)||[];return Ze.categories.map((t=>({categoryTitle:t.title,id:t.id,tests:t.tests.filter((t=>e.includes(t.id)))}))).filter((e=>e.tests.length>0))})),p=n((()=>{const e=(null==c?void 0:c.selectedPanels)||[];if(null==c?void 0:c.personalInfo){const t=c.personalInfo;return{patient:{firstName:t.firstName||"",lastName:t.lastName||"",birthdate:t.birthdate||"",sex:t.sex||"",insurance:t.insurance||"",insuranceId:t.insuranceId||"",referrer:t.referrer||"",diagnosis:t.diagnosis||""},selectedTests:e}}return{patient:{firstName:d.patientData.givenName||"",lastName:d.patientData.familyName||"",birthdate:d.patientData.birthdate||"",sex:d.patientData.sex||"",insurance:d.patientData.insurance||"",insuranceId:d.patientData.insuranceId||"",referrer:d.patientData.referrer||"",diagnosis:d.patientData.clinicalDiagnosis||""},selectedTests:[]}})),f=n((()=>{if(null==c?void 0:c.phenotypes)return c.phenotypes;if(d.phenotypeData){const e=[];return Object.entries(d.phenotypeData).forEach((([t,n])=>{Object.entries(n).forEach((([n,a])=>{if("no input"===a)return;const r=Ze.categories.find((e=>e.id===t));if(r){const t=r.phenotypes.find((e=>e.id===n));t&&t.hpo&&e.push({id:t.hpo,present:"present"===a||"yes"===a})}}))})),e}return[]})),h=n((()=>{var e,t,n;if(ze.debug("[PdfGenerator] Direct patientData props:",JSON.stringify(d.patientData||{})),null==(t=null==(e=d.patientData)?void 0:e.pedigree)?void 0:t.data){const e=d.patientData.pedigree.data;return ze.debug("[PdfGenerator] Using pedigree data from props:",JSON.stringify(e)),e}if(null==(n=null==c?void 0:c.pedigree)?void 0:n.data){const e=c.pedigree.data;return ze.debug("[PdfGenerator] Using pedigree data from unified model:",JSON.stringify(e)),e}return d.pedigreeDataUrl?(ze.debug("[PdfGenerator] No pedigree data available, using hasImage fallback"),{hasImage:!0}):(ze.debug("[PdfGenerator] No pedigree data or image URL available"),null)}));function y(e,t){return e.replace(/{{\s*([\w]+)\s*}}/g,((e,n)=>n in t?t[n]:""))}function b(e){return"yes"===e?"Ja":"Nein"}function v(e,t,n){t&&t.elements&&t.elements.forEach((t=>{switch(t.type){case"text":!function(e,t,n){let a;a=t.contents&&t.contents[i.value]?y(t.contents[i.value],n):y(t.content,n),t.style&&(e.setFont(t.style.font||"Helvetica",t.style.fontStyle||"normal"),e.setFontSize(t.style.fontSize||12),e.setTextColor(t.style.color||"#000000")),e.text(a,t.position.x,t.position.y)}(e,t,n);break;case"image":!function(e,t,n){const a=y(t.source,n);e.addImage(a,"PNG",t.position.x,t.position.y,t.size.width,t.size.height)}(e,t,n);break;case"rectangle":!function(e,t){const{x:n,y:a}=t.position,{width:r,height:o}=t.size,i=t.style||{};i.fill&&i.fillColor&&e.setFillColor(i.fillColor),i.borderColor&&e.setDrawColor(i.borderColor),e.setLineWidth(i.borderWidth||1);let l="S";i.fill&&i.fillColor&&(l=i.borderWidth?"DF":"F"),e.rect(n,a,r,o,l)}(e,t);break;case"line":!function(e,t){const{x:n,y:a}=t.start,{x:r,y:o}=t.end,i=t.style||{};e.setLineWidth(i.lineWidth||1),i.color&&e.setDrawColor(i.color),e.line(n,a,r,o)}(e,t);break;default:ze.debug("Unknown element type:",t.type)}}))}async function w(){var e,t,n,a,r,o,l,s,m;try{ze.debug("Starting PDF generation process...");const S=new Ne({orientation:"portrait",unit:"pt",format:"A4"}),P={givenName:(null==(e=null==c?void 0:c.personalInfo)?void 0:e.firstName)||d.patientData.givenName||"",familyName:(null==(t=null==c?void 0:c.personalInfo)?void 0:t.lastName)||d.patientData.familyName||"",birthdate:(null==(n=null==c?void 0:c.personalInfo)?void 0:n.birthdate)||d.patientData.birthdate||"",sex:(null==(a=null==c?void 0:c.personalInfo)?void 0:a.sex)||d.patientData.sex||"",insurance:(null==(r=null==c?void 0:c.personalInfo)?void 0:r.insurance)||d.patientData.insurance||"",physicianName:(null==(o=null==c?void 0:c.personalInfo)?void 0:o.referrer)||d.patientData.physicianName||"",...d.patientData,...oa.header,...oa.footer};oa.header&&v(S,oa.header,P),oa.body&&v(S,oa.body,P);const{baseY:k=350,maxHeight:_=600,spacing:C=14,offsetX:A=60,secondPageBaseY:I=50}=oa.panels||{};let F=k;if(u.value.forEach((e=>{F+C>_&&(S.addPage(),F=I),F=function(e,t,n,a,r){e.setFont("Helvetica","bold"),e.setFontSize(12),e.setTextColor("#000000"),e.text(t,n,a);const o=e.getTextWidth(t);return e.line(n,a+2,n+o,a+2),a+r}(S,e.categoryTitle,A,F,C),e.tests.forEach((e=>{let t=C;if(e.genes&&e.genes.length>0){const n=e.genes.join(", "),a=S.internal.pageSize.getWidth()-A-40;t+=S.splitTextToSize(n,a).length*C}F+t>_&&(S.addPage(),F=I),F=function(e,t,n,a,r){if(e.setFont("Helvetica","bold"),e.setFontSize(12),e.setTextColor("#000000"),e.text(t.name,n,a),a+=r,t.genes&&t.genes.length>0){e.setFont("Helvetica","italic"),e.setFontSize(10),e.setTextColor("#000000");const o=t.genes.join(", "),i=e.internal.pageSize.getWidth()-n-40;e.splitTextToSize(o,i).forEach((t=>{e.text(t,n,a),a+=r}))}return e.setFont("Helvetica","normal"),e.setFontSize(12),a}(S,e,A,F,C)}))})),(null==(l=oa.qr)?void 0:l.position)&&(null==(s=oa.qr)?void 0:s.size))try{const e={qrOptions:{width:128,margin:2,color:{dark:"#000000",light:"#ffffff"}}},t=await async function(e,t={}){const n=[1,1,[e.firstName||"",e.lastName||"",e.birthdate||"",e.sex||"",e.insurance||"",e.insuranceId||"",e.referrer||"",e.diagnosis||""],t.selectedTests||[]],a=JSON.stringify(n).replace(/\s/g,"");return ze.debug("Patient QR data size:",a.length,"characters"),ia(a,t.qrOptions||{})}(p.value.patient,{selectedTests:p.value.selectedTests,...e});S.setPage(1),S.setFont("Helvetica","bold"),S.setFontSize(10),S.text("Patient QR Code",oa.qr.position.x+oa.qr.size.width/2-40,oa.qr.position.y-10),S.addImage(t,"PNG",oa.qr.position.x,oa.qr.position.y,oa.qr.size.width,oa.qr.size.height)}catch(g){ze.debug("Failed to generate or add patient QR code:",g)}try{await async function(e){var t,n;let a={},r=!1;const o=(null==c?void 0:c.phenotypeData)||[];var l;if(o.length>0&&(a=(l=o)&&Array.isArray(l)?l.reduce(((e,t)=>(t&&t.status&&"no input"!==t.status&&(e[t.categoryId]||(e[t.categoryId]={}),e[t.categoryId][t.phenotypeId]=t.status),e)),{}):{},r=Object.values(a).some((e=>Object.values(e).some((e=>"no input"!==e)))),o.length>0&&!r&&ze.debug("[PdfGenerator] Unified phenotype data existed but contained only 'no input' entries.")),!r&&d.phenotypeData){ze.debug("[PdfGenerator] Checking legacy props.phenotypeData as unified data was empty or lacked meaningful entries."),a=d.phenotypeData;for(const e in a){for(const t in a[e])if("no input"!==a[e][t]){r=!0;break}if(r)break}}if(!r)return void ze.debug("[PdfGenerator] Skipping phenotype page: No meaningful data found in unified or legacy sources.");ze.debug("[PdfGenerator] Proceeding to render phenotype page."),e.addPage();const s=e.internal.getNumberOfPages();e.setPage(s),e.setFont("Helvetica","bold"),e.setFontSize(16);const u=(null==(n=null==(t=oa.phenotypePage)?void 0:t.titleContents)?void 0:n[i.value])||"Phenotype Data";e.text(u,40,40);let p=70;e.setFont("Helvetica","normal"),e.setFontSize(12);try{const t=[];for(const e in a)for(const n in a[e]){const r=a[e][n];if("no input"!==r){const a=Ze.categories.find((t=>t.id===e));if(a){const o=a.phenotypes.find((e=>e.id===n));if(o&&o.hpo){const e=o.hpo.replace("HP:","");t.push(`${"present"===r?"+":"-"}${e}`)}else ze.warn(`Could not find HPO ID for ${e}/${n} for QR code.`)}}}if(t.length>0){ze.debug("Generating phenotype QR code with",t.length,"meaningful items");const n=f.value&&f.value.length>0?f.value:t;ze.debug(`Using ${n===f.value?"computed":"collected"} phenotype data for QR code with ${n.length} items`);const a=await async function(e,t={}){const n=[1,2,function(e){if(!e||!Array.isArray(e))return ze.warn("Invalid phenotype data provided for QR encoding"),[];try{return e.map((e=>{if(!e||!e.id)return ze.debug("Skipping phenotype item with no ID"),null;let t;if("string"==typeof e.id&&e.id.startsWith("HP:")){if(t=parseInt(e.id.substring(3),10),isNaN(t))return ze.warn(`Invalid HPO ID format: ${e.id}`),null}else t=e.id;return`${e.present?"+":"-"}${t}`})).filter((e=>null!==e))}catch(t){return ze.error("Error encoding phenotype data:",t),[]}}(e||[])],a=JSON.stringify(n).replace(/\s/g,"");return ze.debug("Phenotype QR data size:",a.length,"characters"),ia(a,t.qrOptions||{})}(n,{qrOptions:{width:oa.qr.size.width,margin:1,errorCorrectionLevel:"M"}});e.setFont("Helvetica","bold"),e.setFontSize(10),e.text("Phenotype QR Code",oa.qr.position.x+oa.qr.size.width/2-40,oa.qr.position.y-10),e.addImage(a,"PNG",oa.qr.position.x,oa.qr.position.y,oa.qr.size.width,oa.qr.size.height)}else ze.debug("No meaningful phenotype data available for QR code generation after filtering.")}catch(g){ze.debug("Failed to generate or add phenotype QR code:",g)}e.setFontSize(12),e.setFont("Helvetica","normal"),p=70;for(const i in a){const t=Ze.categories.find((e=>e.id===i));if(!t||!t.phenotypes)continue;const n=t.phenotypes.filter((e=>{var t;return(null==(t=a[i])?void 0:t[e.id])&&"no input"!==a[i][e.id]}));n.length>0&&(e.setFont("Helvetica","bold"),e.text(t.title,40,p),p+=16,e.setFont("Helvetica","normal"),n.forEach((t=>{const n=a[i][t.id],r=`${t.name} (${t.hpo}): ${n}`;e.text(r,40,p),p+=14,p>e.internal.pageSize.getHeight()-40&&(e.addPage(),p=40)})),p+=10)}}(S)}catch(w){ze.debug("Error rendering phenotype page:",w)}if(d.pedigreeDataUrl&&""!==d.pedigreeDataUrl){let e=null;if(h.value)try{ze.debug("[PdfGenerator] Actual pedigree data being sent to QR generator:",JSON.stringify(h.value));const t=JSON.stringify(h.value).length,n=t>1e3?120:t>500?100:80;h.value?e=await la(h.value,{qrOptions:{width:n,margin:1,errorCorrectionLevel:"M"}}):(ze.debug("[PdfGenerator] Invalid pedigree data format:",h.value),e=await la([0],{format:"image",qrOptions:{width:80,margin:1,errorCorrectionLevel:"M"}})),ze.debug("Generated pedigree QR code with PED format data")}catch(g){ze.debug("Error generating pedigree QR code:",g);try{e=await la({hasImage:!0},{format:"image",qrOptions:{width:80,margin:1,errorCorrectionLevel:"M"}}),ze.debug("Generated fallback pedigree QR code (image reference only)")}catch(D){ze.debug("Error generating fallback pedigree QR code:",D)}}await new Promise((t=>{const n=new Image;n.src=d.pedigreeDataUrl,n.onload=()=>{try{S.addPage();const t=S.internal.getNumberOfPages();S.setPage(t),S.setFont("Helvetica","bold"),S.setFontSize(16),S.text("Family Pedigree",40,40);const a=S.internal.pageSize.getWidth(),r=S.internal.pageSize.getHeight(),o=40,i=a-2*o,l=r-2*o-40,s=Math.min(i/n.width,l/n.height,1),c=n.width*s,u=n.height*s,p=(a-c)/2,f=80;S.addImage(d.pedigreeDataUrl,"PNG",p,f,c,u),e&&(S.setFont("Helvetica","bold"),S.setFontSize(10),S.text("Pedigree QR Code",oa.qr.position.x+oa.qr.size.width/2-40,oa.qr.position.y-10),S.addImage(e,"PNG",oa.qr.position.x,oa.qr.position.y,oa.qr.size.width,oa.qr.size.height))}catch(a){ze.debug("Error rendering pedigree:",a)}t()},n.onerror=()=>{ze.debug("Error loading pedigree image."),t()}}))}const E=(null==(m=null==c?void 0:c.consent)?void 0:m.dataProcessing)||d.patientData.genDGConsentData&&"fill"===d.patientData.genDGConsentData.provided;if(ze.debug("generatePdf in PdfGenerator: Checking consent data availability:",E),E){ze.debug("Attempting to render consent page...");try{!function(e){ze.debug("Rendering consent page...");try{if(!d.patientData.genDGConsentData||!d.patientData.genDGConsentData.form)return void ze.debug("Consent form data is missing in PdfGenerator");const t=d.patientData.genDGConsentData.form,n=oa.consent;ze.debug("Consent Form Data:",JSON.stringify(t)),ze.debug("Consent Config:",JSON.stringify(n));const a={consentName:t.consentName||"",zufallsbefundeLabel:b(t.questionSecondaryFindings),materialLabel:b(t.questionMaterial),extendedLabel:b(t.questionExtended),researchLabel:b(t.questionResearch)};e.addPage(),e.setFont("Helvetica","normal"),e.setFontSize(10);let r=n.startY||40;const o=40,l=40,s=e.internal.pageSize.getWidth()-o-l,c=n.lineSpacing||5,u=n.paragraphSpacing||10;if(n.title){e.setFont("Helvetica","bold"),e.setFontSize(n.title.fontSize||14);let t=n.title;n.titleContents&&n.titleContents[i.value]&&(t=n.titleContents[i.value],ze.debug(`Using localized title for ${i.value}`)),e.splitTextToSize(t,s).forEach((t=>{e.text(t,o,r),r+=.5*(n.title.fontSize||14)})),r+=c,e.setFont("Helvetica","normal"),e.setFontSize(10)}ze.debug("Rendering paragraphs...");let p=n.paragraphs;n.paragraphsContents&&n.paragraphsContents[i.value]&&(p=n.paragraphsContents[i.value],ze.debug(`Using localized paragraphs for ${i.value}`)),p.forEach((t=>{const i=y(t,a);e.splitTextToSize(i,s).forEach((t=>{r+c>e.internal.pageSize.getHeight()-60&&(e.addPage(),r=n.startY||40),e.text(t,o,r),r+=1.2*e.getFontSize()})),r+=u}));let f=r+(n.signatureArea.marginTop||20);const h=n.signatureArea.lineStartX||o,m=n.signatureArea.patientLineEndX||h+200,g=n.signatureArea.physicianLineStartX||o+250,v=n.signatureArea.physicianLineEndX||g+200;let w=n.signatureArea;n.signatureAreaContents&&n.signatureAreaContents[i.value]&&(w=n.signatureAreaContents[i.value],ze.debug(`Using localized signature area for ${i.value}`));const D=`${"en"===i.value?"Date":"Datum"}: ${t.consentDate||"___________"}`;e.text(D,h,f),f+=1.4*e.getFontSize();const x=f;e.line(h,x,m,x),w.patientLabel&&e.text(w.patientLabel,h,x+1.2*e.getFontSize());const S=f;e.line(g,S,v,S),w.physicianLabel&&e.text(w.physicianLabel,g,S+1.2*e.getFontSize());const P=Math.max(x,S)+2.4*e.getFontSize();w.signHint&&e.text(w.signHint,h,P),ze.debug("Finished rendering consent page content.")}catch(t){ze.debug("Error during renderConsentPage:",t)}}(S)}catch(x){ze.debug("Caught error during renderConsentPage call:",x)}}const N=S.internal.getNumberOfPages();if(oa.pageNumber&&oa.pageNumber.enabled)for(let e=1;e<=N;e++){S.setPage(e);const{x:t,y:n}=oa.pageNumber.position,a=`Page ${e} of ${N}`;S.setFont(oa.pageNumber.font||"Helvetica",oa.pageNumber.fontStyle||"normal"),S.setFontSize(oa.pageNumber.fontSize||10),S.setTextColor(oa.pageNumber.color||"#000000"),S.text(a,t,n)}const L=`PDF Schema: v${oa.schema.version} | Test Schema: v${Ze.schema.version}`;for(let e=1;e<=N;e++)S.setPage(e),S.setFont("Helvetica","normal"),S.setFontSize(8),S.setTextColor("#000000"),S.text(L,40,S.internal.pageSize.getHeight()-10);S.save("genetic_test_requisition.pdf"),ze.debug("PDF generation process completed.")}catch(S){ze.debug("Error during PDF generation process:",S),alert("An error occurred while generating the PDF. Please check the console for details.")}}return(e,t)=>(r(),g("div",null,[l(B,{onClick:w,color:"primary",dark:""},{default:o((()=>t[0]||(t[0]=[s("\n      Generate PDF\n    ")]))),_:1})]))}},da=He(S({name:"AppDisclaimer",setup(){const{t:e}=T();return{t:e}},data:()=>({dialog:!0}),methods:{acknowledge(){this.dialog=!1,this.$emit("dismiss")}}}),[["render",function(e,t,n,c,u,p){return r(),a(ye,{modelValue:e.dialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dialog=t),persistent:"","max-width":"600"},{default:o((()=>[l(he,null,{default:o((()=>[l(pe,{class:"headline"},{default:o((()=>[s(d(e.$t("disclaimer.title")),1)])),_:1}),t[2]||(t[2]=s()),l(fe,null,{default:o((()=>[i("p",null,d(e.$t("disclaimer.body")),1)])),_:1}),t[3]||(t[3]=s()),l(ge,null,{default:o((()=>[l(H),t[1]||(t[1]=s()),l(B,{color:"primary",text:"",onClick:e.acknowledge},{default:o((()=>[s(d(e.$t("disclaimer.acknowledgeButton")),1)])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}],["__scopeId","data-v-f9347362"]]);let ca;const ua=e=>ca=e,pa=Symbol();function fa(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var ha,ma;(ma=ha||(ha={})).direct="direct",ma.patchObject="patch object",ma.patchFunction="patch function";const ga=()=>{};function ya(e,t,n,a=ga){e.push(t);const r=()=>{const n=e.indexOf(t);n>-1&&(e.splice(n,1),a())};return!n&&A()&&I(r),r}function ba(e,...t){e.slice().forEach((e=>{e(...t)}))}const va=e=>e(),wa=Symbol(),Da=Symbol();function xa(e,t){e instanceof Map&&t instanceof Map?t.forEach(((t,n)=>e.set(n,t))):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const a=t[n],r=e[n];fa(r)&&fa(a)&&e.hasOwnProperty(n)&&!y(a)&&!_(a)?e[n]=xa(r,a):e[n]=a}return e}const Sa=Symbol(),{assign:Pa}=Object;function ka(t,n,a={},r,o,i){let l;const s=Pa({actions:{}},a),d={deep:!0};let c,u,p,m=[],g=[];const b=r.state.value[t];let w;function D(e){let n;c=u=!1,"function"==typeof e?(e(r.state.value[t]),n={type:ha.patchFunction,storeId:t,events:p}):(xa(r.state.value[t],e),n={type:ha.patchObject,payload:e,storeId:t,events:p});const a=w=Symbol();v().then((()=>{w===a&&(c=!0)})),u=!0,ba(m,n,r.state.value[t])}i||b||(r.state.value[t]={}),f({});const x=i?function(){const{state:e}=a,t=e?e():{};this.$patch((e=>{Pa(e,t)}))}:ga,S=(e,n="")=>{if(wa in e)return e[Da]=n,e;const a=function(){ua(r);const n=Array.from(arguments),o=[],i=[];let l;ba(g,{args:n,name:a[Da],store:A,after:function(e){o.push(e)},onError:function(e){i.push(e)}});try{l=e.apply(this&&this.$id===t?this:A,n)}catch(s){throw ba(i,s),s}return l instanceof Promise?l.then((e=>(ba(o,e),e))).catch((e=>(ba(i,e),Promise.reject(e)))):(ba(o,l),l)};return a[wa]=!0,a[Da]=n,a},k={_p:r,$id:t,$onAction:ya.bind(null,g),$patch:D,$reset:x,$subscribe(e,n={}){const a=ya(m,e,n.detached,(()=>o())),o=l.run((()=>h((()=>r.state.value[t]),(a=>{("sync"===n.flush?u:c)&&e({storeId:t,type:ha.direct,events:p},a)}),Pa({},d,n))));return a},$dispose:function(){l.stop(),m=[],g=[],r._s.delete(t)}},A=e(k);r._s.set(t,A);const I=(r._a&&r._a.runWithContext||va)((()=>r._e.run((()=>(l=P()).run((()=>n({action:S})))))));for(const e in I){const n=I[e];if(y(n)&&(!y(E=n)||!E.effect)||_(n))i||(!b||fa(F=n)&&F.hasOwnProperty(Sa)||(y(n)?n.value=b[e]:xa(n,b[e])),r.state.value[t][e]=n);else if("function"==typeof n){const t=S(n,e);I[e]=t,s.actions[e]=n}}var F,E;return Pa(A,I),Pa(C(A),I),Object.defineProperty(A,"$state",{get:()=>r.state.value[t],set:e=>{D((t=>{Pa(t,e)}))}}),r._p.forEach((e=>{Pa(A,l.run((()=>e({store:A,app:r._a,pinia:r,options:s}))))})),b&&i&&a.hydrate&&a.hydrate(A.$state,b),c=!0,u=!0,A}function _a(e,t,a){let r;const o="function"==typeof t;function i(a,i){const l=E();return(a=a||(l?m(pa,null):null))&&ua(a),(a=ca)._s.has(e)||(o?ka(e,t,r,a):function(e,t,a){const{state:r,actions:o,getters:i}=t,l=a.state.value[e];let s;s=ka(e,(function(){l||(a.state.value[e]=r?r():{});const t=F(a.state.value[e]);return Pa(t,o,Object.keys(i||{}).reduce(((t,r)=>(t[r]=k(n((()=>{ua(a);const t=a._s.get(e);return i[r].call(t,t)}))),t)),{}))}),t,a,0,!0)}(e,r,a)),a._s.get(e)}return r=o?a:t,i.$id=e,i}const Ca=_a("ui",(()=>{const e=f(!1),t=f(!1),n=f(""),a=f(!1),r=f(!1),o=f(!1),i=f(!1),l=f(!1),s=f(!1),d=f(!1),c=f(!1),u="requiform_logViewerVisible",p=f("true"===localStorage.getItem(u)),h=f(""),m=f(""),g=f("");return{isDark:e,snackbar:t,snackbarMessage:n,encryptionDialog:a,decryptionDialog:r,showFAQModal:o,resetConfirmationDialog:i,saveDataDialog:l,loadDataDialog:s,pasteDataDialog:d,showDisclaimerModal:c,showLogViewer:p,decryptionError:h,loadDataError:m,pendingEncryptedValue:g,toggleTheme:function(){e.value=!e.value},showSnackbar:function(e){n.value=e,t.value=!0},openEncryptionDialog:function(){a.value=!0},closeEncryptionDialog:function(){a.value=!1},openDecryptionDialog:function(e=""){g.value=e,h.value="",r.value=!0},cancelDecryption:function(){r.value=!1,h.value="",g.value=""},setDecryptionError:function(e){h.value=e},toggleFAQModal:function(e=!0){o.value=e},openResetConfirmationDialog:function(){i.value=!0},closeResetConfirmationDialog:function(){i.value=!1},openSaveDataDialog:function(){l.value=!0},closeSaveDataDialog:function(){l.value=!1},openLoadDataDialog:function(){m.value="",s.value=!0},closeLoadDataDialog:function(){s.value=!1,m.value=""},setLoadDataError:function(e){m.value=e},openPasteDataDialog:function(){d.value=!0},closePasteDataDialog:function(){d.value=!1},openDisclaimerModal:function(){c.value=!0},closeDisclaimerModal:function(){c.value=!1},toggleLogViewer:function(){p.value=!p.value,localStorage.setItem(u,p.value.toString())},openLogViewer:function(){p.value=!0,localStorage.setItem(u,"true")},closeLogViewer:function(){p.value=!1,localStorage.setItem(u,"false")}}})),Aa="0.1.0",Ia={class:"content-wrapper"},Fa={class:"versions flex-grow-1"},Ea=He({__name:"AppFooter",props:{disclaimerAcknowledged:{type:Boolean,default:!1},acknowledgmentTime:{type:String,default:""}},emits:["reopen-disclaimer"],setup(e,{emit:t}){w((e=>({"06647272":c(qe).styles.footerBackgroundColor})));const{t:f}=T(),h=e,m=t,g=Ca(),y=n((()=>Aa)),b=n((()=>oa.schema&&oa.schema.version||"N/A")),v=n((()=>Ze.schema&&Ze.schema.version||"N/A"));return(e,t)=>(r(),a(be,{app:"",padless:"",class:"footer"},{default:o((()=>[i("div",Ia,[i("span",Fa,d(c(f)("footer.versions.app"))+" v"+d(y.value)+" | "+d(c(f)("footer.versions.testSchema"))+" v"+d(v.value)+" | "+d(c(f)("footer.versions.pdfSchema"))+" v"+d(b.value),1),t[6]||(t[6]=s()),h.disclaimerAcknowledged?(r(),a(M,{key:0,location:"top"},{activator:o((({props:e})=>[l(B,u({icon:"mdi-shield-check",color:"green",variant:"text",size:"small",class:"ml-2"},e,{onClick:t[0]||(t[0]=e=>m("reopen-disclaimer")),"aria-label":c(f)("footer.ariaLabels.reopenDisclaimer")}),null,16,["aria-label"])])),default:o((()=>[t[1]||(t[1]=s()),i("span",null,d(c(f)("footer.tooltips.disclaimerAcknowledged"))+" "+d(h.acknowledgmentTime),1)])),_:1})):p("",!0),t[7]||(t[7]=s()),l(M,{location:"top"},{activator:o((({props:e})=>[l(B,u({icon:"mdi-math-log",variant:"text",size:"small",class:"ml-2"},e,{onClick:c(g).toggleLogViewer,"aria-label":c(f)("footer.ariaLabels.toggleLogViewer")}),null,16,["onClick","aria-label"])])),default:o((()=>[t[2]||(t[2]=s()),i("span",null,d(c(f)("footer.tooltips.toggleLogViewer")),1)])),_:1}),t[8]||(t[8]=s()),l(M,{location:"top"},{activator:o((({props:e})=>[l(B,u({icon:"mdi-github",variant:"text",size:"small",class:"ml-2",href:"https://github.com/BerntPopp/RequiForm",target:"_blank",rel:"noopener noreferrer","aria-label":c(f)("footer.ariaLabels.githubRepo")},e),null,16,["aria-label"])])),default:o((()=>[t[3]||(t[3]=s()),i("span",null,d(c(f)("footer.tooltips.githubRepo")),1)])),_:1}),t[9]||(t[9]=s()),l(M,{location:"top"},{activator:o((({props:e})=>[l(B,u({icon:"mdi-license",variant:"text",size:"small",class:"ml-2",href:"https://github.com/BerntPopp/RequiForm/blob/main/LICENSE",target:"_blank",rel:"noopener noreferrer","aria-label":c(f)("footer.ariaLabels.licenseInfo")},e),null,16,["aria-label"])])),default:o((()=>[t[4]||(t[4]=s()),i("span",null,d(c(f)("footer.tooltips.license")),1)])),_:1}),t[10]||(t[10]=s()),l(M,{location:"top"},{activator:o((({props:e})=>[l(B,u({icon:"mdi-book-open-variant",variant:"text",size:"small",class:"ml-2",href:"https://github.com/BerntPopp/RequiForm/wiki",target:"_blank",rel:"noopener noreferrer","aria-label":c(f)("footer.ariaLabels.wikiDocs")},e),null,16,["aria-label"])])),default:o((()=>[t[5]||(t[5]=s()),i("span",null,d(c(f)("footer.tooltips.wiki")),1)])),_:1})])])),_:1}))}},[["__scopeId","data-v-f2cbf992"]]);function Na(e){if(!e||"string"!=typeof e||""===e.trim())return{success:!1,error:"No data provided. Please paste your data into the text area."};try{const n={personalInfo:{},selectedPanels:[],phenotypeData:[],category:"",consent:{}},a=e.split("\n"),r={"first name":{section:"personalInfo",field:"firstName"},firstname:{section:"personalInfo",field:"firstName"},"given name":{section:"personalInfo",field:"firstName"},givenname:{section:"personalInfo",field:"firstName"},"last name":{section:"personalInfo",field:"lastName"},lastname:{section:"personalInfo",field:"lastName"},"family name":{section:"personalInfo",field:"lastName"},familyname:{section:"personalInfo",field:"lastName"},"birth date":{section:"personalInfo",field:"birthdate"},birthdate:{section:"personalInfo",field:"birthdate"},"date of birth":{section:"personalInfo",field:"birthdate"},dob:{section:"personalInfo",field:"birthdate"},sex:{section:"personalInfo",field:"sex"},gender:{section:"personalInfo",field:"sex"},insurance:{section:"personalInfo",field:"insurance"},"insurance provider":{section:"personalInfo",field:"insurance"},"insurance id":{section:"personalInfo",field:"insuranceId"},insuranceid:{section:"personalInfo",field:"insuranceId"},physician:{section:"personalInfo",field:"referrer"},"physician name":{section:"personalInfo",field:"referrer"},doctor:{section:"personalInfo",field:"referrer"},referrer:{section:"personalInfo",field:"referrer"},"referring physician":{section:"personalInfo",field:"referrer"},diagnosis:{section:"personalInfo",field:"diagnosis"},"clinical diagnosis":{section:"personalInfo",field:"diagnosis"},panels:{section:"special",field:"panels"},"selected panels":{section:"special",field:"panels"},tests:{section:"special",field:"panels"},"selected tests":{section:"special",field:"panels"},category:{section:"root",field:"category"},phenotypes:{section:"special",field:"phenotypes"}};for(const e of a){if(!e.trim())continue;const a=e.match(/:(.*)|=(.*)/);if(!a)continue;const o=e.indexOf(a[0]),i=e.substring(0,o).trim().toLowerCase(),l=(a[1]||a[2]||"").trim();if(!l)continue;const s=r[i];if(s)if("root"===s.section)n[s.field]=l;else if("personalInfo"===s.section)n.personalInfo[s.field]=l;else if("special"===s.section)if("panels"===s.field)n.selectedPanels=l.split(",").map((e=>e.trim())).filter(Boolean);else if("phenotypes"===s.field)try{l.startsWith("[")&&l.endsWith("]")&&(n.phenotypeData=JSON.parse(l))}catch(t){}}return 0===Object.keys(n.personalInfo).length?{success:!1,error:"No valid patient data found. Please check the format and try again."}:{success:!0,data:n}}catch(n){return{success:!1,error:"An error occurred while parsing the data. Please check the format and try again."}}}const La={class:"mb-4"},Oa={class:"mb-1"},Va={class:"text-body-2"},Ta=He({__name:"PasteDataModal",props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue","close","import"],setup(e,{emit:t}){const{t:u}=T(),m=e,g=t,y=f(""),b=f(null),v=f(""),w=f(!1),D=n((()=>"First Name: Jane\nLast Name: Doe\nBirthdate: 1990-05-15\nSex: female\nInsurance: ABC Health\nPhysician: Dr. Smith\nDiagnosis: Suspected Renal Disease\nPanels: nephronophthise, alport_thin_basement, cystic_kidney_disease")),x=n({get:()=>m.modelValue,set:e=>g("update:modelValue",e)});function S(){y.value.trim()?(ze.debug("PasteDataModal: Parsing data:",y.value.substring(0,100)+"..."),b.value=Na(y.value),ze.debug("PasteDataModal: Parse result:",b.value),v.value=b.value.success?"":b.value.error||u("pasteDataModal.alerts.parseError")):v.value=u("pasteDataModal.validation.pasteRequired")}function P(){if(b.value&&b.value.success){const e=JSON.stringify(b.value.data);ze.info("PasteDataModal: Sending data for import:",b.value.data),g("import",e),x.value=!1}}function k(){y.value=D.value,b.value=null,v.value=""}return h((()=>m.modelValue),(e=>{!0===e&&(y.value="",b.value=null,v.value="",w.value=!1)})),(e,t)=>(r(),a(ye,{modelValue:x.value,"onUpdate:modelValue":t[3]||(t[3]=e=>x.value=e),"max-width":"700",persistent:""},{default:o((()=>[l(he,null,{default:o((()=>[l(pe,{class:"headline"},{default:o((()=>[s(d(c(u)("pasteDataModal.title")),1)])),_:1}),t[14]||(t[14]=s()),l(fe,null,{default:o((()=>[i("p",La,d(c(u)("pasteDataModal.instructions")),1),t[6]||(t[6]=s()),l(ve,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=e=>y.value=e),outlined:"",rows:"10",label:c(u)("pasteDataModal.labels.pasteArea"),placeholder:c(u)("pasteDataModal.placeholders.pasteArea"),"error-messages":v.value,"auto-grow":"",class:"mb-3"},null,8,["modelValue","label","placeholder","error-messages"]),t[7]||(t[7]=s()),w.value?(r(),a(me,{key:0,type:"info",text:"",class:"mb-3"},{default:o((()=>[i("p",Oa,[i("strong",null,d(c(u)("pasteDataModal.example.title")),1)]),t[4]||(t[4]=s()),i("pre",Va,d(D.value),1),t[5]||(t[5]=s()),l(B,{"x-small":"",text:"",color:"primary",onClick:k,class:"mt-2"},{default:o((()=>[s(d(c(u)("pasteDataModal.example.useButton")),1)])),_:1})])),_:1})):p("",!0),t[8]||(t[8]=s()),b.value&&!b.value.success?(r(),a(me,{key:1,type:"error",text:"",class:"mb-3"},{default:o((()=>[s(d(b.value.error),1)])),_:1})):p("",!0),t[9]||(t[9]=s()),b.value&&b.value.success?(r(),a(me,{key:2,type:"success",text:"",class:"mb-3"},{default:o((()=>[s(d(c(u)("pasteDataModal.alerts.parseSuccess")),1)])),_:1})):p("",!0)])),_:1}),t[15]||(t[15]=s()),l(te),t[16]||(t[16]=s()),l(ge,null,{default:o((()=>[l(B,{color:"primary",text:"",onClick:t[1]||(t[1]=e=>w.value=!w.value)},{default:o((()=>[s(d(w.value?c(u)("pasteDataModal.example.hideButton"):c(u)("pasteDataModal.example.showButton")),1)])),_:1}),t[10]||(t[10]=s()),l(H),t[11]||(t[11]=s()),l(B,{text:"",onClick:t[2]||(t[2]=t=>e.$emit("close"))},{default:o((()=>[s(d(c(u)("pasteDataModal.buttons.cancel")),1)])),_:1}),t[12]||(t[12]=s()),l(B,{color:"primary",text:"",onClick:S,disabled:!y.value.trim()},{default:o((()=>[s(d(c(u)("pasteDataModal.buttons.parse")),1)])),_:1},8,["disabled"]),t[13]||(t[13]=s()),l(B,{color:"success",text:"",onClick:P,disabled:!b.value||!b.value.success},{default:o((()=>[s(d(c(u)("pasteDataModal.buttons.import")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1},8,["modelValue"]))}},[["__scopeId","data-v-02ff2b53"]]),Ra={key:0,class:"selected-panels-summary mt-4"},za={class:"category-header"},Ma={class:"panel-name"},Ua={key:0,class:"panel-genes"},qa=He({__name:"SelectedPanelsSummary",props:{groupedPanelDetails:{type:Array,required:!0}},setup(e){const{t}=T(),a=T(),o=n((()=>a.locale.value));return(n,a)=>e.groupedPanelDetails.length?(r(),g("div",Ra,[i("h2",null,d(c(t)("selectedPanelsSummary.title")),1),a[2]||(a[2]=s()),(r(!0),g(D,null,x(e.groupedPanelDetails,(e=>{return r(),g("div",{key:e.id||e.categoryTitle},[i("h3",za,d((t=e,t.titles&&t.titles[o.value]?t.titles[o.value]:t.categoryTitle)),1),a[1]||(a[1]=s()),i("ul",null,[(r(!0),g(D,null,x(e.tests,(e=>{return r(),g("li",{key:e.id,class:"panel-item"},[i("div",Ma,[i("strong",null,d((t=e,t.names&&t.names[o.value]?t.names[o.value]:t.name)),1)]),a[0]||(a[0]=s()),e.genes&&e.genes.length?(r(),g("div",Ua,[i("em",null,d(e.genes.join(", ")),1)])):p("",!0)]);var t})),128))])]);var t})),128))])):p("",!0)}},[["__scopeId","data-v-299f8aeb"]]),Ha={class:"log-header-controls"},Ba={class:"d-flex align-center"},$a={class:"timestamp mr-2"},ja={class:"level mr-2"},Ga={class:"message flex-grow-1"},Ja={key:0,class:"log-details mt-1"},Ka=He({__name:"LogViewer",setup(e){const{t}=T(),u=Ca(),m=n((()=>ze.entries)),y=()=>{u.toggleLogViewer()},w=()=>{if(m.value&&0!==m.value.length)try{const e=JSON.stringify(m.value,null,2),t=new Blob([e],{type:"application/json"}),n=`requiform-logs-${(new Date).toISOString().replace(/[:.]/g,"-")}.json`,a=document.createElement("a");a.href=URL.createObjectURL(t),a.download=n,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(a.href),ze.info("LogViewer: Logs downloaded successfully.")}catch(e){ze.error("LogViewer: Failed to download logs:",e)}else ze.warn("LogViewer: No logs to download.")},S=()=>{ze.clear()},P=n((()=>[{title:t("logViewer.levels.debug"),value:Oe.DEBUG},{title:t("logViewer.levels.info"),value:Oe.INFO},{title:t("logViewer.levels.warn"),value:Oe.WARN},{title:t("logViewer.levels.error"),value:Oe.ERROR}])),k=n({get:()=>ze.currentLogLevel,set:e=>{ze.setLevel(e)}}),_=n((()=>{switch(k.value){case Oe.DEBUG:return"text-log-debug";case Oe.INFO:return"text-log-info";case Oe.WARN:return"text-log-warn";case Oe.ERROR:return"text-log-error";default:return""}})),C=f(new Set),A=e=>C.value.has(e),I=e=>{try{return JSON.stringify(e,null,2)}catch(t){return`Error formatting data: ${t.message}`}};return h(m,(async()=>{await v();const e=document.querySelector(".log-list");e&&(e.scrollTop=e.scrollHeight)}),{deep:!0}),b((async()=>{await v();const e=document.querySelector(".log-list");e&&(e.scrollTop=e.scrollHeight)})),(e,n)=>(r(),a(he,{class:"log-viewer-card",elevation:"8","max-width":"500","max-height":"400"},{default:o((()=>[l(pe,{class:"d-flex justify-space-between align-center py-2"},{default:o((()=>[i("span",null,d(c(t)("logViewer.title")),1),n[4]||(n[4]=s()),i("div",Ha,[l(X,{modelValue:k.value,"onUpdate:modelValue":n[0]||(n[0]=e=>k.value=e),items:P.value,density:"compact","hide-details":"",variant:"plain",class:N(["log-level-select",_.value])},null,8,["modelValue","items","class"]),n[1]||(n[1]=s()),l(B,{icon:"mdi-download",variant:"text",size:"small",onClick:w,title:c(t)("logViewer.buttons.download"),disabled:!m.value.length},null,8,["title","disabled"]),n[2]||(n[2]=s()),l(B,{icon:"mdi-delete-sweep",variant:"text",size:"small",onClick:S,title:c(t)("logViewer.buttons.clear"),disabled:!m.value.length},null,8,["title","disabled"]),n[3]||(n[3]=s()),l(B,{icon:"mdi-close",variant:"text",size:"small",onClick:y,title:c(t)("logViewer.buttons.close")},null,8,["title"])])])),_:1}),n[10]||(n[10]=s()),l(te),n[11]||(n[11]=s()),l(fe,{class:"log-list pa-0"},{default:o((()=>[l(G,{density:"compact",class:"py-0"},{default:o((()=>[(r(!0),g(D,null,x(m.value,((e,u)=>(r(),a(J,{key:u,class:N([["log-entry",`log-${e.level.toLowerCase()}`],"py-1 px-3"])},{default:o((()=>{return[i("div",Ba,[i("span",$a,d((f=e.timestamp,new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}))),1),n[5]||(n[5]=s()),i("span",ja,"["+d(e.level)+"]",1),n[6]||(n[6]=s()),i("span",Ga,d(e.displayMessage),1),n[7]||(n[7]=s()),null!==e.rawData?(r(),a(B,{key:0,icon:A(u)?"mdi-chevron-up":"mdi-chevron-down",variant:"text",size:"x-small",onClick:e=>(e=>{C.value.has(e)?C.value.delete(e):C.value.add(e)})(u),class:"ml-1",title:c(t)("logViewer.buttons.toggleDetails")},null,8,["icon","onClick","title"])):p("",!0)]),n[8]||(n[8]=s()),l(ue,null,{default:o((()=>[A(u)?(r(),g("div",Ja,[i("pre",null,d(I(e.rawData)),1)])):p("",!0)])),_:2},1024)];var f})),_:2},1032,["class"])))),128)),n[9]||(n[9]=s()),m.value.length?p("",!0):(r(),a(J,{key:0,class:"text-center text-disabled py-2"},{default:o((()=>[s(d(c(t)("logViewer.emptyState")),1)])),_:1}))])),_:1})])),_:1})])),_:1}))}},[["__scopeId","data-v-ccc42ee4"]]),Wa={__name:"EncryptionDialog",props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue","cancel","confirm"],setup(e,{emit:t}){const{t:n}=T(),i=e,u=t,p=f(""),m=f(null);function g(){u("cancel"),u("update:modelValue",!1)}function y(){""!==p.value.trim()&&(u("confirm",p.value),u("update:modelValue",!1))}return h((()=>i.modelValue),(e=>{e&&(p.value="",v((()=>{let e=null;m.value&&(m.value.input&&"function"==typeof m.value.input.focus?e=m.value.input:m.value.$el&&"function"==typeof m.value.$el.querySelector?e=m.value.$el.querySelector("input"):"function"==typeof m.value.focus&&(e=m.value)),e&&"function"==typeof e.focus&&e.focus()})))})),(t,i)=>(r(),a(ye,{"model-value":e.modelValue,"max-width":"500","onUpdate:modelValue":i[1]||(i[1]=e=>t.$emit("update:modelValue",e))},{default:o((()=>[l(he,null,{default:o((()=>[l(pe,{class:"headline"},{default:o((()=>[s(d(c(n)("encryptionDialog.title")),1)])),_:1}),i[4]||(i[4]=s()),l(fe,null,{default:o((()=>[l(Y,{ref_key:"passwordInputRef",ref:m,modelValue:p.value,"onUpdate:modelValue":i[0]||(i[0]=e=>p.value=e),type:"password",label:c(n)("encryptionDialog.labels.password"),autocomplete:"off",onKeyup:L(y,["enter"])},null,8,["modelValue","label"])])),_:1}),i[5]||(i[5]=s()),l(ge,null,{default:o((()=>[l(H),i[2]||(i[2]=s()),l(B,{text:"",onClick:g},{default:o((()=>[s(d(c(n)("encryptionDialog.buttons.cancel")),1)])),_:1}),i[3]||(i[3]=s()),l(B,{color:"primary",text:"",onClick:y},{default:o((()=>[s(d(c(n)("encryptionDialog.buttons.confirm")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["model-value"]))}},Qa={__name:"DecryptionDialog",props:{modelValue:{type:Boolean,required:!0},error:{type:String,default:""}},emits:["update:modelValue","cancel","confirm"],setup(e,{emit:t}){const{t:n}=T(),i=e,u=t,m=f(""),g=f(null);function y(){u("cancel"),u("update:modelValue",!1)}function b(){""!==m.value.trim()&&u("confirm",m.value)}return h((()=>i.modelValue),(e=>{e&&(m.value="",v((()=>{let e=null;g.value&&(g.value.input&&"function"==typeof g.value.input.focus?e=g.value.input:g.value.$el&&"function"==typeof g.value.$el.querySelector?e=g.value.$el.querySelector("input"):"function"==typeof g.value.focus&&(e=g.value)),e&&"function"==typeof e.focus&&e.focus()})))})),(t,i)=>(r(),a(ye,{"model-value":e.modelValue,"max-width":"500","onUpdate:modelValue":i[1]||(i[1]=e=>t.$emit("update:modelValue",e))},{default:o((()=>[l(he,null,{default:o((()=>[l(pe,{class:"headline"},{default:o((()=>[s(d(c(n)("decryptionDialog.title")),1)])),_:1}),i[5]||(i[5]=s()),l(fe,null,{default:o((()=>[l(Y,{ref_key:"passwordInputRef",ref:g,modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=e=>m.value=e),type:"password",label:c(n)("decryptionDialog.labels.password"),autocomplete:"off",onKeyup:L(b,["enter"])},null,8,["modelValue","label"]),i[2]||(i[2]=s()),e.error?(r(),a(me,{key:0,type:"error",class:"mt-3"},{default:o((()=>[s(d(e.error),1)])),_:1})):p("",!0)])),_:1}),i[6]||(i[6]=s()),l(ge,null,{default:o((()=>[l(H),i[3]||(i[3]=s()),l(B,{text:"",onClick:y},{default:o((()=>[s(d(c(n)("decryptionDialog.buttons.cancel")),1)])),_:1}),i[4]||(i[4]=s()),l(B,{color:"primary",text:"",onClick:b},{default:o((()=>[s(d(c(n)("decryptionDialog.buttons.confirm")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["model-value"]))}},Za={key:0,class:"text-h6 my-3"},Ya=["innerHTML"],Xa=He({__name:"FAQDialog",props:{modelValue:{type:Boolean,required:!0},faqItems:{type:Array,required:!0}},emits:["update:modelValue","close"],setup(e,{emit:t}){const{t:u}=T(),h=e,m=t,y=f(""),b=f([]),v=n((()=>{if(!y.value)return h.faqItems;const e=y.value.toLowerCase();return h.faqItems.filter((t=>t.question.toLowerCase().includes(e)||t.answer.toLowerCase().includes(e)||t.category&&t.category.toLowerCase().includes(e)))})),w=n((()=>v.value.reduce(((e,t)=>{const n=t.category||u("faqDialog.uncategorized");return e[n]||(e[n]=[]),e[n].push(t),e}),{})));function S(){m("close"),m("update:modelValue",!1),y.value="",b.value=[]}return(t,n)=>(r(),a(ye,{"model-value":e.modelValue,"max-width":"800",scrollable:"","onUpdate:modelValue":n[2]||(n[2]=e=>t.$emit("update:modelValue",e))},{default:o((()=>[l(he,null,{default:o((()=>[l(pe,{class:"headline"},{default:o((()=>[s(d(c(u)("faqDialog.title")),1)])),_:1}),n[8]||(n[8]=s()),l(fe,{class:"pt-4"},{default:o((()=>[l(Y,{modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=e=>y.value=e),label:c(u)("faqDialog.searchLabel"),"prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"","hide-details":"",class:"mb-4"},null,8,["modelValue","label"]),n[6]||(n[6]=s()),l(we,{modelValue:b.value,"onUpdate:modelValue":n[1]||(n[1]=e=>b.value=e),multiple:""},{default:o((()=>[(r(!0),g(D,null,x(w.value,((e,t)=>(r(),g(D,{key:t},["null"!==t&&e.length>0?(r(),g("h3",Za,d(t),1)):p("",!0),n[4]||(n[4]=s()),(r(!0),g(D,null,x(e,((e,c)=>(r(),a(De,{key:`${t}-${c}`,value:`${t}-${c}`},{default:o((()=>[l(xe,null,{default:o((()=>[l(q,{start:"",icon:"mdi-help-circle-outline"}),s(" "+d(e.question),1)])),_:2},1024),n[3]||(n[3]=s()),l(Se,{class:"faq-answer"},{default:o((()=>[i("p",{innerHTML:e.answer},null,8,Ya)])),_:2},1024)])),_:2},1032,["value"])))),128))],64)))),128)),n[5]||(n[5]=s()),Object.keys(w.value).length?p("",!0):(r(),a(me,{key:0,type:"info",variant:"tonal",class:"mt-4"},{default:o((()=>[s(d(c(u)("faqDialog.noResults")),1)])),_:1}))])),_:1},8,["modelValue"])])),_:1}),n[9]||(n[9]=s()),l(ge,null,{default:o((()=>[l(H),n[7]||(n[7]=s()),l(B,{text:"",onClick:S},{default:o((()=>[s(d(c(u)("faqDialog.buttons.close")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["model-value"]))}},[["__scopeId","data-v-3b40532a"]]),er={__name:"ResetConfirmationDialog",props:{modelValue:Boolean},emits:["update:modelValue","cancel","confirm"],setup(e,{emit:t}){const{t:n}=T(),u=t;function p(){u("cancel"),u("update:modelValue",!1)}function f(){u("confirm"),u("update:modelValue",!1)}return(t,u)=>(r(),a(ye,{"model-value":e.modelValue,"max-width":"500","onUpdate:modelValue":u[0]||(u[0]=e=>t.$emit("update:modelValue",e))},{default:o((()=>[l(he,null,{default:o((()=>[l(pe,{class:"headline"},{default:o((()=>[s(d(c(n)("resetConfirmationDialog.title")),1)])),_:1}),u[3]||(u[3]=s()),l(fe,null,{default:o((()=>[i("p",null,d(c(n)("resetConfirmationDialog.confirmationText")),1)])),_:1}),u[4]||(u[4]=s()),l(ge,null,{default:o((()=>[l(H),u[1]||(u[1]=s()),l(B,{text:"",onClick:p},{default:o((()=>[s(d(c(n)("resetConfirmationDialog.buttons.cancel")),1)])),_:1}),u[2]||(u[2]=s()),l(B,{color:"error",text:"",onClick:f},{default:o((()=>[s(d(c(n)("resetConfirmationDialog.buttons.reset")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["model-value"]))}},tr={__name:"SaveDataDialog",props:{modelValue:{type:Boolean,required:!0},defaultFileName:{type:String,default:""}},emits:["update:modelValue","cancel","confirm"],setup(e,{emit:t}){const{t:n}=T(),u=e,p=t,m=f(u.defaultFileName||n("saveDataDialog.defaultFileName"));function g(){p("cancel"),p("update:modelValue",!1)}function y(){p("confirm",m.value),p("update:modelValue",!1)}return h((()=>u.modelValue),(e=>{e&&(m.value=u.defaultFileName||n("saveDataDialog.defaultFileName"))})),(t,u)=>(r(),a(ye,{"model-value":e.modelValue,"max-width":"500","onUpdate:modelValue":u[1]||(u[1]=e=>t.$emit("update:modelValue",e))},{default:o((()=>[l(he,null,{default:o((()=>[l(pe,{class:"headline"},{default:o((()=>[s(d(c(n)("saveDataDialog.title")),1)])),_:1}),u[5]||(u[5]=s()),l(fe,null,{default:o((()=>[i("p",null,d(c(n)("saveDataDialog.instruction")),1),u[2]||(u[2]=s()),l(Y,{modelValue:m.value,"onUpdate:modelValue":u[0]||(u[0]=e=>m.value=e),label:c(n)("saveDataDialog.labels.fileName"),placeholder:c(n)("saveDataDialog.placeholders.fileName"),hint:c(n)("saveDataDialog.hints.fileName"),"persistent-hint":""},null,8,["modelValue","label","placeholder","hint"])])),_:1}),u[6]||(u[6]=s()),l(ge,null,{default:o((()=>[l(H),u[3]||(u[3]=s()),l(B,{text:"",onClick:g},{default:o((()=>[s(d(c(n)("saveDataDialog.buttons.cancel")),1)])),_:1}),u[4]||(u[4]=s()),l(B,{color:"primary",text:"",onClick:y},{default:o((()=>[s(d(c(n)("saveDataDialog.buttons.export")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["model-value"]))}},nr={__name:"LoadDataDialog",props:{modelValue:{type:Boolean,required:!0},error:{type:String,default:""}},emits:["update:modelValue","cancel","confirm"],setup(e,{emit:t}){const{t:n}=T(),u=e,m=t,g=f(null),y=f("");function b(){m("cancel"),m("update:modelValue",!1)}function v(){g.value?m("confirm",g.value):y.value=n("loadDataDialog.validation.fileRequired")}return h((()=>u.modelValue),(e=>{e&&(g.value=null,y.value="")})),(t,u)=>(r(),a(ye,{"model-value":e.modelValue,"max-width":"500","onUpdate:modelValue":u[1]||(u[1]=e=>t.$emit("update:modelValue",e))},{default:o((()=>[l(he,null,{default:o((()=>[l(pe,{class:"headline"},{default:o((()=>[s(d(c(n)("loadDataDialog.title")),1)])),_:1}),u[6]||(u[6]=s()),l(fe,null,{default:o((()=>[i("p",null,d(c(n)("loadDataDialog.instruction")),1),u[2]||(u[2]=s()),l(Pe,{modelValue:g.value,"onUpdate:modelValue":u[0]||(u[0]=e=>g.value=e),label:c(n)("loadDataDialog.labels.fileInput"),accept:".json","prepend-icon":"mdi-file-import","show-size":"","truncate-length":"30","error-messages":y.value},null,8,["modelValue","label","error-messages"]),u[3]||(u[3]=s()),e.error?(r(),a(me,{key:0,type:"error",class:"mt-2"},{default:o((()=>[s(d(e.error),1)])),_:1})):p("",!0)])),_:1}),u[7]||(u[7]=s()),l(ge,null,{default:o((()=>[l(H),u[4]||(u[4]=s()),l(B,{text:"",onClick:b},{default:o((()=>[s(d(c(n)("loadDataDialog.buttons.cancel")),1)])),_:1}),u[5]||(u[5]=s()),l(B,{color:"primary",text:"",onClick:v,disabled:!g.value},{default:o((()=>[s(d(c(n)("loadDataDialog.buttons.import")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1},8,["model-value"]))}};function ar(e){return"string"==typeof e&&e.trim().length>0}function rr(e){const t={};let n=!0;var a;return ar(e.firstName)||(t.firstName="validation.required.firstName",n=!1),ar(e.lastName)||(t.lastName="validation.required.lastName",n=!1),function(e){if(!e)return!1;if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const t=new Date(e);if(isNaN(t.getTime()))return!1;const n=new Date;return n.setHours(0,0,0,0),t<=n}(e.birthdate)||(e.birthdate?t.birthdate="validation.invalid.birthdate":t.birthdate="validation.required.birthdate",n=!1),ar(e.sex)||(t.sex="validation.required.sex",n=!1),ar(e.insurance)||(t.insurance="validation.required.insurance",n=!1),ar(e.referrer)||(t.referrer="validation.required.referrer",n=!1),ar(e.diagnosis)||(t.diagnosis="validation.required.diagnosis",n=!1),e.email&&(a=e.email)&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)&&(t.email="validation.invalid.email",n=!1),{valid:n,errors:t}}function or(e){const t={};let n=!0;return Array.isArray(e)?(e.forEach(((e,a)=>{const r=`phenotypeData[${a}]`;let o=!0;e&&ar(e.id)?/^HP:\d{7}$/.test(e.id)||(t[`${r}.id`]="validation.invalid.hpoIdFormat",o=!1):(t[`${r}.id`]="validation.required.phenotypeId",o=!1),e&&ar(e.status)||(t[`${r}.status`]="validation.required.phenotypeStatus",o=!1),o||(n=!1)})),{valid:n,errors:t}):{valid:!0,errors:{}}}function ir(e){if(!e)return{valid:!1,errors:{general:"validation.general.missingData"},sections:{personalInfo:!1,selectedPanels:!1,category:!1,consent:!1}};const t=rr(e.personalInfo||{}),n=!0,a={},r=(e.category,{valid:!0,errors:{}}),o=or(e.phenotypeData||[]),i=(e.consent,{valid:!0,errors:{}}),l={};return Object.entries(t.errors).forEach((([e,t])=>{l[e]=t,l["personalInfo."+e]=t})),Object.entries(a).forEach((([e,t])=>{l[e]=t,l["selectedPanels."+e]=t})),Object.entries(r.errors).forEach((([e,t])=>{l[e]=t,l["category."+e]=t})),Object.entries(o.errors).forEach((([e,t])=>{e.startsWith("phenotypeData[")?l[e]=t:(l[e]=t,l["phenotypeData."+e]=t)})),Object.entries(i.errors).forEach((([e,t])=>{l[e]=t,l["consent."+e]=t})),{valid:t.valid&&n&&o.valid&&i.valid,errors:l,sections:{personalInfo:t.valid,selectedPanels:n,category:r.valid,phenotypeData:o.valid,consent:i.valid}}}const lr=_a("form",(()=>{const{patientData:t,updatePersonalInfo:a,updateSelectedPanels:r,updatePhenotypeData:o,updateCategory:i,updateConsent:l,resetPatientData:s,exportPatientData:d,isValid:c,validationErrors:u,sectionValidation:p,validateForm:h}=function(){const t=e({personalInfo:{firstName:"",lastName:"",birthdate:"",sex:"",insurance:"",insuranceId:"",referrer:"",diagnosis:""},selectedPanels:[],phenotypeData:[],category:"",consent:{dataProcessing:!1,incidentalFindings:!1}}),a=f(!1),r=e({touched:!1,results:ir(t),showErrors:!1}),o=n((()=>r.results.valid)),i=n((()=>r.results.errors)),l=n((()=>r.results.sections));function s(e=!1){return r.touched=!0,r.showErrors=e,r.results=ir(t),r.results.valid}function d(e){if(Object.assign(t.personalInfo,e),r.touched){const e=rr(t.personalInfo);return s(r.showErrors),e}return{valid:!0,errors:{}}}function c(e){if(t.selectedPanels=[...e],r.touched){const e=(t.selectedPanels,{valid:!0,errors:{}});return s(r.showErrors),e}return{valid:!0,errors:{}}}function u(e){if(t.phenotypeData=[...e],r.touched){const e=or(t.phenotypeData);return s(r.showErrors),e}return{valid:!0,errors:{}}}function p(e){if(t.category=e,r.touched){const e=(t.category,{valid:!0,errors:{}});return s(r.showErrors),e}return{valid:!0,errors:{}}}function h(e){if(Object.assign(t.consent,e),r.touched){const e=(t.consent,{valid:!0,errors:{}});return s(r.showErrors),e}return{valid:!0,errors:{}}}function m(){const e={personalInfo:{firstName:"",lastName:"",birthdate:"",sex:"",insurance:"",insuranceId:"",referrer:"",diagnosis:""},selectedPanels:[],phenotypeData:[],category:"",consent:{dataProcessing:!1,incidentalFindings:!1}};Object.keys(e).forEach((n=>{t[n]=e[n]})),a.value=!1,r.touched=!1,r.showErrors=!1,r.results=ir(t)}return{patientData:t,initializedFromUrl:a,updatePersonalInfo:d,updateSelectedPanels:c,updatePhenotypeData:u,updateCategory:p,updateConsent:h,resetPatientData:m,initializeFromExternalData:function(e,n=!1){if(n)m(),e.personalInfo&&d(e.personalInfo),e.selectedPanels&&c(e.selectedPanels),e.phenotypeData&&u(e.phenotypeData),e.category&&p(e.category),e.consent&&h(e.consent);else{const n=function(e,t){const n=JSON.parse(JSON.stringify(e));return t.personalInfo&&Object.entries(t.personalInfo).forEach((([e,t])=>{null!=t&&""!==t&&(n.personalInfo[e]=t)})),t.selectedPanels&&t.selectedPanels.length>0&&(n.selectedPanels=[...t.selectedPanels]),t.phenotypeData&&t.phenotypeData.length>0&&(n.phenotypeData=[...t.phenotypeData]),t.category&&(n.category=t.category),t.consent&&Object.entries(t.consent).forEach((([e,t])=>{void 0!==t&&(n.consent[e]=t)})),n}(t,e);d(n.personalInfo),c(n.selectedPanels),u(n.phenotypeData),p(n.category),h(n.consent)}a.value=!0},exportPatientData:function(){return JSON.parse(JSON.stringify(t))},isValid:o,validationErrors:i,sectionValidation:l,validateForm:s,getFieldErrors:function(e){if(!r.showErrors)return{};const t={},n="personalInfo"===e?"personalInfo.":"";return Object.entries(r.results.errors).forEach((([a,r])=>{if(a.startsWith(n)){const e=a.replace(n,"");t[e]=r}else"root"!==e||a.includes(".")||(t[a]=r)})),t}}}(),m=f({}),g=f(!1),y=f(""),b=f(!1),v=n((()=>`requiform-data-${(new Date).toISOString().split("T")[0]}.json`));function w(){ze.debug("Syncing legacy → unified data model"),a({firstName:t.personalInfo.givenName||t.personalInfo.firstName||"",lastName:t.personalInfo.familyName||t.personalInfo.lastName||"",birthdate:t.personalInfo.birthdate||"",sex:t.personalInfo.sex||"",insurance:t.personalInfo.insurance||"",referrer:t.personalInfo.physicianName||t.personalInfo.referrer||"",diagnosis:t.personalInfo.diagnosis||""}),o(m.value?Object.values(m.value):[]);const e=t.category||t.personalInfo.category||"";e&&(ze.debug("Syncing category:",e),i(e))}function D(){if(ze.debug("Syncing unified → legacy data model"),t.personalInfo.givenName=t.personalInfo.firstName||"",t.personalInfo.familyName=t.personalInfo.lastName||"",t.personalInfo.birthdate=t.personalInfo.birthdate||"",t.personalInfo.sex=t.personalInfo.sex||"",t.personalInfo.insurance=t.personalInfo.insurance||"",t.personalInfo.physicianName=t.personalInfo.referrer||"",t.personalInfo.diagnosis=t.personalInfo.diagnosis||"",t.category?t.personalInfo.category=t.category:t.personalInfo.category&&(t.category=t.personalInfo.category),t.phenotypeData&&t.phenotypeData.length>0){const e={};t.phenotypeData.forEach((t=>{t.id&&(e[t.id]=t)})),m.value=e}t.personalInfo={...t.personalInfo}}function x(e){m.value={...e},w()}function S(e){g.value=e}function P(){s(),m.value={},g.value=!1,y.value="",b.value=!1}function k(e){return e?Object.values(e).filter((e=>e&&e.id)):[]}return{patientData:t,isValid:c,validationErrors:u,sectionValidation:p,phenotypeDataObj:m,showPedigree:g,pedigreeDataUrl:y,showValidation:b,saveDataName:v,validateForm:function(e=!0){return b.value=e,h(e)},updateConsent:l,getFieldErrors:(e=null)=>{if(!b.value||!u.value)return{};if(!e)return u.value;const t={};return Object.entries(u.value).forEach((([n,a])=>{if(n.startsWith(e+".")){const r=n.substring(e.length+1);t[r]=a}else if(!n.includes(".")){const r=`${e}.${n}`;u.value[r]&&(t[n]=a)}})),t},updatePatientData:function(e){Object.assign(t.personalInfo,e),w()},updatePhenotypeDataObj:x,updatePedigreeDataUrl:function(e){y.value=e},setShowPedigree:S,resetValidation:function(){b.value=!1},setShowValidation:function(e=!0){b.value=e},resetForm:P,syncUnifiedPatientData:w,syncLegacyPatientData:D,exportFormData:function(){w();const e=t.category||"";return{patientData:d(),selectedPanels:t.selectedPanels||[],phenotypeData:k(m.value),showPedigree:g.value,category:e}},importFormData:function(e,t=!0){if(ze.debug("formStore: Starting importFormData",{data:JSON.stringify(e).substring(0,200)+"...",overwrite:t}),!e||"object"!=typeof e)return ze.error("formStore: Invalid input data for import.",e),!1;try{t&&(ze.debug("formStore: Resetting form before import (overwrite=true)"),P());const n=e.patientData&&"object"==typeof e.patientData?e.patientData:e;ze.debug("formStore: Determined sourcePatientData for import.",n);const o={},l=n.personalInfo&&"object"==typeof n.personalInfo?n.personalInfo:{},s=["firstName","lastName","birthdate","sex","insurance","referrer","diagnosis"];!l.firstName&&l.givenName&&(l.firstName=l.givenName),!l.lastName&&l.familyName&&(l.lastName=l.familyName),!l.referrer&&l.physicianName&&(l.referrer=l.physicianName),s.forEach((e=>{l[e]&&"string"==typeof l[e]?o[e]=l[e].substring(0,1e3):o[e]=""})),ze.debug("formStore: Mapped newPersonalInfo:",o),a(o);let d="";e.category&&"string"==typeof e.category?d=e.category:n.category&&"string"==typeof n.category?d=n.category:l.category&&"string"==typeof l.category&&(d=l.category),!d&&e.selectedTests&&e.selectedTests.includes("nephronophthise")&&(d="nephrology"),d&&(ze.debug("formStore: Setting category:",d.substring(0,100)),i(d.substring(0,100)));let c=[];if(Array.isArray(n.selectedPanels)?c=n.selectedPanels:Array.isArray(e.selectedTests)&&(c=e.selectedTests),c.length>0){const e=c.filter((e=>"string"==typeof e)).map((e=>e.substring(0,100)));ze.debug("formStore: Setting selected panels:",e),r(e)}let u=null;if(n.phenotypeData?u=n.phenotypeData:e.phenotypeData&&(u=e.phenotypeData),u){const e={};Array.isArray(u)?(ze.debug("formStore: Importing phenotype data from ARRAY format"),u.forEach((t=>{if(t&&"object"==typeof t&&t.id&&"string"==typeof t.id){let n="no_input";"string"==typeof t.status&&["present","absent"].includes(t.status.toLowerCase())&&(n=t.status.toLowerCase()),e[t.id.substring(0,50)]={id:t.id.substring(0,50),label:"string"==typeof t.label?t.label.substring(0,200):"",status:n}}}))):"object"==typeof u&&(ze.debug("formStore: Importing phenotype data from OBJECT format"),Object.entries(u).forEach((([t,n])=>{if(n&&"object"==typeof n&&t&&"string"==typeof t){let a="no_input";"string"==typeof n.status&&["present","absent"].includes(n.status.toLowerCase())&&(a=n.status.toLowerCase()),e[t.substring(0,50)]={id:t.substring(0,50),label:"string"==typeof n.label?n.label.substring(0,200):"",status:a}}}))),ze.debug("formStore: Setting phenotype data object:",e),x(e)}return"boolean"==typeof e.showPedigree&&(ze.debug("formStore: Setting show pedigree:",e.showPedigree),S(e.showPedigree)),ze.debug("formStore: Synchronizing data models post-import"),w(),D(),ze.info("formStore: Data import successful."),!0}catch(n){return ze.error("formStore: Error during importFormData:",n),!1}},convertPhenotypeDataToUnifiedFormat:k}})),sr=_a("settings",(()=>{const e=f("true"===localStorage.getItem("disclaimerAcknowledged")),t=f(localStorage.getItem("acknowledgmentTime")||"");return{disclaimerAcknowledged:e,acknowledgmentTime:t,acknowledgeDisclaimer:function(){const n=(new Date).toISOString().split("T")[0];e.value=!0,t.value=n,localStorage.setItem("disclaimerAcknowledged","true"),localStorage.setItem("acknowledgmentTime",n)},resetDisclaimerAcknowledgment:function(){e.value=!1,t.value="",localStorage.removeItem("disclaimerAcknowledged"),localStorage.removeItem("acknowledgmentTime")}}}));function dr(){!function(){try{const e=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState(null,document.title,e),(window.location.search||window.location.hash)&&(ze.warn("First attempt to clear parameters failed, trying alternate method..."),window.location.hash&&history.pushState("",document.title,window.location.pathname+window.location.search),window.location.search&&history.pushState("",document.title,window.location.pathname),window.history.replaceState(null,document.title,e)),ze.debug("URL parameters cleared successfully")}catch(e){ze.error("Error clearing URL parameters:",e);const t=window.location.protocol+"//"+window.location.host+window.location.pathname;window.location.href!==t&&(window.location.href=t)}}()}const cr="AES-GCM";async function ur(e,t){const n=(new TextEncoder).encode(e),a=await crypto.subtle.importKey("raw",n,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return await crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},a,{name:cr,length:256},!1,["encrypt","decrypt"])}const pr=102400;function fr(){const e=f(""),t=Ca(),n=lr();function a(e){if(window.location.hash&&window.location.hash.length>1){const t=new URLSearchParams(window.location.hash.substring(1));if(t.has(e)){const n=window.location.hash.substring(1).split("&");for(const t of n){const[n,a]=t.split("=");if(n===e)return a}return t.get(e)}}return null}function r(){try{const e=o(n.exportFormData());ze.debug("Creating URL with compact data format");const a=JSON.stringify(e),r=`${window.location.protocol+"//"+window.location.host+window.location.pathname}#data=${encodeURIComponent(a)}`;return ze.debug(`Generated URL length: ${r.length} characters`),r.length>2e3&&(ze.warn(`[URL Handler] Generated plain data URL length (${r.length}) exceeds 2000 characters. This may cause issues in some browsers or tools.`),t.showSnackbar("Warning: Generated URL is very long and might not work everywhere.","warning",{timeout:7e3})),r}catch(e){return ze.error("Error creating shareable URL:",e),t.showSnackbar("Error creating shareable URL."),window.location.href}}function o(e){if(null==e||"object"!=typeof e)return e;if(Array.isArray(e))return e.filter((e=>{if("object"!=typeof e)return!0;const t=o(e);return Object.keys(t).length>0})).map((e=>o(e)));const t={};for(const[n,a]of Object.entries(e))if(null!=a&&""!==a&&(!Array.isArray(a)||0!==a.length))if("object"==typeof a){const e=o(a);Object.keys(e).length>0&&(t[n]=e)}else t[n]=a;return t}async function i(e){try{const a=n.exportFormData(),r={patientData:a.patientData,phenotypeData:a.phenotypeData,showPedigree:a.showPedigree},o=JSON.stringify(r);ze.debug(`JSON data length before encryption: ${o.length} characters`);const i=await async function(e,t){if(!t)throw ze.warn("encryptData called without a password."),new Error("Password is required for encryption.");if("string"!=typeof e)throw ze.warn("encryptData called with non-string input."),new Error("Input data must be a string.");try{const n=crypto.getRandomValues(new Uint8Array(16)),a=crypto.getRandomValues(new Uint8Array(12)),r=await ur(t,n),o=(new TextEncoder).encode(e),i=await crypto.subtle.encrypt({name:cr,iv:a},r,o),l=new Uint8Array(n.length+a.length+i.byteLength);return l.set(n,0),l.set(a,n.length),l.set(new Uint8Array(i),n.length+a.length),function(e){let t="";const n=new Uint8Array(e),a=n.byteLength;for(let o=0;o<a;o++)t+=String.fromCharCode(n[o]);try{return window.btoa(t)}catch(r){throw ze.error("Base64 encoding failed:",r),new Error("Failed to encode data to Base64.")}}(l.buffer).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(n){throw ze.error("Encryption failed:",n),new Error("Encryption process failed.")}}(o,e),l=`${window.location.protocol+"//"+window.location.host+window.location.pathname}#encrypted=${encodeURIComponent(i)}`;return ze.debug(`Encrypted URL (hash) length: ${l.length} characters`),l.length>2e3&&(ze.warn(`[URL Handler] Generated encrypted URL length (${l.length}) exceeds 2000 characters. This may cause issues in some browsers or tools.`),t.showSnackbar("Warning: Generated encrypted URL is very long and might not work everywhere.","warning",{timeout:7e3})),l}catch(a){throw t.showSnackbar("error",`Encryption failed: ${a.message||"Unknown error"}`),new Error("Failed to create encrypted URL.")}}async function l(e,n){if(!e||!n)return t.setDecryptionError("Missing data or password."),null;t.setDecryptionError(null);try{const t=await async function(e,t){if(!t)throw ze.warn("decryptData called without a password."),new Error("Password is required for decryption.");if("string"!=typeof e||0===e.length)throw ze.warn("decryptData called with invalid encrypted data input."),new Error("Invalid encrypted data provided.");if(e.length>10485760)throw new Error("Encrypted data exceeds maximum allowed size of 10MB.");let n;try{n=function(e){try{let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4;)t+="=";const n=window.atob(t),a=n.length,r=new Uint8Array(a);for(let e=0;e<a;e++)r[e]=n.charCodeAt(e);return r.buffer}catch(t){throw ze.error("Base64 decoding failed:",t),t instanceof DOMException&&"InvalidCharacterError"===t.name?new Error("Failed to decode Base64 data: Invalid characters detected."):new Error("Failed to decode Base64 data. It might be corrupted.")}}(e)}catch(r){throw ze.error("Base64 decoding failed during decryption attempt:",r),new Error("Decryption failed: Invalid data format.")}const a=new Uint8Array(n);if(a.length<28)throw ze.error(`Decryption failed: Data length (${a.length}) is less than minimum required (28).`),new Error("Decryption failed: Data appears incomplete or corrupted.");try{const e=a.slice(0,16),n=a.slice(16,28),r=a.slice(28),o=await ur(t,e),i=await crypto.subtle.decrypt({name:cr,iv:n},o,r);return(new TextDecoder).decode(i)}catch(r){throw ze.error("Decryption failed during crypto operation:",r),new Error("Decryption failed. Please check the password or the link may be corrupted.")}}(e,n),a=JSON.parse(t);if(Me(a),"object"!=typeof a||null===a||!a.patientData||!a.phenotypeData)throw new Error("Decrypted data has an invalid structure.");return a}catch(a){return t.setDecryptionError(a.message||"Decryption failed. Check password or link."),null}}const s=async a=>{if(e.value&&a){ze.debug("Password submitted. Attempting decryption.");const r=await l(e.value,a);r?(ze.debug("Decryption successful, importing data."),n.importFormData(r,!0),e.value=null,dr(),t.cancelDecryption(),t.showSnackbar("Data decrypted and loaded successfully!")):ze.warn("Decryption attempt failed with submitted password.")}else ze.warn("Password submission handler called without pending encrypted data or password.")};return{pendingEncryptedValue:e,initializeFromUrl:async function(){if(window.location.href.length>20480)return ze.warn(`[URL Handler] Incoming URL length (${window.location.href.length}) exceeds maximum allowed (20480). Aborting initialization.`),void t.showSnackbar("Error: URL is too long to process.","error");const r=a("data"),o=a("encrypted");if(r){if(r.length>pr)return ze.warn(`[URL Handler] Incoming 'data' parameter length (${r.length}) exceeds maximum allowed (102400). Aborting processing.`),t.showSnackbar("Error: Input data is too large.","error"),void dr();ze.debug('Found "data" parameter in URL hash.');try{const e=decodeURIComponent(r);if(e.length>pr)return ze.warn(`[URL Handler] Incoming 'data' parameter length (${e.length}) exceeds maximum allowed (102400). Aborting processing.`),t.showSnackbar("Error: Input data is too large.","error"),void dr();let a=JSON.parse(e);a=Me(a),ze.debug('Sanitized JSON data from "data" parameter.'),n.importFormData(a,!0),dr(),t.showSnackbar("Data loaded successfully from URL!")}catch(i){ze.error('Error processing "data" parameter from URL:',i),t.showSnackbar("Error loading data from URL. The data might be corrupted.","error"),dr()}}else if(o){if(o.length>pr)return ze.warn(`[URL Handler] Incoming 'encrypted' parameter length (${o.length}) exceeds maximum allowed (102400). Aborting decryption.`),t.showSnackbar("Error: Encrypted data is too large.","error"),void dr();ze.debug('Found "encrypted" parameter in URL hash. Prompting for password.');const n=o,r=a("password");r?(ze.debug("Found password parameter. Attempting direct decryption."),await s(r)):(ze.debug("Password not found in URL. Showing password dialog."),t.openDecryptionDialog(),e.value=n)}else{const e=function(){var e;try{if(function(e){const t=new URLSearchParams(window.location.search);if(t.has(e))return t.get(e);if(window.location.hash&&window.location.hash.length>1){const t=new URLSearchParams(window.location.hash.substring(1));if(t.has(e))return t.get(e)}return null}("encrypted"))return{};let n={},a=!1;const r=new URLSearchParams(window.location.search);if(r.toString()){ze.debug("Found query parameters:",window.location.search);for(const[e,t]of r.entries())if("encrypted"!==e)try{n[e]=JSON.parse(decodeURIComponent(t)),a=!0}catch{n[e]=decodeURIComponent(t),a=!0}}if(window.location.hash&&window.location.hash.length>1){const r=new URLSearchParams(window.location.hash.substring(1)),o=r.get("data");if(o)try{const t=JSON.parse(decodeURIComponent(o));if("object"==typeof t){if(ze.debug("Found JSON data in URL hash:",t),t.patientData&&t.patientData.selectedPanels?(ze.debug("Hash data contains nested selectedPanels:",t.patientData.selectedPanels),t.selectedTests||(t.selectedTests=[...t.patientData.selectedPanels],ze.debug("Added top-level selectedTests from nested data:",t.selectedTests))):t.selectedTests&&!(null==(e=t.patientData)?void 0:e.selectedPanels)&&(t.patientData||(t.patientData={}),t.patientData.selectedPanels=[...t.selectedTests],ze.debug("Added nested selectedPanels from top-level data:",t.patientData.selectedPanels)),t.phenotypeData){if(t.patientData&&!t.patientData.phenotypeData&&(t.patientData.phenotypeData=Array.isArray(t.phenotypeData)?[...t.phenotypeData]:[t.phenotypeData],ze.debug("Added nested phenotypeData from top-level:",t.patientData.phenotypeData)),t.category&&"object"==typeof t.phenotypeData&&!Array.isArray(t.phenotypeData)&&!t.phenotypeData[t.category]&&Object.keys(t.phenotypeData).length>0){const e={};e[t.category]=t.phenotypeData,t.phenotypeData=e,ze.debug("Categorized phenotype data by category:",t.category)}}else if(t.patientData&&t.patientData.phenotypeData&&Array.isArray(t.patientData.phenotypeData)){const e=t.patientData.phenotypeData[0]||{};if(t.category){const n={};n[t.category]=e,t.phenotypeData=n}else t.phenotypeData=e;ze.debug("Added top-level phenotypeData from nested array:",t.phenotypeData)}return t}}catch(t){ze.error("Error parsing JSON data from URL:",t)}for(const[e,t]of r.entries())if("data"!==e)try{n[e]=JSON.parse(decodeURIComponent(t)),a=!0}catch{n[e]=decodeURIComponent(t),a=!0}}return n.personalInfo||n.phenotypeData||n.selectedPanels?n:a?(ze.debug("Converting legacy format data:",n),{personalInfo:{firstName:n.givenName||"",lastName:n.familyName||"",birthdate:n.birthdate||"",sex:n.sex||"",diagnosis:n.diagnosis||"",insurance:n.insurance||"",referrer:n.physicianName||""},selectedPanels:Array.isArray(n.selectedTests)?n.selectedTests:n.selectedPanels?[n.selectedPanels]:[],phenotypeData:n.phenotypeData||[],category:n.category||""}):{}}catch(i){return ze.error("Error parsing URL parameters:",i),{}}}();Object.keys(e).length>0?(ze.debug("Found legacy query parameters. Importing..."),n.importFormData(e,!0),dr(),t.showSnackbar("Legacy data loaded successfully from URL!")):ze.debug("No relevant data parameters found in URL.")}},createShareableUrl:r,copyShareableUrl:async function(){try{const e=r();return await navigator.clipboard.writeText(e),t.showSnackbar("URL copied to clipboard!"),!0}catch(e){return ze.error("Error copying URL to clipboard:",e),t.showSnackbar("Error copying URL to clipboard."),!1}},createEncryptedUrl:i,copyEncryptedUrl:async function(e){try{const n=await i(e);return!!n&&(await navigator.clipboard.writeText(n),t.showSnackbar("Encrypted URL copied to clipboard!"),!0)}catch(n){return!1}},decryptUrlData:l,handlePasswordSubmit:s}}function hr(e){return e instanceof HTMLElement}function mr(e){return"function"==typeof e}function gr(e){return"string"==typeof e}function yr(e){return void 0===e}class br{on(e,t,n,a=!1){var r;return yr(this.bindings)&&(this.bindings={}),yr(this.bindings[e])&&(this.bindings[e]=[]),null==(r=this.bindings[e])||r.push({handler:t,ctx:n,once:a}),this}once(e,t,n){return this.on(e,t,n,!0)}off(e,t){return yr(this.bindings)||yr(this.bindings[e])||(yr(t)?delete this.bindings[e]:null==(n=this.bindings[e])||n.forEach(((n,a)=>{var r;n.handler===t&&(null==(r=this.bindings[e])||r.splice(a,1))}))),this;var n}trigger(e,...t){var n;return!yr(this.bindings)&&this.bindings[e]&&(null==(n=this.bindings[e])||n.forEach(((n,a)=>{const{ctx:r,handler:o,once:i}=n,l=r||this;var s;o.apply(l,t),i&&(null==(s=this.bindings[e])||s.splice(a,1))}))),this}}function vr(){return vr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},vr.apply(null,arguments)}function wr(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.includes(a))continue;n[a]=e[a]}return n}const Dr={defaultMerge:Symbol("deepmerge-ts: default merge"),skip:Symbol("deepmerge-ts: skip")};function xr(e,t){return t}function Sr(e,t){return e.filter((e=>void 0!==e))}var Pr,kr;function _r(e){return"object"!=typeof e||null===e?0:Array.isArray(e)?2:function(e){if(!Ar.has(Object.prototype.toString.call(e)))return!1;const{constructor:t}=e;if(void 0===t)return!0;const n=t.prototype;return!(null===n||"object"!=typeof n||!Ar.has(Object.prototype.toString.call(n)))&&!!n.hasOwnProperty("isPrototypeOf")}(e)?1:e instanceof Set?3:e instanceof Map?4:5}function Cr(e){return{*[Symbol.iterator](){for(const t of e)for(const e of t)yield e}}}(kr=Pr||(Pr={}))[kr.NOT=0]="NOT",kr[kr.RECORD=1]="RECORD",kr[kr.ARRAY=2]="ARRAY",kr[kr.SET=3]="SET",kr[kr.MAP=4]="MAP",kr[kr.OTHER=5]="OTHER";const Ar=new Set(["[object Object]","[object Module]"]),Ir={mergeRecords:function(e,t,n){const a={};for(const i of function(e){const t=new Set;for(const n of e)for(const e of[...Object.keys(n),...Object.getOwnPropertySymbols(n)])t.add(e);return t}(e)){const l=[];for(const t of e)o=i,"object"==typeof(r=t)&&Object.prototype.propertyIsEnumerable.call(r,o)&&l.push(t[i]);if(0===l.length)continue;const s=t.metaDataUpdater(n,{key:i,parents:e}),d=Er(l,t,s);d!==Dr.skip&&("__proto__"===i?Object.defineProperty(a,i,{value:d,configurable:!0,enumerable:!0,writable:!0}):a[i]=d)}var r,o;return a},mergeArrays:function(e){return e.flat()},mergeSets:function(e){return new Set(Cr(e))},mergeMaps:function(e){return new Map(Cr(e))},mergeOthers:function(e){return e.at(-1)}};function Fr(...e){return function(){const e=function(e,t){var n,a,r;return{defaultMergeFunctions:Ir,mergeFunctions:vr({},Ir,Object.fromEntries(Object.entries(e).filter((([e,t])=>Object.hasOwn(Ir,e))).map((([e,t])=>!1===t?[e,Ir.mergeOthers]:[e,t])))),metaDataUpdater:null!=(n=e.metaDataUpdater)?n:xr,deepmerge:t,useImplicitDefaultMerging:null!=(a=e.enableImplicitDefaultMerging)&&a,filterValues:!1===e.filterValues?void 0:null!=(r=e.filterValues)?r:Sr,actions:Dr}}({},t);function t(...t){return Er(t,e,undefined)}return t}()(...e)}function Er(e,t,n){var a;const r=null!=(a=null==t.filterValues?void 0:t.filterValues(e,n))?a:e;if(0===r.length)return;if(1===r.length)return Nr(r,t,n);const o=_r(r[0]);if(0!==o&&5!==o)for(let i=1;i<r.length;i++)if(_r(r[i])!==o)return Nr(r,t,n);switch(o){case 1:return function(e,t,n){const a=t.mergeFunctions.mergeRecords(e,t,n);return a===Dr.defaultMerge||t.useImplicitDefaultMerging&&void 0===a&&t.mergeFunctions.mergeRecords!==t.defaultMergeFunctions.mergeRecords?t.defaultMergeFunctions.mergeRecords(e,t,n):a}(r,t,n);case 2:return function(e,t,n){const a=t.mergeFunctions.mergeArrays(e,t,n);return a===Dr.defaultMerge||t.useImplicitDefaultMerging&&void 0===a&&t.mergeFunctions.mergeArrays!==t.defaultMergeFunctions.mergeArrays?t.defaultMergeFunctions.mergeArrays(e):a}(r,t,n);case 3:return function(e,t,n){const a=t.mergeFunctions.mergeSets(e,t,n);return a===Dr.defaultMerge||t.useImplicitDefaultMerging&&void 0===a&&t.mergeFunctions.mergeSets!==t.defaultMergeFunctions.mergeSets?t.defaultMergeFunctions.mergeSets(e):a}(r,t,n);case 4:return function(e,t,n){const a=t.mergeFunctions.mergeMaps(e,t,n);return a===Dr.defaultMerge||t.useImplicitDefaultMerging&&void 0===a&&t.mergeFunctions.mergeMaps!==t.defaultMergeFunctions.mergeMaps?t.defaultMergeFunctions.mergeMaps(e):a}(r,t,n);default:return Nr(r,t,n)}}function Nr(e,t,n){const a=t.mergeFunctions.mergeOthers(e,t,n);return a===Dr.defaultMerge||t.useImplicitDefaultMerging&&void 0===a&&t.mergeFunctions.mergeOthers!==t.defaultMergeFunctions.mergeOthers?t.defaultMergeFunctions.mergeOthers(e):a}function Lr(e){const t=Object.getOwnPropertyNames(e.constructor.prototype);for(let n=0;n<t.length;n++){const a=t[n],r=e[a];"constructor"!==a&&"function"==typeof r&&(e[a]=r.bind(e))}return e}function Or(e){return gr(e)&&""!==e?"-"!==e.charAt(e.length-1)?`${e}-`:e:""}function Vr(e){return null==e||!e.element||!e.on}function Tr(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}const Rr=["start","end"],zr=["top","right","bottom","left"].reduce(((e,t)=>e.concat(t,t+"-"+Rr[0],t+"-"+Rr[1])),[]),Mr=Math.min,Ur=Math.max,qr=Math.round,Hr=Math.floor,Br=e=>({x:e,y:e}),$r={left:"right",right:"left",bottom:"top",top:"bottom"},jr={start:"end",end:"start"};function Gr(e,t,n){return Ur(e,Mr(t,n))}function Jr(e,t){return"function"==typeof e?e(t):e}function Kr(e){return e.split("-")[0]}function Wr(e){return e.split("-")[1]}function Qr(e){return"x"===e?"y":"x"}function Zr(e){return"y"===e?"height":"width"}function Yr(e){return["top","bottom"].includes(Kr(e))?"y":"x"}function Xr(e){return Qr(Yr(e))}function eo(e,t,n){void 0===n&&(n=!1);const a=Wr(e),r=Xr(e),o=Zr(r);let i="x"===r?a===(n?"end":"start")?"right":"left":"start"===a?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=no(i)),[i,no(i)]}function to(e){return e.replace(/start|end/g,(e=>jr[e]))}function no(e){return e.replace(/left|right|bottom|top/g,(e=>$r[e]))}function ao(e){return"number"!=typeof e?function(e){return vr({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function ro(e){const{x:t,y:n,width:a,height:r}=e;return{width:a,height:r,top:n,left:t,right:t+a,bottom:n+r,x:t,y:n}}const oo=["crossAxis","alignment","allowedPlacements","autoAlignment"],io=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],lo=["mainAxis","crossAxis","limiter"];function so(e,t,n){let{reference:a,floating:r}=e;const o=Yr(t),i=Xr(t),l=Zr(i),s=Kr(t),d="y"===o,c=a.x+a.width/2-r.width/2,u=a.y+a.height/2-r.height/2,p=a[l]/2-r[l]/2;let f;switch(s){case"top":f={x:c,y:a.y-r.height};break;case"bottom":f={x:c,y:a.y+a.height};break;case"right":f={x:a.x+a.width,y:u};break;case"left":f={x:a.x-r.width,y:u};break;default:f={x:a.x,y:a.y}}switch(Wr(t)){case"start":f[i]-=p*(n&&d?-1:1);break;case"end":f[i]+=p*(n&&d?-1:1)}return f}async function co(e,t){var n;void 0===t&&(t={});const{x:a,y:r,platform:o,rects:i,elements:l,strategy:s}=e,{boundary:d="clippingAncestors",rootBoundary:c="viewport",elementContext:u="floating",altBoundary:p=!1,padding:f=0}=Jr(t,e),h=ao(f),m=l[p?"floating"===u?"reference":"floating":u],g=ro(await o.getClippingRect({element:null==(n=await(null==o.isElement?void 0:o.isElement(m)))||n?m:m.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(l.floating)),boundary:d,rootBoundary:c,strategy:s})),y="floating"===u?{x:a,y:r,width:i.floating.width,height:i.floating.height}:i.reference,b=await(null==o.getOffsetParent?void 0:o.getOffsetParent(l.floating)),v=await(null==o.isElement?void 0:o.isElement(b))&&await(null==o.getScale?void 0:o.getScale(b))||{x:1,y:1},w=ro(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:y,offsetParent:b,strategy:s}):y);return{top:(g.top-w.top+h.top)/v.y,bottom:(w.bottom-g.bottom+h.bottom)/v.y,left:(g.left-w.left+h.left)/v.x,right:(w.right-g.right+h.right)/v.x}}function uo(){return"undefined"!=typeof window}function po(e){return mo(e)?(e.nodeName||"").toLowerCase():"#document"}function fo(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function ho(e){var t;return null==(t=(mo(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function mo(e){return!!uo()&&(e instanceof Node||e instanceof fo(e).Node)}function go(e){return!!uo()&&(e instanceof Element||e instanceof fo(e).Element)}function yo(e){return!!uo()&&(e instanceof HTMLElement||e instanceof fo(e).HTMLElement)}function bo(e){return!(!uo()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof fo(e).ShadowRoot)}function vo(e){const{overflow:t,overflowX:n,overflowY:a,display:r}=ko(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+n)&&!["inline","contents"].includes(r)}function wo(e){return["table","td","th"].includes(po(e))}function Do(e){return[":popover-open",":modal"].some((t=>{try{return e.matches(t)}catch(n){return!1}}))}function xo(e){const t=So(),n=go(e)?ko(e):e;return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function So(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function Po(e){return["html","body","#document"].includes(po(e))}function ko(e){return fo(e).getComputedStyle(e)}function _o(e){return go(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Co(e){if("html"===po(e))return e;const t=e.assignedSlot||e.parentNode||bo(e)&&e.host||ho(e);return bo(t)?t.host:t}function Ao(e){const t=Co(e);return Po(t)?e.ownerDocument?e.ownerDocument.body:e.body:yo(t)&&vo(t)?t:Ao(t)}function Io(e,t,n){var a;void 0===t&&(t=[]),void 0===n&&(n=!0);const r=Ao(e),o=r===(null==(a=e.ownerDocument)?void 0:a.body),i=fo(r);if(o){const e=Fo(i);return t.concat(i,i.visualViewport||[],vo(r)?r:[],e&&n?Io(e):[])}return t.concat(r,Io(r,[],n))}function Fo(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Eo(e){const t=ko(e);let n=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const r=yo(e),o=r?e.offsetWidth:n,i=r?e.offsetHeight:a,l=qr(n)!==o||qr(a)!==i;return l&&(n=o,a=i),{width:n,height:a,$:l}}function No(e){return go(e)?e:e.contextElement}function Lo(e){const t=No(e);if(!yo(t))return Br(1);const n=t.getBoundingClientRect(),{width:a,height:r,$:o}=Eo(t);let i=(o?qr(n.width):n.width)/a,l=(o?qr(n.height):n.height)/r;return i&&Number.isFinite(i)||(i=1),l&&Number.isFinite(l)||(l=1),{x:i,y:l}}const Oo=Br(0);function Vo(e){const t=fo(e);return So()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Oo}function To(e,t,n,a){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),o=No(e);let i=Br(1);t&&(a?go(a)&&(i=Lo(a)):i=Lo(e));const l=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==fo(e))&&t}(o,n,a)?Vo(o):Br(0);let s=(r.left+l.x)/i.x,d=(r.top+l.y)/i.y,c=r.width/i.x,u=r.height/i.y;if(o){const e=fo(o),t=a&&go(a)?fo(a):a;let n=e,r=Fo(n);for(;r&&a&&t!==n;){const e=Lo(r),t=r.getBoundingClientRect(),a=ko(r),o=t.left+(r.clientLeft+parseFloat(a.paddingLeft))*e.x,i=t.top+(r.clientTop+parseFloat(a.paddingTop))*e.y;s*=e.x,d*=e.y,c*=e.x,u*=e.y,s+=o,d+=i,n=fo(r),r=Fo(n)}}return ro({width:c,height:u,x:s,y:d})}function Ro(e,t){const n=_o(e).scrollLeft;return t?t.left+n:To(ho(e)).left+n}function zo(e,t,n){void 0===n&&(n=!1);const a=e.getBoundingClientRect();return{x:a.left+t.scrollLeft-(n?0:Ro(e,a)),y:a.top+t.scrollTop}}function Mo(e,t,n){let a;if("viewport"===t)a=function(e,t){const n=fo(e),a=ho(e),r=n.visualViewport;let o=a.clientWidth,i=a.clientHeight,l=0,s=0;if(r){o=r.width,i=r.height;const e=So();(!e||e&&"fixed"===t)&&(l=r.offsetLeft,s=r.offsetTop)}return{width:o,height:i,x:l,y:s}}(e,n);else if("document"===t)a=function(e){const t=ho(e),n=_o(e),a=e.ownerDocument.body,r=Ur(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),o=Ur(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let i=-n.scrollLeft+Ro(e);const l=-n.scrollTop;return"rtl"===ko(a).direction&&(i+=Ur(t.clientWidth,a.clientWidth)-r),{width:r,height:o,x:i,y:l}}(ho(e));else if(go(t))a=function(e,t){const n=To(e,!0,"fixed"===t),a=n.top+e.clientTop,r=n.left+e.clientLeft,o=yo(e)?Lo(e):Br(1);return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:r*o.x,y:a*o.y}}(t,n);else{const n=Vo(e);a={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return ro(a)}function Uo(e,t){const n=Co(e);return!(n===t||!go(n)||Po(n))&&("fixed"===ko(n).position||Uo(n,t))}function qo(e,t,n){const a=yo(t),r=ho(t),o="fixed"===n,i=To(e,!0,o,t);let l={scrollLeft:0,scrollTop:0};const s=Br(0);if(a||!a&&!o)if(("body"!==po(t)||vo(r))&&(l=_o(t)),a){const e=To(t,!0,o,t);s.x=e.x+t.clientLeft,s.y=e.y+t.clientTop}else r&&(s.x=Ro(r));const d=!r||a||o?Br(0):zo(r,l);return{x:i.left+l.scrollLeft-s.x-d.x,y:i.top+l.scrollTop-s.y-d.y,width:i.width,height:i.height}}function Ho(e){return"static"===ko(e).position}function Bo(e,t){if(!yo(e)||"fixed"===ko(e).position)return null;if(t)return t(e);let n=e.offsetParent;return ho(e)===n&&(n=n.ownerDocument.body),n}function $o(e,t){const n=fo(e);if(Do(e))return n;if(!yo(e)){let t=Co(e);for(;t&&!Po(t);){if(go(t)&&!Ho(t))return t;t=Co(t)}return n}let a=Bo(e,t);for(;a&&wo(a)&&Ho(a);)a=Bo(a,t);return a&&Po(a)&&Ho(a)&&!xo(a)?n:a||function(e){let t=Co(e);for(;yo(t)&&!Po(t);){if(xo(t))return t;if(Do(t))return null;t=Co(t)}return null}(e)||n}const jo={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:a,strategy:r}=e;const o="fixed"===r,i=ho(a),l=!!t&&Do(t.floating);if(a===i||l&&o)return n;let s={scrollLeft:0,scrollTop:0},d=Br(1);const c=Br(0),u=yo(a);if((u||!u&&!o)&&(("body"!==po(a)||vo(i))&&(s=_o(a)),yo(a))){const e=To(a);d=Lo(a),c.x=e.x+a.clientLeft,c.y=e.y+a.clientTop}const p=!i||u||o?Br(0):zo(i,s,!0);return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-s.scrollLeft*d.x+c.x+p.x,y:n.y*d.y-s.scrollTop*d.y+c.y+p.y}},getDocumentElement:ho,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:a,strategy:r}=e;const o=[..."clippingAncestors"===n?Do(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let a=Io(e,[],!1).filter((e=>go(e)&&"body"!==po(e))),r=null;const o="fixed"===ko(e).position;let i=o?Co(e):e;for(;go(i)&&!Po(i);){const t=ko(i),n=xo(i);n||"fixed"!==t.position||(r=null),(o?!n&&!r:!n&&"static"===t.position&&r&&["absolute","fixed"].includes(r.position)||vo(i)&&!n&&Uo(e,i))?a=a.filter((e=>e!==i)):r=t,i=Co(i)}return t.set(e,a),a}(t,this._c):[].concat(n),a],i=o[0],l=o.reduce(((e,n)=>{const a=Mo(t,n,r);return e.top=Ur(a.top,e.top),e.right=Mr(a.right,e.right),e.bottom=Mr(a.bottom,e.bottom),e.left=Ur(a.left,e.left),e}),Mo(t,i,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:$o,getElementRects:async function(e){const t=this.getOffsetParent||$o,n=this.getDimensions,a=await n(e.floating);return{reference:qo(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Eo(e);return{width:t,height:n}},getScale:Lo,isElement:go,isRTL:function(e){return"rtl"===ko(e).direction}};const Go=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:n,y:a,placement:r,rects:o,middlewareData:i}=t,{offset:l=0,mainAxis:s=!0,crossAxis:d=!0}=Jr(e,t),c={x:n,y:a},u=Yr(r),p=Qr(u);let f=c[p],h=c[u];const m=Jr(l,t),g="number"==typeof m?{mainAxis:m,crossAxis:0}:vr({mainAxis:0,crossAxis:0},m);if(s){const e="y"===p?"height":"width",t=o.reference[p]-o.floating[e]+g.mainAxis,n=o.reference[p]+o.reference[e]-g.mainAxis;f<t?f=t:f>n&&(f=n)}if(d){var y,b;const e="y"===p?"width":"height",t=["top","left"].includes(Kr(r)),n=o.reference[u]-o.floating[e]+(t&&(null==(y=i.offset)?void 0:y[u])||0)+(t?0:g.crossAxis),a=o.reference[u]+o.reference[e]+(t?0:(null==(b=i.offset)?void 0:b[u])||0)-(t?g.crossAxis:0);h<n?h=n:h>a&&(h=a)}return{[p]:f,[u]:h}}}};function Jo(e){e.cleanup&&e.cleanup();const t=e._getResolvedAttachToOptions();let n=t.element;const a=function(e,t){var n,a,r;const o={strategy:"absolute",middleware:[]},i=function(e){return!(!e.options.arrow||!e.el)&&e.el.querySelector(".shepherd-arrow")}(t),l=Vr(e),s=null==(n=e.on)?void 0:n.includes("auto"),d=(null==e||null==(a=e.on)?void 0:a.includes("-start"))||(null==e||null==(r=e.on)?void 0:r.includes("-end"));if(!l){var c;if(s?o.middleware.push(function(e){return void 0===e&&(e={}),{name:"autoPlacement",options:e,async fn(t){var n,a,r;const{rects:o,middlewareData:i,placement:l,platform:s,elements:d}=t,c=Jr(e,t),{crossAxis:u=!1,alignment:p,allowedPlacements:f=zr,autoAlignment:h=!0}=c,m=wr(c,oo),g=void 0!==p||f===zr?function(e,t,n){return(e?[...n.filter((t=>Wr(t)===e)),...n.filter((t=>Wr(t)!==e))]:n.filter((e=>Kr(e)===e))).filter((n=>!e||Wr(n)===e||!!t&&to(n)!==n))}(p||null,h,f):f,y=await co(t,m),b=(null==(n=i.autoPlacement)?void 0:n.index)||0,v=g[b];if(null==v)return{};const w=eo(v,o,await(null==s.isRTL?void 0:s.isRTL(d.floating)));if(l!==v)return{reset:{placement:g[0]}};const D=[y[Kr(v)],y[w[0]],y[w[1]]],x=[...(null==(a=i.autoPlacement)?void 0:a.overflows)||[],{placement:v,overflows:D}],S=g[b+1];if(S)return{data:{index:b+1,overflows:x},reset:{placement:S}};const P=x.map((e=>{const t=Wr(e.placement);return[e.placement,t&&u?e.overflows.slice(0,2).reduce(((e,t)=>e+t),0):e.overflows[0],e.overflows]})).sort(((e,t)=>e[1]-t[1])),k=(null==(r=P.filter((e=>e[2].slice(0,Wr(e[0])?2:3).every((e=>e<=0))))[0])?void 0:r[0])||P[0][0];return k!==l?{data:{index:b+1,overflows:x},reset:{placement:k}}:{}}}}({crossAxis:!0,alignment:d?null==e||null==(c=e.on)?void 0:c.split("-").pop():null})):o.middleware.push(function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,a;const{placement:r,middlewareData:o,rects:i,initialPlacement:l,platform:s,elements:d}=t,c=Jr(e,t),{mainAxis:u=!0,crossAxis:p=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0}=c,y=wr(c,io);if(null!=(n=o.arrow)&&n.alignmentOffset)return{};const b=Kr(r),v=Yr(l),w=Kr(l)===l,D=await(null==s.isRTL?void 0:s.isRTL(d.floating)),x=f||(w||!g?[no(l)]:function(e){const t=no(e);return[to(e),t,to(t)]}(l)),S="none"!==m;!f&&S&&x.push(...function(e,t,n,a){const r=Wr(e);let o=function(e,t,n){const a=["left","right"],r=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?r:a:t?a:r;case"left":case"right":return t?o:i;default:return[]}}(Kr(e),"start"===n,a);return r&&(o=o.map((e=>e+"-"+r)),t&&(o=o.concat(o.map(to)))),o}(l,g,m,D));const P=[l,...x],k=await co(t,y),_=[];let C=(null==(a=o.flip)?void 0:a.overflows)||[];if(u&&_.push(k[b]),p){const e=eo(r,i,D);_.push(k[e[0]],k[e[1]])}if(C=[...C,{placement:r,overflows:_}],!_.every((e=>e<=0))){var A,I;const e=((null==(A=o.flip)?void 0:A.index)||0)+1,t=P[e];if(t)return{data:{index:e,overflows:C},reset:{placement:t}};let n=null==(I=C.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:I.placement;if(!n)switch(h){case"bestFit":{var F;const e=null==(F=C.filter((e=>{if(S){const t=Yr(e.placement);return t===v||"y"===t}return!0})).map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:F[0];e&&(n=e);break}case"initialPlacement":n=l}if(r!==n)return{reset:{placement:n}}}return{}}}}()),o.middleware.push(function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:a,placement:r}=t,o=Jr(e,t),{mainAxis:i=!0,crossAxis:l=!1,limiter:s={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}}}=o,d=wr(o,lo),c={x:n,y:a},u=await co(t,d),p=Yr(Kr(r)),f=Qr(p);let h=c[f],m=c[p];if(i){const e="y"===f?"bottom":"right";h=Gr(h+u["y"===f?"top":"left"],h,h-u[e])}if(l){const e="y"===p?"bottom":"right";m=Gr(m+u["y"===p?"top":"left"],m,m-u[e])}const g=s.fn(vr({},t,{[f]:h,[p]:m}));return vr({},g,{data:{x:g.x-n,y:g.y-a}})}}}({limiter:Go(),crossAxis:!0})),i){const e="object"==typeof t.options.arrow?t.options.arrow:{padding:4};o.middleware.push((e=>({name:"arrow",options:e,async fn(t){const{x:n,y:a,placement:r,rects:o,platform:i,elements:l,middlewareData:s}=t,{element:d,padding:c=0}=Jr(e,t)||{};if(null==d)return{};const u=ao(c),p={x:n,y:a},f=Xr(r),h=Zr(f),m=await i.getDimensions(d),g="y"===f,y=g?"top":"left",b=g?"bottom":"right",v=g?"clientHeight":"clientWidth",w=o.reference[h]+o.reference[f]-p[f]-o.floating[h],D=p[f]-o.reference[f],x=await(null==i.getOffsetParent?void 0:i.getOffsetParent(d));let S=x?x[v]:0;S&&await(null==i.isElement?void 0:i.isElement(x))||(S=l.floating[v]||o.floating[h]);const P=w/2-D/2,k=S/2-m[h]/2-1,_=Mr(u[y],k),C=Mr(u[b],k),A=_,I=S-m[h]-C,F=S/2-m[h]/2+P,E=Gr(A,F,I),N=!s.arrow&&null!=Wr(r)&&F!==E&&o.reference[h]/2-(F<A?_:C)-m[h]/2<0,L=N?F<A?F-A:F-I:0;return{[f]:p[f]+L,data:vr({[f]:E,centerOffset:F-E-L},N&&{alignmentOffset:L}),reset:N}}}))({element:i,padding:d?e.padding:0}))}s||(o.placement=e.on)}return Fr(o,t.options.floatingUIOptions||{})}(t,e),r=Vr(t);return r&&(n=document.body,e.shepherdElementComponent.getElement().classList.add("shepherd-centered")),e.cleanup=function(e,t,n,a){void 0===a&&(a={});const{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:i="function"==typeof ResizeObserver,layoutShift:l="function"==typeof IntersectionObserver,animationFrame:s=!1}=a,d=No(e),c=r||o?[...d?Io(d):[],...Io(t)]:[];c.forEach((e=>{r&&e.addEventListener("scroll",n,{passive:!0}),o&&e.addEventListener("resize",n)}));const u=d&&l?function(e,t){let n,a=null;const r=ho(e);function o(){var e;clearTimeout(n),null==(e=a)||e.disconnect(),a=null}return function i(l,s){void 0===l&&(l=!1),void 0===s&&(s=1),o();const{left:d,top:c,width:u,height:p}=e.getBoundingClientRect();if(l||t(),!u||!p)return;const f={rootMargin:-Hr(c)+"px "+-Hr(r.clientWidth-(d+u))+"px "+-Hr(r.clientHeight-(c+p))+"px "+-Hr(d)+"px",threshold:Ur(0,Mr(1,s))||1};let h=!0;function m(e){const t=e[0].intersectionRatio;if(t!==s){if(!h)return i();t?i(!1,t):n=setTimeout((()=>{i(!1,1e-7)}),1e3)}h=!1}try{a=new IntersectionObserver(m,vr({},f,{root:r.ownerDocument}))}catch(g){a=new IntersectionObserver(m,f)}a.observe(e)}(!0),o}(d,n):null;let p,f=-1,h=null;i&&(h=new ResizeObserver((e=>{let[a]=e;a&&a.target===d&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame((()=>{var e;null==(e=h)||e.observe(t)}))),n()})),d&&!s&&h.observe(d),h.observe(t));let m=s?To(e):null;return s&&function t(){const a=To(e);!m||a.x===m.x&&a.y===m.y&&a.width===m.width&&a.height===m.height||n(),m=a,p=requestAnimationFrame(t)}(),n(),()=>{var e;c.forEach((e=>{r&&e.removeEventListener("scroll",n),o&&e.removeEventListener("resize",n)})),null==u||u(),null==(e=h)||e.disconnect(),h=null,s&&cancelAnimationFrame(p)}}(n,e.el,(()=>{e.el?function(e,t,n,a){((e,t,n)=>{const a=new Map,r=vr({platform:jo},n),o=vr({},r.platform,{_c:a});return(async(e,t,n)=>{const{placement:a="bottom",strategy:r="absolute",middleware:o=[],platform:i}=n,l=o.filter(Boolean),s=await(null==i.isRTL?void 0:i.isRTL(t));let d=await i.getElementRects({reference:e,floating:t,strategy:r}),{x:c,y:u}=so(d,a,s),p=a,f={},h=0;for(let m=0;m<l.length;m++){const{name:n,fn:o}=l[m],{x:g,y,data:b,reset:v}=await o({x:c,y:u,initialPlacement:a,placement:p,strategy:r,middlewareData:f,rects:d,platform:i,elements:{reference:e,floating:t}});c=null!=g?g:c,u=null!=y?y:u,f=vr({},f,{[n]:vr({},f[n],b)}),v&&h<=50&&(h++,"object"==typeof v&&(v.placement&&(p=v.placement),v.rects&&(d=!0===v.rects?await i.getElementRects({reference:e,floating:t,strategy:r}):v.rects),({x:c,y:u}=so(d,p,s))),m=-1)}return{x:c,y:u,placement:p,strategy:r,middlewareData:f}})(e,t,vr({},r,{platform:o}))})(e,t.el,n).then(function(e,t){return({x:n,y:a,placement:r,middlewareData:o})=>e.el?(t?Object.assign(e.el.style,{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}):Object.assign(e.el.style,{position:"absolute",left:`${n}px`,top:`${a}px`}),e.el.dataset.popperPlacement=r,function(e,t){const n=e.querySelector(".shepherd-arrow");if(hr(n)&&t.arrow){const{x:e,y:a}=t.arrow;Object.assign(n.style,{left:null!=e?`${e}px`:"",top:null!=a?`${a}px`:""})}}(e.el,o),e):e}(t,a)).then((e=>new Promise((t=>{setTimeout((()=>t(e)),300)})))).then((e=>{null!=e&&e.el&&e.el.focus({preventScroll:!0})}))}(n,e,a,r):null==e.cleanup||e.cleanup()})),e.target=t.element,a}function Ko(){}function Wo(e,t){for(const n in t)e[n]=t[n];return e}function Qo(e){return e()}function Zo(){return Object.create(null)}function Yo(e){e.forEach(Qo)}function Xo(e){return"function"==typeof e}function ei(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function ti(e,t){e.appendChild(t)}function ni(e,t,n){e.insertBefore(t,n||null)}function ai(e){e.parentNode&&e.parentNode.removeChild(e)}function ri(e){return document.createElement(e)}function oi(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function ii(e){return document.createTextNode(e)}function li(){return ii(" ")}function si(e,t,n,a){return e.addEventListener(t,n,a),()=>e.removeEventListener(t,n,a)}function di(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}const ci=["width","height"];function ui(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const a in t)null==t[a]?e.removeAttribute(a):"style"===a?e.style.cssText=t[a]:"__value"===a?e.value=e[a]=t[a]:n[a]&&n[a].set&&-1===ci.indexOf(a)?e[a]=t[a]:di(e,a,t[a])}function pi(e,t,n){e.classList.toggle(t,!!n)}let fi;function hi(e){fi=e}function mi(){if(!fi)throw new Error("Function called outside component initialization");return fi}function gi(e){mi().$$.after_update.push(e)}const yi=[],bi=[];let vi=[];const wi=[],Di=Promise.resolve();let xi=!1;function Si(e){vi.push(e)}const Pi=new Set;let ki=0;function _i(){if(0!==ki)return;const e=fi;do{try{for(;ki<yi.length;){const e=yi[ki];ki++,hi(e),Ci(e.$$)}}catch(t){throw yi.length=0,ki=0,t}for(hi(null),yi.length=0,ki=0;bi.length;)bi.pop()();for(let e=0;e<vi.length;e+=1){const t=vi[e];Pi.has(t)||(Pi.add(t),t())}vi.length=0}while(yi.length);for(;wi.length;)wi.pop()();xi=!1,Pi.clear(),hi(e)}function Ci(e){if(null!==e.fragment){e.update(),Yo(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Si)}}const Ai=new Set;let Ii;function Fi(){Ii={r:0,c:[],p:Ii}}function Ei(){Ii.r||Yo(Ii.c),Ii=Ii.p}function Ni(e,t){e&&e.i&&(Ai.delete(e),e.i(t))}function Li(e,t,n,a){if(e&&e.o){if(Ai.has(e))return;Ai.add(e),Ii.c.push((()=>{Ai.delete(e),a&&(n&&e.d(1),a())})),e.o(t)}else a&&a()}function Oi(e){return void 0!==(null==e?void 0:e.length)?e:Array.from(e)}function Vi(e){e&&e.c()}function Ti(e,t,n){const{fragment:a,after_update:r}=e.$$;a&&a.m(t,n),Si((()=>{const t=e.$$.on_mount.map(Qo).filter(Xo);e.$$.on_destroy?e.$$.on_destroy.push(...t):Yo(t),e.$$.on_mount=[]})),r.forEach(Si)}function Ri(e,t){const n=e.$$;null!==n.fragment&&(function(e){const t=[],n=[];vi.forEach((a=>-1===e.indexOf(a)?t.push(a):n.push(a))),n.forEach((e=>e())),vi=t}(n.after_update),Yo(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function zi(e,t,n,a,r,o,i=null,l=[-1]){const s=fi;hi(e);const d=e.$$={fragment:null,ctx:[],props:o,update:Ko,not_equal:r,bound:Zo(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(s?s.$$.context:[])),callbacks:Zo(),dirty:l,skip_bound:!1,root:t.target||s.$$.root};i&&i(d.root);let c=!1;if(d.ctx=n?n(e,t.props||{},((t,n,...a)=>{const o=a.length?a[0]:n;return d.ctx&&r(d.ctx[t],d.ctx[t]=o)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](o),c&&function(e,t){-1===e.$$.dirty[0]&&(yi.push(e),xi||(xi=!0,Di.then(_i)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n})):[],d.update(),c=!0,Yo(d.before_update),d.fragment=!!a&&a(d.ctx),t.target){if(t.hydrate){const e=(u=t.target,Array.from(u.childNodes));d.fragment&&d.fragment.l(e),e.forEach(ai)}else d.fragment&&d.fragment.c();t.intro&&Ni(e.$$.fragment),Ti(e,t.target,t.anchor),_i()}var u;hi(s)}class Mi{constructor(){this.$$=void 0,this.$$set=void 0}$destroy(){Ri(this,1),this.$destroy=Ko}$on(e,t){if(!Xo(t))return Ko;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Ui(e){let t,n,a,r,o;return{c(){t=ri("button"),di(t,"aria-label",n=e[3]?e[3]:null),di(t,"class",a=`${e[1]||""} shepherd-button ${e[4]?"shepherd-button-secondary":""}`),t.disabled=e[2],di(t,"tabindex","0"),di(t,"type","button")},m(n,a){ni(n,t,a),t.innerHTML=e[5],r||(o=si(t,"click",(function(){Xo(e[0])&&e[0].apply(this,arguments)})),r=!0)},p(r,[o]){e=r,32&o&&(t.innerHTML=e[5]),8&o&&n!==(n=e[3]?e[3]:null)&&di(t,"aria-label",n),18&o&&a!==(a=`${e[1]||""} shepherd-button ${e[4]?"shepherd-button-secondary":""}`)&&di(t,"class",a),4&o&&(t.disabled=e[2])},i:Ko,o:Ko,d(e){e&&ai(t),r=!1,o()}}}function qi(e,t,n){let a,r,o,i,l,s,{config:d,step:c}=t;function u(e){return mr(e)?e.call(c):e}return e.$$set=e=>{"config"in e&&n(6,d=e.config),"step"in e&&n(7,c=e.step)},e.$$.update=()=>{192&e.$$.dirty&&(n(0,a=d.action?d.action.bind(c.tour):null),n(1,r=d.classes),n(2,o=!!d.disabled&&u(d.disabled)),n(3,i=d.label?u(d.label):null),n(4,l=d.secondary),n(5,s=d.text?u(d.text):null))},[a,r,o,i,l,s,d,c]}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");class Hi extends Mi{constructor(e){super(),zi(this,e,qi,Ui,ei,{config:6,step:7})}}function Bi(e,t,n){const a=e.slice();return a[2]=t[n],a}function $i(e){let t,n,a=Oi(e[1]),r=[];for(let i=0;i<a.length;i+=1)r[i]=ji(Bi(e,a,i));const o=e=>Li(r[e],1,1,(()=>{r[e]=null}));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=ii("")},m(e,a){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,a);ni(e,t,a),n=!0},p(e,n){if(3&n){let i;for(a=Oi(e[1]),i=0;i<a.length;i+=1){const o=Bi(e,a,i);r[i]?(r[i].p(o,n),Ni(r[i],1)):(r[i]=ji(o),r[i].c(),Ni(r[i],1),r[i].m(t.parentNode,t))}for(Fi(),i=a.length;i<r.length;i+=1)o(i);Ei()}},i(e){if(!n){for(let e=0;e<a.length;e+=1)Ni(r[e]);n=!0}},o(e){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)Li(r[t]);n=!1},d(e){e&&ai(t),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(r,e)}}}function ji(e){let t,n;return t=new Hi({props:{config:e[2],step:e[0]}}),{c(){Vi(t.$$.fragment)},m(e,a){Ti(t,e,a),n=!0},p(e,n){const a={};2&n&&(a.config=e[2]),1&n&&(a.step=e[0]),t.$set(a)},i(e){n||(Ni(t.$$.fragment,e),n=!0)},o(e){Li(t.$$.fragment,e),n=!1},d(e){Ri(t,e)}}}function Gi(e){let t,n,a=e[1]&&$i(e);return{c(){t=ri("footer"),a&&a.c(),di(t,"class","shepherd-footer")},m(e,r){ni(e,t,r),a&&a.m(t,null),n=!0},p(e,[n]){e[1]?a?(a.p(e,n),2&n&&Ni(a,1)):(a=$i(e),a.c(),Ni(a,1),a.m(t,null)):a&&(Fi(),Li(a,1,1,(()=>{a=null})),Ei())},i(e){n||(Ni(a),n=!0)},o(e){Li(a),n=!1},d(e){e&&ai(t),a&&a.d()}}}function Ji(e,t,n){let a,{step:r}=t;return e.$$set=e=>{"step"in e&&n(0,r=e.step)},e.$$.update=()=>{1&e.$$.dirty&&n(1,a=r.options.buttons)},[r,a]}class Ki extends Mi{constructor(e){super(),zi(this,e,Ji,Gi,ei,{step:0})}}function Wi(e){let t,n,a,r,o;return{c(){t=ri("button"),n=ri("span"),n.textContent="×",di(n,"aria-hidden","true"),di(t,"aria-label",a=e[0].label?e[0].label:"Close Tour"),di(t,"class","shepherd-cancel-icon"),di(t,"type","button")},m(a,i){ni(a,t,i),ti(t,n),r||(o=si(t,"click",e[1]),r=!0)},p(e,[n]){1&n&&a!==(a=e[0].label?e[0].label:"Close Tour")&&di(t,"aria-label",a)},i:Ko,o:Ko,d(e){e&&ai(t),r=!1,o()}}}function Qi(e,t,n){let{cancelIcon:a,step:r}=t;return e.$$set=e=>{"cancelIcon"in e&&n(0,a=e.cancelIcon),"step"in e&&n(2,r=e.step)},[a,e=>{e.preventDefault(),r.cancel()},r]}class Zi extends Mi{constructor(e){super(),zi(this,e,Qi,Wi,ei,{cancelIcon:0,step:2})}}function Yi(e){let t;return{c(){t=ri("h3"),di(t,"id",e[1]),di(t,"class","shepherd-title")},m(n,a){ni(n,t,a),e[3](t)},p(e,[n]){2&n&&di(t,"id",e[1])},i:Ko,o:Ko,d(n){n&&ai(t),e[3](null)}}}function Xi(e,t,n){let{labelId:a,element:r,title:o}=t;return gi((()=>{mr(o)&&n(2,o=o()),n(0,r.innerHTML=o,r)})),e.$$set=e=>{"labelId"in e&&n(1,a=e.labelId),"element"in e&&n(0,r=e.element),"title"in e&&n(2,o=e.title)},[r,a,o,function(e){bi[e?"unshift":"push"]((()=>{r=e,n(0,r)}))}]}class el extends Mi{constructor(e){super(),zi(this,e,Xi,Yi,ei,{labelId:1,element:0,title:2})}}function tl(e){let t,n;return t=new el({props:{labelId:e[0],title:e[2]}}),{c(){Vi(t.$$.fragment)},m(e,a){Ti(t,e,a),n=!0},p(e,n){const a={};1&n&&(a.labelId=e[0]),4&n&&(a.title=e[2]),t.$set(a)},i(e){n||(Ni(t.$$.fragment,e),n=!0)},o(e){Li(t.$$.fragment,e),n=!1},d(e){Ri(t,e)}}}function nl(e){let t,n;return t=new Zi({props:{cancelIcon:e[3],step:e[1]}}),{c(){Vi(t.$$.fragment)},m(e,a){Ti(t,e,a),n=!0},p(e,n){const a={};8&n&&(a.cancelIcon=e[3]),2&n&&(a.step=e[1]),t.$set(a)},i(e){n||(Ni(t.$$.fragment,e),n=!0)},o(e){Li(t.$$.fragment,e),n=!1},d(e){Ri(t,e)}}}function al(e){let t,n,a,r=e[2]&&tl(e),o=e[3]&&e[3].enabled&&nl(e);return{c(){t=ri("header"),r&&r.c(),n=li(),o&&o.c(),di(t,"class","shepherd-header")},m(e,i){ni(e,t,i),r&&r.m(t,null),ti(t,n),o&&o.m(t,null),a=!0},p(e,[a]){e[2]?r?(r.p(e,a),4&a&&Ni(r,1)):(r=tl(e),r.c(),Ni(r,1),r.m(t,n)):r&&(Fi(),Li(r,1,1,(()=>{r=null})),Ei()),e[3]&&e[3].enabled?o?(o.p(e,a),8&a&&Ni(o,1)):(o=nl(e),o.c(),Ni(o,1),o.m(t,null)):o&&(Fi(),Li(o,1,1,(()=>{o=null})),Ei())},i(e){a||(Ni(r),Ni(o),a=!0)},o(e){Li(r),Li(o),a=!1},d(e){e&&ai(t),r&&r.d(),o&&o.d()}}}function rl(e,t,n){let a,r,{labelId:o,step:i}=t;return e.$$set=e=>{"labelId"in e&&n(0,o=e.labelId),"step"in e&&n(1,i=e.step)},e.$$.update=()=>{2&e.$$.dirty&&(n(2,a=i.options.title),n(3,r=i.options.cancelIcon))},[o,i,a,r]}class ol extends Mi{constructor(e){super(),zi(this,e,rl,al,ei,{labelId:0,step:1})}}function il(e){let t;return{c(){t=ri("div"),di(t,"class","shepherd-text"),di(t,"id",e[1])},m(n,a){ni(n,t,a),e[3](t)},p(e,[n]){2&n&&di(t,"id",e[1])},i:Ko,o:Ko,d(n){n&&ai(t),e[3](null)}}}function ll(e,t,n){let{descriptionId:a,element:r,step:o}=t;return gi((()=>{let{text:e}=o.options;mr(e)&&(e=e.call(o)),hr(e)?r.appendChild(e):n(0,r.innerHTML=e,r)})),e.$$set=e=>{"descriptionId"in e&&n(1,a=e.descriptionId),"element"in e&&n(0,r=e.element),"step"in e&&n(2,o=e.step)},[r,a,o,function(e){bi[e?"unshift":"push"]((()=>{r=e,n(0,r)}))}]}class sl extends Mi{constructor(e){super(),zi(this,e,ll,il,ei,{descriptionId:1,element:0,step:2})}}function dl(e){let t,n;return t=new ol({props:{labelId:e[1],step:e[2]}}),{c(){Vi(t.$$.fragment)},m(e,a){Ti(t,e,a),n=!0},p(e,n){const a={};2&n&&(a.labelId=e[1]),4&n&&(a.step=e[2]),t.$set(a)},i(e){n||(Ni(t.$$.fragment,e),n=!0)},o(e){Li(t.$$.fragment,e),n=!1},d(e){Ri(t,e)}}}function cl(e){let t,n;return t=new sl({props:{descriptionId:e[0],step:e[2]}}),{c(){Vi(t.$$.fragment)},m(e,a){Ti(t,e,a),n=!0},p(e,n){const a={};1&n&&(a.descriptionId=e[0]),4&n&&(a.step=e[2]),t.$set(a)},i(e){n||(Ni(t.$$.fragment,e),n=!0)},o(e){Li(t.$$.fragment,e),n=!1},d(e){Ri(t,e)}}}function ul(e){let t,n;return t=new Ki({props:{step:e[2]}}),{c(){Vi(t.$$.fragment)},m(e,a){Ti(t,e,a),n=!0},p(e,n){const a={};4&n&&(a.step=e[2]),t.$set(a)},i(e){n||(Ni(t.$$.fragment,e),n=!0)},o(e){Li(t.$$.fragment,e),n=!1},d(e){Ri(t,e)}}}function pl(e){let t,n,a,r,o=!yr(e[2].options.title)||e[2].options.cancelIcon&&e[2].options.cancelIcon.enabled,i=!yr(e[2].options.text),l=Array.isArray(e[2].options.buttons)&&e[2].options.buttons.length,s=o&&dl(e),d=i&&cl(e),c=l&&ul(e);return{c(){t=ri("div"),s&&s.c(),n=li(),d&&d.c(),a=li(),c&&c.c(),di(t,"class","shepherd-content")},m(e,o){ni(e,t,o),s&&s.m(t,null),ti(t,n),d&&d.m(t,null),ti(t,a),c&&c.m(t,null),r=!0},p(e,[r]){4&r&&(o=!yr(e[2].options.title)||e[2].options.cancelIcon&&e[2].options.cancelIcon.enabled),o?s?(s.p(e,r),4&r&&Ni(s,1)):(s=dl(e),s.c(),Ni(s,1),s.m(t,n)):s&&(Fi(),Li(s,1,1,(()=>{s=null})),Ei()),4&r&&(i=!yr(e[2].options.text)),i?d?(d.p(e,r),4&r&&Ni(d,1)):(d=cl(e),d.c(),Ni(d,1),d.m(t,a)):d&&(Fi(),Li(d,1,1,(()=>{d=null})),Ei()),4&r&&(l=Array.isArray(e[2].options.buttons)&&e[2].options.buttons.length),l?c?(c.p(e,r),4&r&&Ni(c,1)):(c=ul(e),c.c(),Ni(c,1),c.m(t,null)):c&&(Fi(),Li(c,1,1,(()=>{c=null})),Ei())},i(e){r||(Ni(s),Ni(d),Ni(c),r=!0)},o(e){Li(s),Li(d),Li(c),r=!1},d(e){e&&ai(t),s&&s.d(),d&&d.d(),c&&c.d()}}}function fl(e,t,n){let{descriptionId:a,labelId:r,step:o}=t;return e.$$set=e=>{"descriptionId"in e&&n(0,a=e.descriptionId),"labelId"in e&&n(1,r=e.labelId),"step"in e&&n(2,o=e.step)},[a,r,o]}class hl extends Mi{constructor(e){super(),zi(this,e,fl,pl,ei,{descriptionId:0,labelId:1,step:2})}}function ml(e){let t;return{c(){t=ri("div"),di(t,"class","shepherd-arrow"),di(t,"data-popper-arrow","")},m(e,n){ni(e,t,n)},d(e){e&&ai(t)}}}function gl(e){let t,n,a,r,o,i,l,s,d=e[4].options.arrow&&e[4].options.attachTo&&e[4].options.attachTo.element&&e[4].options.attachTo.on&&ml();a=new hl({props:{descriptionId:e[2],labelId:e[3],step:e[4]}});let c=[{"aria-describedby":r=yr(e[4].options.text)?null:e[2]},{"aria-labelledby":o=e[4].options.title?e[3]:null},e[1],{open:"true"}],u={};for(let p=0;p<c.length;p+=1)u=Wo(u,c[p]);return{c(){t=ri("dialog"),d&&d.c(),n=li(),Vi(a.$$.fragment),ui(t,u),pi(t,"shepherd-has-cancel-icon",e[5]),pi(t,"shepherd-has-title",e[6]),pi(t,"shepherd-element",!0)},m(r,o){ni(r,t,o),d&&d.m(t,null),ti(t,n),Ti(a,t,null),e[13](t),i=!0,l||(s=si(t,"keydown",e[7]),l=!0)},p(e,[l]){e[4].options.arrow&&e[4].options.attachTo&&e[4].options.attachTo.element&&e[4].options.attachTo.on?d||(d=ml(),d.c(),d.m(t,n)):d&&(d.d(1),d=null);const s={};4&l&&(s.descriptionId=e[2]),8&l&&(s.labelId=e[3]),16&l&&(s.step=e[4]),a.$set(s),ui(t,u=function(e,t){const n={},a={},r={$$scope:1};let o=e.length;for(;o--;){const i=e[o],l=t[o];if(l){for(const e in i)e in l||(a[e]=1);for(const e in l)r[e]||(n[e]=l[e],r[e]=1);e[o]=l}else for(const e in i)r[e]=1}for(const i in a)i in n||(n[i]=void 0);return n}(c,[(!i||20&l&&r!==(r=yr(e[4].options.text)?null:e[2]))&&{"aria-describedby":r},(!i||24&l&&o!==(o=e[4].options.title?e[3]:null))&&{"aria-labelledby":o},2&l&&e[1],{open:"true"}])),pi(t,"shepherd-has-cancel-icon",e[5]),pi(t,"shepherd-has-title",e[6]),pi(t,"shepherd-element",!0)},i(e){i||(Ni(a.$$.fragment,e),i=!0)},o(e){Li(a.$$.fragment,e),i=!1},d(n){n&&ai(t),d&&d.d(),Ri(a),e[13](null),l=!1,s()}}}function yl(e){return e.split(" ").filter((e=>!!e.length))}function bl(e,t,n){let a,r,o,{classPrefix:i,element:l,descriptionId:s,firstFocusableElement:d,focusableElements:c,labelId:u,lastFocusableElement:p,step:f,dataStepId:h}=t;var m;return m=()=>{n(1,h={[`data-${i}shepherd-step-id`]:f.id}),n(9,c=l.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]')),n(8,d=c[0]),n(10,p=c[c.length-1])},mi().$$.on_mount.push(m),gi((()=>{o!==f.options.classes&&(function(e){if(gr(e)){const t=yl(e);t.length&&l.classList.remove(...t)}}(o),o=f.options.classes,function(e){if(gr(e)){const t=yl(e);t.length&&l.classList.add(...t)}}(o))})),e.$$set=e=>{"classPrefix"in e&&n(11,i=e.classPrefix),"element"in e&&n(0,l=e.element),"descriptionId"in e&&n(2,s=e.descriptionId),"firstFocusableElement"in e&&n(8,d=e.firstFocusableElement),"focusableElements"in e&&n(9,c=e.focusableElements),"labelId"in e&&n(3,u=e.labelId),"lastFocusableElement"in e&&n(10,p=e.lastFocusableElement),"step"in e&&n(4,f=e.step),"dataStepId"in e&&n(1,h=e.dataStepId)},e.$$.update=()=>{16&e.$$.dirty&&(n(5,a=f.options&&f.options.cancelIcon&&f.options.cancelIcon.enabled),n(6,r=f.options&&f.options.title))},[l,h,s,u,f,a,r,e=>{const{tour:t}=f;switch(e.keyCode){case 9:if(0===c.length){e.preventDefault();break}e.shiftKey?(document.activeElement===d||document.activeElement.classList.contains("shepherd-element"))&&(e.preventDefault(),p.focus()):document.activeElement===p&&(e.preventDefault(),d.focus());break;case 27:t.options.exitOnEsc&&(e.preventDefault(),e.stopPropagation(),f.cancel());break;case 37:t.options.keyboardNavigation&&(e.preventDefault(),e.stopPropagation(),t.back());break;case 39:t.options.keyboardNavigation&&(e.preventDefault(),e.stopPropagation(),t.next())}},d,c,p,i,()=>l,function(e){bi[e?"unshift":"push"]((()=>{l=e,n(0,l)}))}]}class vl extends Mi{constructor(e){super(),zi(this,e,bl,gl,ei,{classPrefix:11,element:0,descriptionId:2,firstFocusableElement:8,focusableElements:9,labelId:3,lastFocusableElement:10,step:4,dataStepId:1,getElement:12})}get getElement(){return this.$$.ctx[12]}}class wl extends br{constructor(e,t={}){return super(),this._resolvedAttachTo=void 0,this._resolvedExtraHighlightElements=void 0,this.classPrefix=void 0,this.el=void 0,this.target=void 0,this.tour=void 0,this.tour=e,this.classPrefix=this.tour.options?Or(this.tour.options.classPrefix):"",this.styles=e.styles,this._resolvedAttachTo=null,Lr(this),this._setOptions(t),this}cancel(){this.tour.cancel(),this.trigger("cancel")}complete(){this.tour.complete(),this.trigger("complete")}destroy(){this.cleanup&&this.cleanup(),this.cleanup=null,hr(this.el)&&(this.el.remove(),this.el=null),this._updateStepTargetOnHide(),this.trigger("destroy")}getTour(){return this.tour}hide(){var e;null==(e=this.tour.modal)||e.hide(),this.trigger("before-hide"),this.el&&(this.el.hidden=!0),this._updateStepTargetOnHide(),this.trigger("hide")}_resolveExtraHiglightElements(){return this._resolvedExtraHighlightElements=this.options.extraHighlights?this.options.extraHighlights.flatMap((e=>Array.from(document.querySelectorAll(e)))):[],this._resolvedExtraHighlightElements}_resolveAttachToOptions(){return this._resolvedAttachTo=function(e){const t=e.options.attachTo||{},n=Object.assign({},t);if(mr(n.element)&&(n.element=n.element.call(e)),gr(n.element)){try{n.element=document.querySelector(n.element)}catch(a){}n.element}return n}(this),this._resolvedAttachTo}_getResolvedAttachToOptions(){return null===this._resolvedAttachTo?this._resolveAttachToOptions():this._resolvedAttachTo}isOpen(){return Boolean(this.el&&!this.el.hidden)}show(){return mr(this.options.beforeShowPromise)?Promise.resolve(this.options.beforeShowPromise()).then((()=>this._show())):Promise.resolve(this._show())}updateStepOptions(e){Object.assign(this.options,e),this.shepherdElementComponent&&this.shepherdElementComponent.$set({step:this})}getElement(){return this.el}getTarget(){return this.target}_createTooltipContent(){const e=`${this.id}-description`,t=`${this.id}-label`;return this.shepherdElementComponent=new vl({target:this.tour.options.stepsContainer||document.body,props:{classPrefix:this.classPrefix,descriptionId:e,labelId:t,step:this,styles:this.styles}}),this.shepherdElementComponent.getElement()}_scrollTo(e){const{element:t}=this._getResolvedAttachToOptions();mr(this.options.scrollToHandler)?this.options.scrollToHandler(t):t instanceof Element&&"function"==typeof t.scrollIntoView&&t.scrollIntoView(e)}_getClassOptions(e){const t=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions,n=e.classes?e.classes:"",a=t&&t.classes?t.classes:"",r=[...n.split(" "),...a.split(" ")],o=new Set(r);return Array.from(o).join(" ").trim()}_setOptions(e={}){let t=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions;t=Fr({},t||{}),this.options=Object.assign({arrow:!0},t,e,function(e,t){return{floatingUIOptions:Fr(e.floatingUIOptions||{},t.floatingUIOptions||{})}}(t,e));const{when:n}=this.options;this.options.classes=this._getClassOptions(e),this.destroy(),this.id=this.options.id||`step-${Tr()}`,n&&Object.keys(n).forEach((e=>{this.on(e,n[e],this)}))}_setupElements(){yr(this.el)||this.destroy(),this.el=this._createTooltipContent(),this.options.advanceOn&&function(e){const{event:t,selector:n}=e.options.advanceOn||{};if(t){const a=function(e,t){return n=>{if(e.isOpen()){const a=e.el&&n.currentTarget===e.el;(!yr(t)&&n.currentTarget.matches(t)||a)&&e.tour.next()}}}(e,n);let r=null;if(!yr(n)&&(r=document.querySelector(n),!r))return;r?(r.addEventListener(t,a),e.on("destroy",(()=>r.removeEventListener(t,a)))):(document.body.addEventListener(t,a,!0),e.on("destroy",(()=>document.body.removeEventListener(t,a,!0))))}}(this),Jo(this)}_show(){var e;this.trigger("before-show"),this._resolveAttachToOptions(),this._resolveExtraHiglightElements(),this._setupElements(),this.tour.modal||this.tour.setupModal(),null==(e=this.tour.modal)||e.setupForStep(this),this._styleTargetElementForStep(this),this.el&&(this.el.hidden=!1),this.options.scrollTo&&setTimeout((()=>{this._scrollTo(this.options.scrollTo)})),this.el&&(this.el.hidden=!1);const t=this.shepherdElementComponent.getElement(),n=this.target||document.body,a=this._resolvedExtraHighlightElements;n.classList.add(`${this.classPrefix}shepherd-enabled`),n.classList.add(`${this.classPrefix}shepherd-target`),t.classList.add("shepherd-enabled"),null==a||a.forEach((e=>{e.classList.add(`${this.classPrefix}shepherd-enabled`),e.classList.add(`${this.classPrefix}shepherd-target`)})),this.trigger("show")}_styleTargetElementForStep(e){const t=e.target,n=e._resolvedExtraHighlightElements;if(!t)return;const a=e.options.highlightClass;a&&(t.classList.add(a),null==n||n.forEach((e=>e.classList.add(a)))),t.classList.remove("shepherd-target-click-disabled"),null==n||n.forEach((e=>e.classList.remove("shepherd-target-click-disabled"))),!1===e.options.canClickTarget&&(t.classList.add("shepherd-target-click-disabled"),null==n||n.forEach((e=>e.classList.add("shepherd-target-click-disabled"))))}_updateStepTargetOnHide(){const e=this.target||document.body,t=this._resolvedExtraHighlightElements,n=this.options.highlightClass;n&&(e.classList.remove(n),null==t||t.forEach((e=>e.classList.remove(n)))),e.classList.remove("shepherd-target-click-disabled",`${this.classPrefix}shepherd-enabled`,`${this.classPrefix}shepherd-target`),null==t||t.forEach((e=>{e.classList.remove("shepherd-target-click-disabled",`${this.classPrefix}shepherd-enabled`,`${this.classPrefix}shepherd-target`)}))}}function Dl(e){let t,n,a,r,o;return{c(){t=oi("svg"),n=oi("path"),di(n,"d",e[2]),di(t,"class",a=(e[1]?"shepherd-modal-is-visible":"")+" shepherd-modal-overlay-container")},m(a,i){ni(a,t,i),ti(t,n),e[11](t),r||(o=si(t,"touchmove",e[3]),r=!0)},p(e,[r]){4&r&&di(n,"d",e[2]),2&r&&a!==(a=(e[1]?"shepherd-modal-is-visible":"")+" shepherd-modal-overlay-container")&&di(t,"class",a)},i:Ko,o:Ko,d(n){n&&ai(t),e[11](null),r=!1,o()}}}function xl(e){if(!e)return null;const t=e instanceof HTMLElement&&window.getComputedStyle(e).overflowY;return"hidden"!==t&&"visible"!==t&&e.scrollHeight>=e.clientHeight?e:xl(e.parentElement)}function Sl(e,t){const n=e.getBoundingClientRect();let a=n.y||n.top,r=n.bottom||a+n.height;if(t){const e=t.getBoundingClientRect(),n=e.y||e.top,o=e.bottom||n+e.height;a=Math.max(a,n),r=Math.min(r,o)}return{y:a,height:Math.max(r-a,0)}}function Pl(e,t,n){let a,r,{element:o,openingProperties:i}=t,l=!1;function s(){n(4,i=[{width:0,height:0,x:0,y:0,r:0}])}function d(){n(1,l=!1),f()}function c(e=0,t=0,a=0,r=0,o,l,d){if(l){const s=[l,...d||[]];n(4,i=[]);for(const n of s){if(!n)continue;if(s.indexOf(n)!==s.lastIndexOf(n))continue;const{y:l,height:d}=Sl(n,o),{x:c,width:u,left:p}=n.getBoundingClientRect();s.some((e=>{if(e===n)return!1;const t=e.getBoundingClientRect();return c>=t.left&&c+u<=t.right&&l>=t.top&&l+d<=t.bottom}))||i.push({width:u+2*e,height:d+2*e,x:(c||p)+a-e,y:l+r-e,r:t})}}else s()}function u(){n(1,l=!0)}s();const p=e=>{e.preventDefault()};function f(){a&&(cancelAnimationFrame(a),a=void 0),window.removeEventListener("touchmove",p,{passive:!1})}return e.$$set=e=>{"element"in e&&n(0,o=e.element),"openingProperties"in e&&n(4,i=e.openingProperties)},e.$$.update=()=>{16&e.$$.dirty&&n(2,r=function(e){let t="";const{innerWidth:n,innerHeight:a}=window;return e.forEach((e=>{const{width:n,height:a,x:r=0,y:o=0,r:i=0}=e,{topLeft:l=0,topRight:s=0,bottomRight:d=0,bottomLeft:c=0}="number"==typeof i?{topLeft:i,topRight:i,bottomRight:i,bottomLeft:i}:i;t+=`M${r+l},${o}      a${l},${l},0,0,0-${l},${l}      V${a+o-c}      a${c},${c},0,0,0,${c},${c}      H${n+r-d}      a${d},${d},0,0,0,${d}-${d}      V${o+s}      a${s},${s},0,0,0-${s}-${s}      Z`})),`M${n},${a}          H0          V0          H${n}          V${a}          Z          ${t}`.replace(/\s/g,"")}(i))},[o,l,r,e=>{e.stopPropagation()},i,()=>o,s,d,c,function(e){f(),e.tour.options.useModalOverlay?(function(e){const{modalOverlayOpeningPadding:t,modalOverlayOpeningRadius:n,modalOverlayOpeningXOffset:r=0,modalOverlayOpeningYOffset:o=0}=e.options,i=function(e){let t={top:0,left:0};if(!e)return t;let n=e.ownerDocument.defaultView;for(;n!==window.top;){var a;const e=null==(a=n)?void 0:a.frameElement;if(e){var r,o;const n=e.getBoundingClientRect();t.top+=n.top+(null!=(r=n.scrollTop)?r:0),t.left+=n.left+(null!=(o=n.scrollLeft)?o:0)}n=n.parent}return t}(e.target),l=xl(e.target),s=()=>{a=void 0,c(t,n,r+i.left,o+i.top,l,e.target,e._resolvedExtraHighlightElements),a=requestAnimationFrame(s)};s(),window.addEventListener("touchmove",p,{passive:!1})}(e),u()):d()},u,function(e){bi[e?"unshift":"push"]((()=>{o=e,n(0,o)}))}]}class kl extends Mi{constructor(e){super(),zi(this,e,Pl,Dl,ei,{element:0,openingProperties:4,getElement:5,closeModalOpening:6,hide:7,positionModal:8,setupForStep:9,show:10})}get getElement(){return this.$$.ctx[5]}get closeModalOpening(){return this.$$.ctx[6]}get hide(){return this.$$.ctx[7]}get positionModal(){return this.$$.ctx[8]}get setupForStep(){return this.$$.ctx[9]}get show(){return this.$$.ctx[10]}}const _l=new class extends br{constructor(){super(),this.activeTour=void 0,Lr(this)}},Cl="undefined"==typeof window;_l.Step=Cl?class{constructor(e){}}:wl,_l.Tour=Cl?class{constructor(e,t){}}:class extends br{constructor(e={}){return super(),this.trackedEvents=["active","cancel","complete","show"],this.classPrefix=void 0,this.currentStep=void 0,this.focusedElBeforeOpen=void 0,this.id=void 0,this.modal=void 0,this.options=void 0,this.steps=void 0,Lr(this),this.options=Object.assign({},{exitOnEsc:!0,keyboardNavigation:!0},e),this.classPrefix=Or(this.options.classPrefix),this.steps=[],this.addSteps(this.options.steps),["active","cancel","complete","inactive","show","start"].map((e=>{(e=>{this.on(e,(t=>{(t=t||{}).tour=this,_l.trigger(e,t)}))})(e)})),this._setTourID(e.id),this}addStep(e,t){let n=e;return n instanceof wl?n.tour=this:n=new wl(this,n),yr(t)?this.steps.push(n):this.steps.splice(t,0,n),n}addSteps(e){return Array.isArray(e)&&e.forEach((e=>{this.addStep(e)})),this}back(){const e=this.steps.indexOf(this.currentStep);this.show(e-1,!1)}async cancel(){if(this.options.confirmCancel){const e=this.options.confirmCancelMessage||"Are you sure you want to stop the tour?";let t;t=mr(this.options.confirmCancel)?await this.options.confirmCancel():window.confirm(e),t&&this._done("cancel")}else this._done("cancel")}complete(){this._done("complete")}getById(e){return this.steps.find((t=>t.id===e))}getCurrentStep(){return this.currentStep}hide(){const e=this.getCurrentStep();if(e)return e.hide()}isActive(){return _l.activeTour===this}next(){const e=this.steps.indexOf(this.currentStep);e===this.steps.length-1?this.complete():this.show(e+1,!0)}removeStep(e){const t=this.getCurrentStep();this.steps.some(((t,n)=>{if(t.id===e)return t.isOpen()&&t.hide(),t.destroy(),this.steps.splice(n,1),!0})),t&&t.id===e&&(this.currentStep=void 0,this.steps.length?this.show(0):this.cancel())}show(e=0,t=!0){const n=gr(e)?this.getById(e):this.steps[e];n&&(this._updateStateBeforeShow(),mr(n.options.showOn)&&!n.options.showOn()?this._skipStep(n,t):(this.currentStep=n,this.trigger("show",{step:n,previous:this.currentStep}),n.show()))}async start(){this.trigger("start"),this.focusedElBeforeOpen=document.activeElement,this.currentStep=null,this.setupModal(),this._setupActiveTour(),this.next()}_done(e){const t=this.steps.indexOf(this.currentStep);if(Array.isArray(this.steps)&&this.steps.forEach((e=>e.destroy())),function(e){if(e){const{steps:t}=e;t.forEach((e=>{e.options&&!1===e.options.canClickTarget&&e.options.attachTo&&(hr(e.target)&&e.target.classList.remove("shepherd-target-click-disabled"),e._resolvedExtraHighlightElements&&e._resolvedExtraHighlightElements.forEach((e=>{hr(e)&&e.classList.remove("shepherd-target-click-disabled")})))}))}}(this),this.trigger(e,{index:t}),_l.activeTour=null,this.trigger("inactive",{tour:this}),this.modal&&this.modal.hide(),("cancel"===e||"complete"===e)&&this.modal){const e=document.querySelector(".shepherd-modal-overlay-container");e&&(e.remove(),this.modal=null)}hr(this.focusedElBeforeOpen)&&this.focusedElBeforeOpen.focus()}_setupActiveTour(){this.trigger("active",{tour:this}),_l.activeTour=this}setupModal(){this.modal=new kl({target:this.options.modalContainer||document.body,props:{styles:this.styles}})}_skipStep(e,t){const n=this.steps.indexOf(e);if(n===this.steps.length-1)this.complete();else{const e=t?n+1:n-1;this.show(e,t)}}_updateStateBeforeShow(){this.currentStep&&this.currentStep.hide(),this.isActive()||this._setupActiveTour()}_setTourID(e){const t=this.options.tourName||"tour",n=e||Tr();this.id=`${t}--${n}`}};const Al={en:JSON.parse(JSON.stringify({topbar:{appSubtitle:"Secure requisition form builder",aria:{themeToggleLight:"Switch to Light Theme",themeToggleDark:"Switch to Dark Theme",reset:"Reset Application",faq:"Open FAQ",tour:"Start Guided Tour",copyUrl:"Copy URL",copyEncryptedUrl:"Copy Encrypted URL",pasteData:"Paste and Import Data",saveData:"Save Data",loadData:"Load Data",generatePdf:"Generate PDF",moreActions:"More Actions",toggleLanguage:"Switch Language between German and English"},tooltips:{themeToggleLight:"Switch to Light Theme",themeToggleDark:"Switch to Dark Theme",reset:"Reset Application",faq:"FAQ",tour:"Start Guided Tour",copyUrl:"Copy URL",copyEncryptedUrl:"Copy Encrypted URL",pasteData:"Paste Data",saveData:"Save Data",loadData:"Load Data",generatePdf:"Generate PDF",toggleLanguage:"Switch Language (DE/EN)"},menu:{reset:"Reset Application",faq:"FAQ",tour:"Start Guided Tour",copyUrl:"Copy URL",copyEncryptedUrl:"Copy Encrypted URL",pasteData:"Paste Data",saveData:"Save Data",loadData:"Load Data",generatePdf:"Generate PDF",toggleLanguage:"Switch Language"}},patientForm:{title:"Patient Details",labels:{givenName:"Given Name *",familyName:"Family Name *",birthdate:"Birthdate *",sex:"Sex *",insurance:"Insurance *",physicianName:"Physician Name *",familyHistory:"Family History",parentalConsanguinity:"Parental Consanguinity",diagnosis:"Diagnosis / Suspicion *",orderingDate:"Ordering Date",consent:"Consent",consentGivenBy:"Consent Given By",consentDate:"Consent Date",consentSecondaryFindings:"Consent to receive secondary findings?",consentMaterial:"Allow use of material for quality assurance?",consentExtendedStorage:"Store results beyond 10 years (max. 30 years)?",consentResearch:"Use for research/quality assurance purposes?",requestVariantSegregation:"Request Variant Segregation",variantDetails:"Variant Details"},hints:{variantDetails:"Provide details for the variant segregation request"},options:{sex:{male:"Male",female:"Female",undetermined:"Undetermined"},familyHistory:{conspicuous:"Conspicuous",inconspicuous:"Inconspicuous",unknown:"Unknown"},consanguinity:{yes:"Yes",no:"No"},consent:{provided:"Already Provided",fill:"Fill Form"},yesNo:{yes:"Yes",no:"No"}}},phenotypeSelector:{toggleButton:{hide:"Hide Phenotype Options",add:"Add Phenotypes"},panelTitle:"Select Phenotype States",radioLabels:{noInput:"No Input",present:"Present",absent:"Absent"},noPhenotypesMessage:"No predefined phenotypes available for this category."},selectedPanelsSummary:{title:"Selected Panels:"},testSelector:{title:"Select Panels / Tests",tabs:{categorySelection:"Category Selection",search:"Search"},labels:{category:"Category",selectPanels:"Select Panels",searchPlaceholder:"Type a panel or gene name"}},footer:{versions:{app:"App:",testSchema:"Test schema:",pdfSchema:"PDF schema:"},tooltips:{disclaimerAcknowledged:"Disclaimer Acknowledged:",toggleLogViewer:"Toggle Log Viewer",githubRepo:"GitHub Repository",license:"License (MIT)",wiki:"Wiki / Documentation"},ariaLabels:{reopenDisclaimer:"Disclaimer Acknowledged - Click to reopen",toggleLogViewer:"Toggle Log Viewer",githubRepo:"GitHub Repository",licenseInfo:"License Information",wikiDocs:"Wiki Documentation"}},pasteDataModal:{title:"Paste and Import Data",instructions:"Paste your data in the text area below. The data should be formatted as key-value pairs, with each pair on a new line and separated by a colon.",labels:{pasteArea:"Paste your data here"},placeholders:{pasteArea:'First Name: John\nLast Name: Doe\nBirthdate: 1990-01-01\n...\n\nClick "Show Example" for a complete example.'},example:{title:"Example format:",useButton:"Use Example Data",showButton:"Show Example",hideButton:"Hide Example"},alerts:{parseSuccess:'Data successfully parsed! Click "Import Data" to apply these changes.',parseError:"Data could not be parsed. Please check the format."},buttons:{cancel:"Cancel",parse:"Parse Data",import:"Import"},validation:{pasteRequired:"Please paste data before parsing."}},decryptionDialog:{title:"Enter Password for Decryption",labels:{password:"Password"},buttons:{cancel:"Cancel",confirm:"Confirm"}},encryptionDialog:{title:"Enter Password for Encryption",labels:{password:"Password"},buttons:{cancel:"Cancel",confirm:"Confirm"}},faqDialog:{title:"Frequently Asked Questions",searchLabel:"Search FAQs",noResults:"No FAQs match your search criteria.",uncategorized:"Uncategorized",buttons:{close:"Close"}},loadDataDialog:{title:"Load Form Data",instruction:"Select a JSON file to import:",labels:{fileInput:"Select file"},validation:{fileRequired:"Please select a file"},buttons:{cancel:"Cancel",import:"Import"}},resetConfirmationDialog:{title:"Reset Application",confirmationText:"Are you sure you want to reset the entire application? This will clear all form data and cannot be undone.",buttons:{cancel:"Cancel",reset:"Reset"}},saveDataDialog:{title:"Export Form Data",instruction:"Save your form data for later use. You can name the file to identify it easily.",labels:{fileName:"File Name"},placeholders:{fileName:"requiform-data"},hints:{fileName:"Filename will be appended with .json"},buttons:{cancel:"Cancel",export:"Export"},defaultFileName:"requiform-data"},logViewer:{title:"Application Logs",emptyState:"No log entries yet.",levels:{debug:"Debug",info:"Info",warn:"Warn",error:"Error"},buttons:{download:"Download Logs",clear:"Clear Logs",close:"Close Logs",toggleDetails:"Toggle Details"}},disclaimer:{title:"Disclaimer",body:"This tool is for non-medical use only. It is not intended to provide medical advice or diagnosis. Please do not enter sensitive personal data.",acknowledgeButton:"I Acknowledge"},pedigreeDrawer:{title:"Pedigree Chart"},app:{includePedigreeChart:"Include Pedigree Chart"},tour:{buttons:{back:"Back",next:"Next",skip:"Skip",start:"Start Tour",finish:"Finish"},welcome:{text:"Welcome to RequiForm! This tour will guide you through the main features."},patientForm:{text:"Start by entering the patient information in this section."},testSelector:{text:"Select the required genetic tests here."},phenotypes:{text:"Add relevant HPO phenotypes for the patient."},topBarActions:{text:"Use the top bar actions like Generate PDF, Copy URL, etc."},generatePdf:{text:"Once the form is complete, generate the PDF request form using this button."},complete:{text:"You have completed the tour! You can restart it anytime from the Help menu."},completed:"Tour completed!",cancelled:"Tour cancelled."},validation:{required:{firstName:"First name is required.",lastName:"Last name is required.",birthdate:"Birthdate is required.",sex:"Sex is required.",insurance:"Insurance information is required.",referrer:"Referring physician is required.",diagnosis:"Diagnosis/Suspicion is required.",phenotypeId:"Phenotype ID is required.",phenotypeStatus:"Phenotype status is required."},invalid:{email:"Invalid email format.",birthdate:"Birthdate must be a valid date (YYYY-MM-DD) not in the future.",hpoIdFormat:"Invalid HPO ID format."},general:{missingData:"Patient data is missing."}}})),de:JSON.parse(JSON.stringify({topbar:{appSubtitle:"Sicherer Anforderungsformular-Generator",aria:{themeToggleLight:"Zu hellem Design wechseln",themeToggleDark:"Zu dunklem Design wechseln",reset:"Anwendung zurücksetzen",faq:"FAQ öffnen",tour:"Geführte Tour starten",copyUrl:"URL kopieren",copyEncryptedUrl:"Verschlüsselte URL kopieren",pasteData:"Daten einfügen und importieren",saveData:"Daten speichern",loadData:"Daten laden",generatePdf:"PDF generieren",moreActions:"Weitere Aktionen",toggleLanguage:"Sprache zwischen Deutsch und Englisch wechseln"},tooltips:{themeToggleLight:"Zu hellem Design wechseln",themeToggleDark:"Zu dunklem Design wechseln",reset:"Anwendung zurücksetzen",faq:"FAQ",tour:"Geführte Tour starten",copyUrl:"URL kopieren",copyEncryptedUrl:"Verschlüsselte URL kopieren",pasteData:"Daten einfügen",saveData:"Daten speichern",loadData:"Daten laden",generatePdf:"PDF generieren",toggleLanguage:"Sprache wechseln (DE/EN)"},menu:{reset:"Anwendung zurücksetzen",faq:"FAQ",tour:"Geführte Tour starten",copyUrl:"URL kopieren",copyEncryptedUrl:"Verschlüsselte URL kopieren",pasteData:"Daten einfügen",saveData:"Daten speichern",loadData:"Daten laden",generatePdf:"PDF generieren",toggleLanguage:"Sprache wechseln"}},patientForm:{title:"Patientendetails",labels:{givenName:"Vorname *",familyName:"Familienname *",birthdate:"Geburtsdatum *",sex:"Geschlecht *",insurance:"Versicherung *",physicianName:"Arztname *",familyHistory:"Familienanamnese",parentalConsanguinity:"Elterliche Konsanguinität",diagnosis:"Diagnose / Verdacht *",orderingDate:"Bestelldatum",consent:"Einwilligung",consentGivenBy:"Einwilligung gegeben von",consentDate:"Datum der Einwilligung",consentSecondaryFindings:"Einwilligung zum Erhalt von Sekundärbefunden?",consentMaterial:"Nutzung des Materials zur Qualitätssicherung erlauben?",consentExtendedStorage:"Ergebnisse länger als 10 Jahre speichern (max. 30 Jahre)?",consentResearch:"Nutzung für Forschungs-/Qualitätssicherungszwecke?",requestVariantSegregation:"Variantensegregation anfordern",variantDetails:"Variantendetails"},hints:{variantDetails:"Details zur Anforderung der Variantensegregation angeben"},options:{sex:{male:"Männlich",female:"Weiblich",undetermined:"Unbestimmt"},familyHistory:{conspicuous:"Auffällig",inconspicuous:"Unauffällig",unknown:"Unbekannt"},consanguinity:{yes:"Ja",no:"Nein"},consent:{provided:"Bereits vorhanden",fill:"Formular ausfüllen"},yesNo:{yes:"Ja",no:"Nein"}}},phenotypeSelector:{toggleButton:{hide:"Phänotyp-Optionen ausblenden",add:"Phänotypen hinzufügen"},panelTitle:"Phänotyp-Zustände auswählen",radioLabels:{noInput:"Keine Angabe",present:"Vorhanden",absent:"Fehlend"},noPhenotypesMessage:"Für diese Kategorie sind keine vordefinierten Phänotypen verfügbar."},selectedPanelsSummary:{title:"Ausgewählte Panels:"},testSelector:{title:"Panels / Tests auswählen",tabs:{categorySelection:"Kategorieauswahl",search:"Suche"},labels:{category:"Kategorie",selectPanels:"Panels auswählen",searchPlaceholder:"Panel- oder Gen-Namen eingeben"}},footer:{versions:{app:"App:",testSchema:"Testschema:",pdfSchema:"PDF-Schema:"},tooltips:{disclaimerAcknowledged:"Haftungsausschluss bestätigt:",toggleLogViewer:"Log-Anzeige umschalten",githubRepo:"GitHub-Repository",license:"Lizenz (MIT)",wiki:"Wiki / Dokumentation"},ariaLabels:{reopenDisclaimer:"Haftungsausschluss bestätigt - Zum erneuten Öffnen klicken",toggleLogViewer:"Log-Anzeige umschalten",githubRepo:"GitHub-Repository",licenseInfo:"Lizenzinformationen",wikiDocs:"Wiki-Dokumentation"}},pasteDataModal:{title:"Daten einfügen und importieren",instructions:"Fügen Sie Ihre Daten in das Textfeld unten ein. Die Daten sollten als Schlüssel-Wert-Paare formatiert sein, wobei jedes Paar in einer neuen Zeile steht und durch einen Doppelpunkt getrennt ist.",labels:{pasteArea:"Fügen Sie Ihre Daten hier ein"},placeholders:{pasteArea:'Vorname: Max\nNachname: Mustermann\nGeburtsdatum: 1990-01-01\n...\n\nKlicken Sie auf "Beispiel anzeigen" für ein vollständiges Beispiel.'},example:{title:"Beispielformat:",useButton:"Beispieldaten verwenden",showButton:"Beispiel anzeigen",hideButton:"Beispiel ausblenden"},alerts:{parseSuccess:'Daten erfolgreich geparst! Klicken Sie auf "Daten importieren", um diese Änderungen anzuwenden.',parseError:"Daten konnten nicht geparst werden. Bitte überprüfen Sie das Format."},buttons:{cancel:"Abbrechen",parse:"Daten parsen",import:"Daten importieren"},validation:{pasteRequired:"Bitte fügen Sie Daten vor dem Parsen ein."}},decryptionDialog:{title:"Passwort zur Entschlüsselung eingeben",labels:{password:"Passwort"},buttons:{cancel:"Abbrechen",confirm:"Bestätigen"}},encryptionDialog:{title:"Passwort zur Verschlüsselung eingeben",labels:{password:"Passwort"},buttons:{cancel:"Abbrechen",confirm:"Bestätigen"}},faqDialog:{title:"Häufig gestellte Fragen",searchLabel:"FAQs durchsuchen",noResults:"Keine FAQs entsprechen Ihren Suchkriterien.",uncategorized:"Unkategorisiert",buttons:{close:"Schließen"}},loadDataDialog:{title:"Formulardaten laden",instruction:"Wählen Sie eine zuvor gespeicherte JSON-Datei aus, um die Formulardaten zu laden.",labels:{fileInput:"JSON-Datei auswählen"},buttons:{cancel:"Abbrechen",import:"Importieren"},validation:{fileRequired:"Bitte wählen Sie eine Datei zum Importieren aus."}},resetConfirmationDialog:{title:"Anwendung zurücksetzen",confirmationText:"Sind Sie sicher, dass Sie die gesamte Anwendung zurücksetzen möchten? Dies löscht alle Formulardaten und kann nicht rückgängig gemacht werden.",buttons:{cancel:"Abbrechen",reset:"Zurücksetzen"}},saveDataDialog:{title:"Formulardaten exportieren",instruction:"Speichern Sie Ihre Formulardaten zur späteren Verwendung. Sie können die Datei benennen, um sie leicht zu identifizieren.",labels:{fileName:"Dateiname"},placeholders:{fileName:"requiform-daten"},hints:{fileName:"An den Dateinamen wird .json angehängt"},buttons:{cancel:"Abbrechen",export:"Exportieren"},defaultFileName:"requiform-daten"},logViewer:{title:"Anwendungsprotokolle",emptyState:"Noch keine Protokolleinträge.",levels:{debug:"Debug",info:"Info",warn:"Warnung",error:"Fehler"},buttons:{download:"Protokolle herunterladen",clear:"Protokolle löschen",close:"Protokolle schließen",toggleDetails:"Details umschalten"}},disclaimer:{title:"Haftungsausschluss",body:"Dieses Werkzeug ist nur für nicht-medizinische Zwecke bestimmt. Es ist nicht dafür gedacht, medizinischen Rat oder Diagnosen zu liefern. Bitte geben Sie keine sensiblen persönlichen Daten ein.",acknowledgeButton:"Ich bestätige"},pedigreeDrawer:{title:"Stammbaumdiagramm"},app:{includePedigreeChart:"Stammbaumdiagramm einschließen"},tour:{buttons:{back:"Zurück",next:"Weiter",skip:"Überspringen",start:"Tour starten",finish:"Beenden"},welcome:{text:"Willkommen bei RequiForm! Diese Tour führt Sie durch die Hauptfunktionen."},patientForm:{text:"Beginnen Sie mit der Eingabe der Patienteninformationen in diesem Abschnitt."},testSelector:{text:"Wählen Sie hier die erforderlichen Gentests aus."},phenotypes:{text:"Fügen Sie relevante HPO-Phänotypen für den Patienten hinzu."},topBarActions:{text:"Nutzen Sie die Aktionen in der oberen Leiste wie PDF generieren, URL kopieren usw."},generatePdf:{text:"Sobald das Formular vollständig ist, generieren Sie das PDF-Anforderungsformular mit dieser Schaltfläche."},complete:{text:"Sie haben die Tour abgeschlossen! Sie können sie jederzeit über das Hilfe-Menü neu starten."},completed:"Tour abgeschlossen!",cancelled:"Tour abgebrochen."},validation:{required:{firstName:"Vorname ist erforderlich.",lastName:"Nachname ist erforderlich.",birthdate:"Geburtsdatum ist erforderlich.",sex:"Geschlecht ist erforderlich.",insurance:"Versicherungsinformationen sind erforderlich.",referrer:"Überweisender Arzt ist erforderlich.",diagnosis:"Diagnose/Verdacht ist erforderlich.",phenotypeId:"Phänotyp-ID ist erforderlich.",phenotypeStatus:"Phänotyp-Status ist erforderlich."},invalid:{email:"Ungültiges E-Mail-Format.",birthdate:"Geburtsdatum muss ein gültiges Datum (JJJJ-MM-TT) sein und darf nicht in der Zukunft liegen.",hpoIdFormat:"Ungültiges HPO-ID-Format."},general:{missingData:"Patientendaten fehlen."}}}))};Me(Al.en),Me(Al.de);const Il=R({locale:function(){try{const e=localStorage.getItem("userLanguage");if(e&&["en","de"].includes(e))return e;const t=navigator.language.split("-")[0];return["en","de"].includes(t)?t:"en"}catch{return"en"}}(),fallbackLocale:"en",messages:Al,warnHtmlMessage:!1,escapeParameter:!0});const Fl={en:[{category:"General",question:"What is RequiForm?",answer:"RequiForm is a web application designed to help clinicians and researchers easily generate standardized clinical data requisitions, particularly for genetic testing. It focuses on privacy, usability, and adherence to standards like HPO."},{category:"General",question:"Which browsers are supported?",answer:"RequiForm is tested on the latest versions of modern browsers like <strong>Chrome</strong>, <strong>Firefox</strong>, <strong>Edge</strong>, and <strong>Safari</strong>. While it may work on others, using an up-to-date version of these recommended browsers ensures the best experience."},{category:"Data Handling & Security",question:"How is my data handled? Is it secure?",answer:"<strong>All data processing happens entirely in your browser.</strong> Your data <strong>never leaves your device</strong>, and no information is stored on any servers. This client-side approach ensures maximum privacy and security for sensitive information. When using sharing features, data is either encoded directly in the URL or saved locally as a file."},{category:"Data Handling & Security",question:"What encryption is used for sharing?",answer:'The "Share Encrypted Link" option uses <strong>AES-GCM encryption</strong> with a key derived from your chosen password using <strong>PBKDF2</strong>. This is a strong, standard-based encryption method. <em>Remember: the security relies on the strength of your password and keeping it confidential.</em> The specific implementation details can be reviewed in the source code.'},{category:"Data Handling & Security",question:"What data format is used for file import/export?",answer:"The application uses a structured <strong>JSON format</strong> for saving and loading data. This format includes patient information, selected panels, and phenotype data. The exact structure can be inspected by saving the data to a file."},{category:"Data Handling & Security",question:"Can I use RequiForm offline?",answer:"Yes, once the application is loaded in your browser, it can function offline. However, features requiring external resources (like fetching HPO terms if not cached) might be limited without an internet connection."},{category:"Features",question:"How does the HPO term search work?",answer:"You can search for Human Phenotype Ontology (HPO) terms by typing keywords or HPO IDs. The search uses an integrated HPO database to suggest relevant terms. Selecting a term adds it to the patient's phenotype profile."},{category:"Features",question:"Can I customize the generated PDF?",answer:"The PDF layout and content are standardized. While direct customization isn't currently supported, the application includes fields for common requirements. Future versions may offer more branding or layout options."},{category:"Features",question:"How do I share the form data?",answer:"You can share the data in several ways:\n<ul>\n  <li><strong>Copy URL:</strong> Generates a link with the data encoded directly in it (can be long).</li>\n  <li><strong>Copy Encrypted URL:</strong> Generates a link with the data encrypted using a password you provide.</li>\n  <li><strong>Save Data:</strong> Downloads the data as a JSON file.</li>\n</ul>"},{category:"Troubleshooting",question:"The application seems slow or unresponsive.",answer:"Ensure you are using a supported browser and that it's up-to-date. Try clearing your browser's cache or restarting the browser. If the issue persists, check your system's resource usage or contact support if applicable."},{category:"Troubleshooting",question:"I encountered an error message.",answer:"Note down the error message and the steps you took leading up to it. Try refreshing the page. If the error persists, consult the browser's developer console (usually opened with F12) for more details, which might be helpful for debugging."}],de:[{category:"Allgemein",question:"Was ist RequiForm?",answer:"RequiForm ist eine Webanwendung, die Klinikern und Forschern hilft, standardisierte klinische Datenanforderungen, insbesondere für Gentests, einfach zu generieren. Der Fokus liegt auf Datenschutz, Benutzerfreundlichkeit und der Einhaltung von Standards wie HPO."},{category:"Allgemein",question:"Welche Browser werden unterstützt?",answer:"RequiForm wird mit den neuesten Versionen moderner Browser wie <strong>Chrome</strong>, <strong>Firefox</strong>, <strong>Edge</strong> und <strong>Safari</strong> getestet. Obwohl es möglicherweise auch in anderen Browsern funktioniert, gewährleistet die Verwendung einer aktuellen Version dieser empfohlenen Browser das beste Erlebnis."},{category:"Datenverarbeitung & Sicherheit",question:"Wie werden meine Daten gehandhabt? Sind sie sicher?",answer:"<strong>Die gesamte Datenverarbeitung findet ausschließlich in Ihrem Browser statt.</strong> Ihre Daten <strong>verlassen niemals Ihr Gerät</strong>, und es werden keine Informationen auf Servern gespeichert. Dieser clientseitige Ansatz gewährleistet maximale Privatsphäre und Sicherheit für sensible Informationen. Bei der Nutzung von Freigabefunktionen werden Daten entweder direkt in der URL kodiert oder lokal als Datei gespeichert."},{category:"Datenverarbeitung & Sicherheit",question:"Welche Verschlüsselung wird für die Freigabe verwendet?",answer:'Die Option "Verschlüsselten Link teilen" verwendet <strong>AES-GCM-Verschlüsselung</strong> mit einem Schlüssel, der mittels <strong>PBKDF2</strong> aus Ihrem gewählten Passwort abgeleitet wird. Dies ist eine starke, standardbasierte Verschlüsselungsmethode. <em>Denken Sie daran: Die Sicherheit hängt von der Stärke Ihres Passworts und dessen Geheimhaltung ab.</em> Die spezifischen Implementierungsdetails können im Quellcode eingesehen werden.'},{category:"Datenverarbeitung & Sicherheit",question:"Welches Datenformat wird für den Datei-Import/Export verwendet?",answer:"Die Anwendung verwendet ein strukturiertes <strong>JSON-Format</strong> zum Speichern und Laden von Daten. Dieses Format enthält Patienteninformationen, ausgewählte Panels und Phänotypdaten. Die genaue Struktur kann durch Speichern der Daten in eine Datei überprüft werden."},{category:"Datenverarbeitung & Sicherheit",question:"Kann ich RequiForm offline verwenden?",answer:"Ja, sobald die Anwendung in Ihrem Browser geladen ist, kann sie offline funktionieren. Funktionen, die externe Ressourcen erfordern (wie das Abrufen von HPO-Begriffen, wenn nicht zwischengespeichert), können jedoch ohne Internetverbindung eingeschränkt sein."},{category:"Funktionen",question:"Wie funktioniert die HPO-Begriffssuche?",answer:"Sie können nach Begriffen der Human Phenotype Ontology (HPO) suchen, indem Sie Schlüsselwörter oder HPO-IDs eingeben. Die Suche verwendet eine integrierte HPO-Datenbank, um relevante Begriffe vorzuschlagen. Die Auswahl eines Begriffs fügt ihn dem Phänotypprofil des Patienten hinzu."},{category:"Funktionen",question:"Kann ich das generierte PDF anpassen?",answer:"Das PDF-Layout und der Inhalt sind standardisiert. Obwohl eine direkte Anpassung derzeit nicht unterstützt wird, enthält die Anwendung Felder für gängige Anforderungen. Zukünftige Versionen könnten mehr Branding- oder Layout-Optionen bieten."},{category:"Funktionen",question:"Wie teile ich die Formulardaten?",answer:"Sie können die Daten auf verschiedene Arten teilen:\n<ul>\n  <li><strong>URL kopieren:</strong> Generiert einen Link, in dem die Daten direkt kodiert sind (kann lang sein).</li>\n  <li><strong>Verschlüsselte URL kopieren:</strong> Generiert einen Link, in dem die Daten mit einem von Ihnen angegebenen Passwort verschlüsselt sind.</li>\n  <li><strong>Daten speichern:</strong> Lädt die Daten als JSON-Datei herunter.</li>\n</ul>"},{category:"Fehlerbehebung",question:"Die Anwendung scheint langsam oder reagiert nicht.",answer:"Stellen Sie sicher, dass Sie einen unterstützten Browser verwenden und dieser aktuell ist. Versuchen Sie, den Cache Ihres Browsers zu leeren oder den Browser neu zu starten. Wenn das Problem weiterhin besteht, überprüfen Sie die Ressourcennutzung Ihres Systems oder wenden Sie sich gegebenenfalls an den Support."},{category:"Fehlerbehebung",question:"Ich habe eine Fehlermeldung erhalten.",answer:"Notieren Sie sich die Fehlermeldung und die Schritte, die Sie unternommen haben, bevor der Fehler auftrat. Versuchen Sie, die Seite neu zu laden. Wenn der Fehler weiterhin besteht, konsultieren Sie die Entwicklerkonsole des Browsers (normalerweise mit F12 geöffnet) für weitere Details, die bei der Fehlersuche hilfreich sein könnten."}]};const El=Ze.categories||[],Nl={key:0,class:"mb-4"},Ll={style:{display:"none"}},Ol=He({__name:"App",setup(e){const{t,locale:m}=T(),y=Ca(),v=lr(),w=sr(),D=fr(),x=function(){const e=f(null),t=Ca(),n=lr();function a(e){try{if(!e||"string"!=typeof e)return ze.error("Process error: No valid data provided"),t.showSnackbar("No valid data provided."),!1;ze.debug("Processing pasted data:",e.substring(0,100)+"...");const a=Na(e);return ze.debug("Parse result:",a),a.success?(ze.debug("Importing parsed data:",a.data),n.importFormData(a.data,!0),n.syncLegacyPatientData(),n.syncUnifiedPatientData(),ze.debug("Form state after import:",{patientData:n.patientData,selectedTests:n.selectedTests,phenotypeDataObj:n.phenotypeDataObj}),t.showSnackbar("Data imported successfully!"),!0):(ze.error("Parse failed:",a.error),t.showSnackbar(a.error||"Invalid data format."),!1)}catch(a){return ze.error("Error processing pasted data:",a),t.showSnackbar("Error processing pasted data. Please check the format."),!1}}function r(e){return!(!e||"object"!=typeof e)&&(e.patientData&&"object"==typeof e.patientData||e.selectedTests&&Array.isArray(e.selectedTests)||e.phenotypeData&&"object"==typeof e.phenotypeData)}return{importedFile:e,saveToFile:function(e){try{const a=function(e,t="requiform-data"){try{const n=JSON.stringify(e,null,2),a=new Blob([n],{type:"application/json"}),r=document.createElement("a");return r.href=URL.createObjectURL(a),r.download=`${t}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(r.href),!0}catch(n){return!1}}(n.exportFormData(),e);return a?(t.showSnackbar("Data saved successfully!"),ze.debug("Data saved successfully to",e),!0):(t.showSnackbar("Error saving data to file."),ze.error("Error saving data to file."),!1)}catch(a){return ze.error("Error saving data to file:",a),t.showSnackbar("Error saving data to file."),!1}},loadFromFile:async function(a){try{if(!a)return t.setLoadDataError("No file selected."),!1;e.value=a;let o=await function(e){return new Promise(((t,n)=>{if(!e)return void n(new Error("No file provided"));const a=new FileReader;a.onload=e=>{try{const n=JSON.parse(e.target.result);t(n)}catch{n(new Error("Invalid JSON format"))}},a.onerror=()=>{n(new Error("Error reading file"))},a.readAsText(e)}))}(a);return o=Me(o),ze.debug("Sanitized JSON data from file."),r(o)?(n.importFormData(o,!0),t.showSnackbar("Data loaded successfully!"),ze.debug("Data loaded from file:",a.name,o),!0):(t.setLoadDataError("Invalid data format. The file does not contain valid RequiForm data."),!1)}catch(o){return ze.error("Error loading data from file:",o),t.setLoadDataError(`Error loading data: ${o.message}`),!1}},processPastedData:a,importFromJson:async function(e){if(!e||"string"!=typeof e)return ze.error("Import error: No valid data provided",e),t.showSnackbar("No valid data provided."),!1;ze.debug("Attempting to import data:",e.substring(0,100)+"...");try{let a=JSON.parse(e);if(ze.debug("Successfully parsed as JSON:",a),a=Me(a),ze.debug("Sanitized JSON data from pasted input."),r(a)){ze.debug("Valid form data format detected, importing directly");const e=n.importFormData(a,!0);return ze.debug("Import result:",e,"Current form state:",{patientData:n.patientData,selectedTests:n.selectedTests,phenotypeDataObj:n.phenotypeDataObj}),n.syncLegacyPatientData(),n.syncUnifiedPatientData(),t.showSnackbar("Data imported successfully!"),!0}return ze.error("Invalid data format:",a),t.showSnackbar("Invalid data format. The JSON does not contain valid RequiForm data."),!1}catch(o){return ze.debug("Not valid JSON, trying formatted text processing:",o.message),a(e)}},isValidFormData:r}}(),S=function(){const e=f(null),t=Ca();return{setPdfGeneratorRef:function(t){e.value=t},generatePdf:async function(){if(!e.value)return t.showSnackbar("Could not generate PDF. Please try again."),!1;try{return await e.value.generatePdf(),!0}catch(n){return t.showSnackbar("Error generating PDF. Please try again."),!1}}}}(),P=function(){const e=f(null);function t(){e.value?(ze.info("Starting application tour..."),e.value.start()):ze.error("App Tour: Could not start, tour instance not available.")}return{tourInstance:e,initialize:function(){e.value=function(){const e=new _l.Tour({useModalOverlay:!0,defaultStepOptions:{classes:"shepherd-theme-arrows shepherd-custom",scrollTo:{behavior:"smooth",block:"center"},cancelIcon:{enabled:!0},buttons:[{action(){return this.back()},secondary:!0,text:Il.global.t("tour.buttons.back")},{action(){return this.next()},text:Il.global.t("tour.buttons.next")}]}});return e.addStep({id:"welcome",text:Il.global.t("tour.welcome.text"),attachTo:{element:"#app",on:"center"},buttons:[{action(){return localStorage.setItem("requiformTourCompleted","true"),this.cancel()},secondary:!0,text:Il.global.t("tour.buttons.skip")},{action(){return this.next()},text:Il.global.t("tour.buttons.start")}]}),e.addStep({id:"patient-form",text:Il.global.t("tour.patientForm.text"),attachTo:{element:"#patient-form-component",on:"bottom"},when:{show:()=>document.querySelector("#patient-form-component")}}),e.addStep({id:"test-selector",text:Il.global.t("tour.testSelector.text"),attachTo:{element:"#test-selector-component",on:"bottom"},when:{show:()=>document.querySelector("#test-selector-component")}}),e.addStep({id:"phenotypes",text:Il.global.t("tour.phenotypes.text"),attachTo:{element:"#phenotype-selector-component",on:"bottom"},when:{show:()=>document.querySelector("#phenotype-selector-component")}}),e.addStep({id:"top-bar-actions",text:Il.global.t("tour.topBarActions.text"),attachTo:{element:"#top-bar-actions",on:"bottom"},when:{show:()=>document.querySelector("#top-bar-actions")}}),e.addStep({id:"generate-pdf",text:Il.global.t("tour.generatePdf.text"),attachTo:{element:"#generate-pdf-btn",on:"left"},when:{show:()=>document.querySelector("#generate-pdf-btn")}}),e.addStep({id:"tour-complete",text:Il.global.t("tour.complete.text"),buttons:[{action(){return this.complete()},text:Il.global.t("tour.buttons.finish")}]}),e.on("complete",(()=>{ze.info(Il.global.t("tour.completed")),localStorage.setItem("requiformTourCompleted","true")})),e.on("cancel",(()=>{ze.info(Il.global.t("tour.cancelled"))})),e}(),localStorage.getItem("requiformTourCompleted")||t()},startTour:t}}(),k=function(){const e=Ca(),{localizedFaqContent:t}=function(){const{locale:e}=T();return{localizedFaqContent:n((()=>{const t=Fl[e.value]||Fl.en||[];return Array.isArray(t)?t:[]}))}}();return{faqItems:t,openFaq:function(){e.toggleFAQModal(!0)},closeFaq:function(){e.toggleFAQModal(!1)}}}(),_=function(){const e=Ca(),t=lr();return{initiateReset:function(){e.openResetConfirmationDialog()},cancelReset:function(){e.closeResetConfirmationDialog()},confirmReset:function(){e.closeResetConfirmationDialog(),t.resetForm(),e.showSnackbar("Form has been reset!")},toggleTheme:function(){e.toggleTheme()}}}();O("ui",y),O("form",v),O("settings",w),O("isValid",v.isValid),O("validationErrors",v.validationErrors),O("sectionValidation",v.sectionValidation),O("validateForm",v.validateForm),O("getFieldErrors",v.getFieldErrors),O("patientData",v.patientData),O("updatePersonalInfo",v.updatePatientData),O("updatePhenotypeData",v.updatePhenotypeData),O("updateSelectedPanels",v.updateSelectedPanels);const C=f(oa),A=n((()=>v&&v.patientData?El?El.map((e=>({id:e.id,categoryTitle:e.title,tests:e.tests.filter((e=>{var t;return null==(t=v.patientData.selectedPanels)?void 0:t.includes(e.id)}))}))).filter((e=>e.tests.length>0)):(ze.warn("groupedPanelDetails: testsData.categories not available yet."),[]):(ze.warn("groupedPanelDetails: formStore or patientData not available yet."),[])));function I(){w.acknowledgeDisclaimer(),y.closeDisclaimerModal()}function F(e){D.copyEncryptedUrl(e).then((e=>{e&&y.closeEncryptionDialog()}))}function E(e){D.handlePasswordSubmit(e)}function N(e){x.saveToFile(e).then((e=>{e&&y.closeSaveDataDialog()}))}function L(e){x.loadFromFile(e).then((e=>{e&&y.closeLoadDataDialog()}))}async function V(e){try{ze.debug("App: Received data for import, length:",(null==e?void 0:e.length)||0),await x.importFromJson(e)?(y.closePasteDataDialog(),y.showSnackbar("Data imported successfully!"),setTimeout((()=>{ze.debug("App: Current form state after import:",{personalInfo:v.patientData.personalInfo,selectedPanels:v.patientData.selectedPanels.length,phenotypeData:v.patientData.phenotypeData.length})}),0)):ze.error("App: Failed to import data")}catch(t){ze.error("App: Error importing data:",t),y.showSnackbar("Error importing data. Please try again.")}}const R=f(null),z=f(null);async function M(){const e=v.validateForm(!0);if(v.setShowValidation(!0),ze.debug("Validation errors:",v.validationErrors),ze.debug("Validation sections:",v.sectionValidation),e){if(v.showPedigree&&z.value)try{const e=await z.value.getPedigreeDataUrl();v.updatePedigreeDataUrl(e);const t=z.value.getPedigreeData();t&&ze.debug("Updated pedigree data:",t),ze.debug("Pedigree data updated successfully for PDF generation")}catch(t){ze.error("Error updating pedigree data for PDF:",t)}await S.generatePdf()}else{ze.debug("Form validation failed. Please correct the errors before generating PDF."),y.showSnackbar("Please correct the form errors before generating PDF."),v.setShowValidation(!0),window.scrollTo({top:0,behavior:"smooth"});const e=document.querySelector(".validation-summary");e&&(e.setAttribute("tabindex","-1"),e.focus(),e.classList.add("highlight-animation"),setTimeout((()=>{e.classList.remove("highlight-animation")}),1500))}}b((()=>{P.initialize(),D.initializeFromUrl()})),h(R,(e=>{e&&(ze.debug("PDF generator reference connected"),S.setPdfGeneratorRef(e))}),{immediate:!0});const U=()=>{const e="en"===m.value?"de":"en";m.value=e,document.documentElement.lang=e,localStorage.setItem("userLanguage",e),ze.info(`Language switched to ${e.toUpperCase()}`)},H=()=>{y.toggleLogViewer()};return(e,n)=>(r(),a(ke,{theme:c(y).isDark?"dark":"light",id:"app"},{default:o((()=>[l(Je,{isDark:c(y).isDark,onToggleTheme:c(_).toggleTheme,onResetForm:c(_).initiateReset,onOpenFaq:c(k).openFaq,onGeneratePdf:M,onCopyUrl:c(D).copyShareableUrl,onCopyEncryptedUrl:c(y).openEncryptionDialog,onStartTour:c(P).startTour,onSaveData:c(y).openSaveDataDialog,onLoadData:c(y).openLoadDataDialog,onOpenPasteData:c(y).openPasteDataDialog,onToggleLanguage:U,onToggleLogViewer:H},null,8,["isDark","onToggleTheme","onResetForm","onOpenFaq","onCopyUrl","onCopyEncryptedUrl","onStartTour","onSaveData","onLoadData","onOpenPasteData"]),n[27]||(n[27]=s()),!c(w).disclaimerAcknowledged||c(y).showDisclaimerModal?(r(),a(da,{key:0,onDismiss:I})):p("",!0),n[28]||(n[28]=s()),l(_e,null,{default:o((()=>[l(Ce,{class:"main-content-container"},{default:o((()=>[c(v).showValidation?(r(),g("div",Nl,[l(ra,{showValidation:c(v).showValidation,isValid:c(v).isValid,validationErrors:c(v).validationErrors},null,8,["showValidation","isValid","validationErrors"])])):p("",!0),n[11]||(n[11]=s()),l(Qe,{patientData:c(v).patientData.personalInfo,"onUpdate:patientData":c(v).updatePatientData,pdfConfig:C.value,id:"patient-form-component"},null,8,["patientData","onUpdate:patientData","pdfConfig"]),n[12]||(n[12]=s()),l(ne,{modelValue:c(v).showPedigree,"onUpdate:modelValue":n[0]||(n[0]=e=>c(v).showPedigree=e),label:c(t)("app.includePedigreeChart"),class:"mb-4"},null,8,["modelValue","label"]),n[13]||(n[13]=s()),c(v).showPedigree?(r(),a(aa,{key:1,ref_key:"pedigreeDrawerRef",ref:z,"onUpdate:pedigreeDataUrl":c(v).updatePedigreeDataUrl},null,8,["onUpdate:pedigreeDataUrl"])):p("",!0),n[14]||(n[14]=s()),l(Xe,{id:"test-selector-component"}),n[15]||(n[15]=s()),l(st,{groupedPanelDetails:A.value,modelValue:c(v).phenotypeDataObj,"onUpdate:modelValue":n[1]||(n[1]=e=>c(v).phenotypeDataObj=e),id:"phenotype-selector-component"},null,8,["groupedPanelDetails","modelValue"]),n[16]||(n[16]=s()),i("div",Ll,[l(sa,{ref_key:"pdfGeneratorRef",ref:R,patientData:c(v).patientData.personalInfo,pedigreeDataUrl:c(v).pedigreeDataUrl,phenotypeData:c(v).phenotypeDataObj,pdfConfig:C.value},null,8,["patientData","pedigreeDataUrl","phenotypeData","pdfConfig"])]),n[17]||(n[17]=s()),l(qa,{groupedPanelDetails:A.value},null,8,["groupedPanelDetails"])])),_:1}),n[19]||(n[19]=s()),l(Ae,{modelValue:c(y).snackbar,"onUpdate:modelValue":n[3]||(n[3]=e=>c(y).snackbar=e),timeout:"3000",top:"",right:"",transition:"scale-transition"},{action:o((({attrs:e})=>[l(B,u({color:"red",text:""},e,{onClick:n[2]||(n[2]=e=>c(y).snackbar=!1)}),{default:o((()=>[l(q,null,{default:o((()=>n[18]||(n[18]=[s("mdi-close")]))),_:1})])),_:2},1040)])),default:o((()=>[s(d(c(y).snackbarMessage)+" ",1)])),_:1},8,["modelValue"]),n[20]||(n[20]=s()),l(Wa,{modelValue:c(y).encryptionDialog,"onUpdate:modelValue":n[4]||(n[4]=e=>c(y).encryptionDialog=e),onCancel:c(y).closeEncryptionDialog,onConfirm:F},null,8,["modelValue","onCancel"]),n[21]||(n[21]=s()),l(Qa,{modelValue:c(y).decryptionDialog,"onUpdate:modelValue":n[5]||(n[5]=e=>c(y).decryptionDialog=e),error:c(y).decryptionError,onCancel:c(y).cancelDecryption,onConfirm:E},null,8,["modelValue","error","onCancel"]),n[22]||(n[22]=s()),l(Xa,{modelValue:c(y).showFAQModal,"onUpdate:modelValue":n[6]||(n[6]=e=>c(y).showFAQModal=e),faqItems:c(k).faqItems.value,onClose:c(k).closeFaq},null,8,["modelValue","faqItems","onClose"]),n[23]||(n[23]=s()),l(er,{modelValue:c(y).resetConfirmationDialog,"onUpdate:modelValue":n[7]||(n[7]=e=>c(y).resetConfirmationDialog=e),onCancel:c(_).cancelReset,onConfirm:c(_).confirmReset},null,8,["modelValue","onCancel","onConfirm"]),n[24]||(n[24]=s()),l(tr,{modelValue:c(y).saveDataDialog,"onUpdate:modelValue":n[8]||(n[8]=e=>c(y).saveDataDialog=e),defaultFileName:c(v).saveDataName,onCancel:c(y).closeSaveDataDialog,onConfirm:N},null,8,["modelValue","defaultFileName","onCancel"]),n[25]||(n[25]=s()),l(nr,{modelValue:c(y).loadDataDialog,"onUpdate:modelValue":n[9]||(n[9]=e=>c(y).loadDataDialog=e),error:c(y).loadDataError,onCancel:c(y).closeLoadDataDialog,onConfirm:L},null,8,["modelValue","error","onCancel"]),n[26]||(n[26]=s()),l(Ta,{modelValue:c(y).pasteDataDialog,"onUpdate:modelValue":n[10]||(n[10]=e=>c(y).pasteDataDialog=e),onClose:c(y).closePasteDataDialog,onImport:V},null,8,["modelValue","onClose"])])),_:1}),n[29]||(n[29]=s()),l(Ea,{disclaimerAcknowledged:c(w).disclaimerAcknowledged,acknowledgmentTime:c(w).acknowledgmentTime,onReopenDisclaimer:c(y).openDisclaimerModal},null,8,["disclaimerAcknowledged","acknowledgmentTime","onReopenDisclaimer"]),n[30]||(n[30]=s()),c(y).showLogViewer?(r(),a(Ka,{key:1})):p("",!0)])),_:1},8,["theme"]))}},[["__scopeId","data-v-6bfb7f63"]]);!async function(){try{await async function(){ze.info("[Branding] No external config path specified (VITE_BRANDING_CONFIG_PATH). Using defaults.")}();const e=Ie({components:Ee,directives:Fe,theme:{themes:{light:{dark:!1,colors:{...qe.themeColors}},dark:{dark:!0,colors:{...qe.darkThemeColors}}}}}),t=function(){const e=P(!0),t=e.run((()=>f({})));let n=[],a=[];const r=k({install(e){ua(r),r._a=e,e.provide(pa,r),e.config.globalProperties.$pinia=r,a.forEach((e=>n.push(e))),a=[]},use(e){return this._a?n.push(e):a.push(e),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return r}(),n=V(Ol);n.use(e),n.use(t),n.use(Il),n.mount("#app"),ze.info("Application mounted.")}catch(e){ze.error("Failed during application startup:",e),document.getElementById("app").innerHTML='\n      <div style="padding: 20px; text-align: center; color: red;">\n        <h2>Application Initialization Failed</h2>\n        <p>Could not load critical configuration. Please check the console or contact support.</p>\n      </div>\n    '}}();
